import{c as wi,g as k0,a as ue,e as mr,b as H0,w as Pl,r as Ol,f as dc,t as fa,d as K0,h as _i,D as V0,k as B0,N as ne,j as G0,i as nc,l as W0,V as J0,R as Y0,F as Sh,K as Q0,x as X0,L as Z0,m as Ph,$ as em,p as tm,n as Hn,Z as Oh,J as rm,X as im,_ as Cl,o as $r,q as nm,s as sm,u as hn,v as Dt,U as rr,y as mi,z as lr,A as am,B as ln,C as Al,E as om,G as cm,H as um,I as Rl,M as hm,O as Tl,P as Nl,Q as fn,S as sc,T as na,W as pn,Y as sa,a0 as lm,a1 as fm,a2 as pm,a3 as Xs,a4 as dm,a5 as gm,a6 as Uo,a7 as Ch,a8 as ym,a9 as vm,aa as mm,ab as Ah,ac as _m,ad as wm,ae as bm,af as Em,ag as Im,ah as xm,ai as Sm,aj as Pm,ak as Un,al as Dl,am as ko,an as Om,ao as Cm}from"./index.c4c19996.js";import{s as Kn,a as pa,i as Rh,c as Am,b as Rm,f as gc,p as Tm,J as Ei,d as yc,e as vc,g as mc,h as vi,j as si,k as ua,l as Nm,m as Dm,H as zi}from"./http.739c64bf.js";const Fm=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Lm=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,$m=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jm(c,i){if(c==="__proto__"||c==="constructor"&&i&&typeof i=="object"&&"prototype"in i){Mm(c);return}return i}function Mm(c){console.warn(`[destr] Dropping "${c}" key to prevent prototype pollution.`)}function Zs(c,i={}){if(typeof c!="string")return c;const r=c.trim();if(c[0]==='"'&&c.at(-1)==='"'&&!c.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!$m.test(c)){if(i.strict)throw new SyntaxError("[destr] Invalid JSON");return c}try{if(Fm.test(c)||Lm.test(c)){if(i.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(c,jm)}return JSON.parse(c)}catch(s){if(i.strict)throw s;return c}}function qm(c){return!c||typeof c.then!="function"?Promise.resolve(c):c}function Ut(c,...i){try{return qm(c(...i))}catch(r){return Promise.reject(r)}}function zm(c){const i=typeof c;return c===null||i!=="object"&&i!=="function"}function Um(c){const i=Object.getPrototypeOf(c);return!i||i.isPrototypeOf(Object)}function aa(c){if(zm(c))return String(c);if(Um(c)||Array.isArray(c))return JSON.stringify(c);if(typeof c.toJSON=="function")return aa(c.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Fl(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const ac="base64:";function km(c){if(typeof c=="string")return c;Fl();const i=Buffer.from(c).toString("base64");return ac+i}function Hm(c){return typeof c!="string"||!c.startsWith(ac)?c:(Fl(),Buffer.from(c.slice(ac.length),"base64"))}function hr(c){return c?c.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Km(...c){return hr(c.join(":"))}function ea(c){return c=hr(c),c?c+":":""}const Vm="memory",Bm=()=>{const c=new Map;return{name:Vm,options:{},hasItem(i){return c.has(i)},getItem(i){return c.get(i)??null},getItemRaw(i){return c.get(i)??null},setItem(i,r){c.set(i,r)},setItemRaw(i,r){c.set(i,r)},removeItem(i){c.delete(i)},getKeys(){return Array.from(c.keys())},clear(){c.clear()},dispose(){c.clear()}}};function Gm(c={}){const i={mounts:{"":c.driver||Bm()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const O of i.mountpoints)if(y.startsWith(O))return{base:O,relativeKey:y.slice(O.length),driver:i.mounts[O]};return{base:"",relativeKey:y,driver:i.mounts[""]}},s=(y,O)=>i.mountpoints.filter(N=>N.startsWith(y)||O&&y.startsWith(N)).map(N=>({relativeBase:y.length>N.length?y.slice(N.length):void 0,mountpoint:N,driver:i.mounts[N]})),a=(y,O)=>{if(!!i.watching){O=hr(O);for(const N of i.watchListeners)N(y,O)}},l=async()=>{if(!i.watching){i.watching=!0;for(const y in i.mounts)i.unwatch[y]=await Th(i.mounts[y],a,y)}},d=async()=>{if(!!i.watching){for(const y in i.unwatch)await i.unwatch[y]();i.unwatch={},i.watching=!1}},v=(y,O,N)=>{const F=new Map,V=j=>{let Q=F.get(j.base);return Q||(Q={driver:j.driver,base:j.base,items:[]},F.set(j.base,Q)),Q};for(const j of y){const Q=typeof j=="string",ae=hr(Q?j:j.key),he=Q?void 0:j.value,le=Q||!j.options?O:{...O,...j.options},fe=r(ae);V(fe).items.push({key:ae,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...F.values()].map(j=>N(j))).then(j=>j.flat())},E={hasItem(y,O={}){y=hr(y);const{relativeKey:N,driver:F}=r(y);return Ut(F.hasItem,N,O)},getItem(y,O={}){y=hr(y);const{relativeKey:N,driver:F}=r(y);return Ut(F.getItem,N,O).then(V=>Zs(V))},getItems(y,O){return v(y,O,N=>N.driver.getItems?Ut(N.driver.getItems,N.items.map(F=>({key:F.relativeKey,options:F.options})),O).then(F=>F.map(V=>({key:Km(N.base,V.key),value:Zs(V.value)}))):Promise.all(N.items.map(F=>Ut(N.driver.getItem,F.relativeKey,F.options).then(V=>({key:F.key,value:Zs(V)})))))},getItemRaw(y,O={}){y=hr(y);const{relativeKey:N,driver:F}=r(y);return F.getItemRaw?Ut(F.getItemRaw,N,O):Ut(F.getItem,N,O).then(V=>Hm(V))},async setItem(y,O,N={}){if(O===void 0)return E.removeItem(y);y=hr(y);const{relativeKey:F,driver:V}=r(y);!V.setItem||(await Ut(V.setItem,F,aa(O),N),V.watch||a("update",y))},async setItems(y,O){await v(y,O,async N=>{N.driver.setItems&&await Ut(N.driver.setItems,N.items.map(F=>({key:F.relativeKey,value:aa(F.value),options:F.options})),O),N.driver.setItem&&await Promise.all(N.items.map(F=>Ut(N.driver.setItem,F.relativeKey,aa(F.value),F.options)))})},async setItemRaw(y,O,N={}){if(O===void 0)return E.removeItem(y,N);y=hr(y);const{relativeKey:F,driver:V}=r(y);if(V.setItemRaw)await Ut(V.setItemRaw,F,O,N);else if(V.setItem)await Ut(V.setItem,F,km(O),N);else return;V.watch||a("update",y)},async removeItem(y,O={}){typeof O=="boolean"&&(O={removeMeta:O}),y=hr(y);const{relativeKey:N,driver:F}=r(y);!F.removeItem||(await Ut(F.removeItem,N,O),(O.removeMeta||O.removeMata)&&await Ut(F.removeItem,N+"$",O),F.watch||a("remove",y))},async getMeta(y,O={}){typeof O=="boolean"&&(O={nativeOnly:O}),y=hr(y);const{relativeKey:N,driver:F}=r(y),V=Object.create(null);if(F.getMeta&&Object.assign(V,await Ut(F.getMeta,N,O)),!O.nativeOnly){const j=await Ut(F.getItem,N+"$",O).then(Q=>Zs(Q));j&&typeof j=="object"&&(typeof j.atime=="string"&&(j.atime=new Date(j.atime)),typeof j.mtime=="string"&&(j.mtime=new Date(j.mtime)),Object.assign(V,j))}return V},setMeta(y,O,N={}){return this.setItem(y+"$",O,N)},removeMeta(y,O={}){return this.removeItem(y+"$",O)},async getKeys(y,O={}){y=ea(y);const N=s(y,!0);let F=[];const V=[];for(const j of N){const ae=(await Ut(j.driver.getKeys,j.relativeBase,O)).map(he=>j.mountpoint+hr(he)).filter(he=>!F.some(le=>he.startsWith(le)));V.push(...ae),F=[j.mountpoint,...F.filter(he=>!he.startsWith(j.mountpoint))]}return y?V.filter(j=>j.startsWith(y)&&!j.endsWith("$")):V.filter(j=>!j.endsWith("$"))},async clear(y,O={}){y=ea(y),await Promise.all(s(y,!1).map(async N=>{if(N.driver.clear)return Ut(N.driver.clear,N.relativeBase,O);if(N.driver.removeItem){const F=await N.driver.getKeys(N.relativeBase||"",O);return Promise.all(F.map(V=>N.driver.removeItem(V,O)))}}))},async dispose(){await Promise.all(Object.values(i.mounts).map(y=>Nh(y)))},async watch(y){return await l(),i.watchListeners.push(y),async()=>{i.watchListeners=i.watchListeners.filter(O=>O!==y),i.watchListeners.length===0&&await d()}},async unwatch(){i.watchListeners=[],await d()},mount(y,O){if(y=ea(y),y&&i.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(i.mountpoints.push(y),i.mountpoints.sort((N,F)=>F.length-N.length)),i.mounts[y]=O,i.watching&&Promise.resolve(Th(O,a,y)).then(N=>{i.unwatch[y]=N}).catch(console.error),E},async unmount(y,O=!0){y=ea(y),!(!y||!i.mounts[y])&&(i.watching&&y in i.unwatch&&(i.unwatch[y](),delete i.unwatch[y]),O&&await Nh(i.mounts[y]),i.mountpoints=i.mountpoints.filter(N=>N!==y),delete i.mounts[y])},getMount(y=""){y=hr(y)+":";const O=r(y);return{driver:O.driver,base:O.base}},getMounts(y="",O={}){return y=hr(y),s(y,O.parents).map(F=>({driver:F.driver,base:F.mountpoint}))}};return E}function Th(c,i,r){return c.watch?c.watch((s,a)=>i(s,r+a)):()=>{}}async function Nh(c){typeof c.dispose=="function"&&await Ut(c.dispose)}function Ui(c){return new Promise((i,r)=>{c.oncomplete=c.onsuccess=()=>i(c.result),c.onabort=c.onerror=()=>r(c.error)})}function Ll(c,i){const r=indexedDB.open(c);r.onupgradeneeded=()=>r.result.createObjectStore(i);const s=Ui(r);return(a,l)=>s.then(d=>l(d.transaction(i,a).objectStore(i)))}let Ho;function Vn(){return Ho||(Ho=Ll("keyval-store","keyval")),Ho}function Dh(c,i=Vn()){return i("readonly",r=>Ui(r.get(c)))}function Wm(c,i,r=Vn()){return r("readwrite",s=>(s.put(i,c),Ui(s.transaction)))}function Jm(c,i=Vn()){return i("readwrite",r=>(r.delete(c),Ui(r.transaction)))}function Ym(c=Vn()){return c("readwrite",i=>(i.clear(),Ui(i.transaction)))}function Qm(c,i){return c.openCursor().onsuccess=function(){!this.result||(i(this.result),this.result.continue())},Ui(c.transaction)}function Xm(c=Vn()){return c("readonly",i=>{if(i.getAllKeys)return Ui(i.getAllKeys());const r=[];return Qm(i,s=>r.push(s.key)).then(()=>r)})}const Zm="idb-keyval";var e1=(c={})=>{const i=c.base&&c.base.length>0?`${c.base}:`:"",r=a=>i+a;let s;return c.dbName&&c.storeName&&(s=Ll(c.dbName,c.storeName)),{name:Zm,options:c,async hasItem(a){return!(typeof await Dh(r(a),s)>"u")},async getItem(a){return await Dh(r(a),s)??null},setItem(a,l){return Wm(r(a),l,s)},removeItem(a){return Jm(r(a),s)},getKeys(){return Xm(s)},clear(){return Ym(s)}}};const t1="WALLET_CONNECT_V2_INDEXED_DB",r1="keyvaluestorage";class i1{constructor(){this.indexedDb=Gm({driver:e1({dbName:t1,storeName:r1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){const r=await this.indexedDb.getItem(i);if(r!==null)return r}async setItem(i,r){await this.indexedDb.setItem(i,Kn(r))}async removeItem(i){await this.indexedDb.removeItem(i)}}var Ko=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oa={exports:{}};(function(){let c;function i(){}c=i,c.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},c.prototype.setItem=function(r,s){this[r]=String(s)},c.prototype.removeItem=function(r){delete this[r]},c.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},c.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ko<"u"&&Ko.localStorage?oa.exports=Ko.localStorage:typeof window<"u"&&window.localStorage?oa.exports=window.localStorage:oa.exports=new i})();function n1(c){var i;return[c[0],pa((i=c[1])!=null?i:"")]}class s1{constructor(){this.localStorage=oa.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(n1)}async getItem(i){const r=this.localStorage.getItem(i);if(r!==null)return pa(r)}async setItem(i,r){this.localStorage.setItem(i,Kn(r))}async removeItem(i){this.localStorage.removeItem(i)}}const a1="wc_storage_version",Fh=1,o1=async(c,i,r)=>{const s=a1,a=await i.getItem(s);if(a&&a>=Fh){r(i);return}const l=await c.getKeys();if(!l.length){r(i);return}const d=[];for(;l.length;){const v=l.shift();if(!v)continue;const E=v.toLowerCase();if(E.includes("wc@")||E.includes("walletconnect")||E.includes("wc_")||E.includes("wallet_connect")){const y=await c.getItem(v);await i.setItem(v,y),d.push(v)}}await i.setItem(s,Fh),r(i),c1(c,d)},c1=async(c,i)=>{i.length&&i.forEach(async r=>{await c.removeItem(r)})};class u1{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const i=new s1;this.storage=i;try{const r=new i1;o1(i,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,r){return await this.initialize(),this.storage.setItem(i,r)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),i())},20)})}}var dn={},Bn={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(c){var i,r,s,a,l,d,v,E,y,O,N,F,V,j,Q,ae,he,le,fe,ve,me,q,G;(function(U){var pe=typeof wi=="object"?wi:typeof self=="object"?self:typeof this=="object"?this:{};U(m(pe,m(c.exports)));function m(I,S){return I!==pe&&(typeof Object.create=="function"?Object.defineProperty(I,"__esModule",{value:!0}):I.__esModule=!0),function($,_){return I[$]=S?S($,_):_}}})(function(U){var pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,I){m.__proto__=I}||function(m,I){for(var S in I)I.hasOwnProperty(S)&&(m[S]=I[S])};i=function(m,I){pe(m,I);function S(){this.constructor=m}m.prototype=I===null?Object.create(I):(S.prototype=I.prototype,new S)},r=Object.assign||function(m){for(var I,S=1,$=arguments.length;S<$;S++){I=arguments[S];for(var _ in I)Object.prototype.hasOwnProperty.call(I,_)&&(m[_]=I[_])}return m},s=function(m,I){var S={};for(var $ in m)Object.prototype.hasOwnProperty.call(m,$)&&I.indexOf($)<0&&(S[$]=m[$]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,$=Object.getOwnPropertySymbols(m);_<$.length;_++)I.indexOf($[_])<0&&Object.prototype.propertyIsEnumerable.call(m,$[_])&&(S[$[_]]=m[$[_]]);return S},a=function(m,I,S,$){var _=arguments.length,w=_<3?I:$===null?$=Object.getOwnPropertyDescriptor(I,S):$,Y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,I,S,$);else for(var ee=m.length-1;ee>=0;ee--)(Y=m[ee])&&(w=(_<3?Y(w):_>3?Y(I,S,w):Y(I,S))||w);return _>3&&w&&Object.defineProperty(I,S,w),w},l=function(m,I){return function(S,$){I(S,$,m)}},d=function(m,I){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,I)},v=function(m,I,S,$){function _(w){return w instanceof S?w:new S(function(Y){Y(w)})}return new(S||(S=Promise))(function(w,Y){function ee(H){try{D($.next(H))}catch(X){Y(X)}}function Z(H){try{D($.throw(H))}catch(X){Y(X)}}function D(H){H.done?w(H.value):_(H.value).then(ee,Z)}D(($=$.apply(m,I||[])).next())})},E=function(m,I){var S={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},$,_,w,Y;return Y={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(Y[Symbol.iterator]=function(){return this}),Y;function ee(D){return function(H){return Z([D,H])}}function Z(D){if($)throw new TypeError("Generator is already executing.");for(;S;)try{if($=1,_&&(w=D[0]&2?_.return:D[0]?_.throw||((w=_.return)&&w.call(_),0):_.next)&&!(w=w.call(_,D[1])).done)return w;switch(_=0,w&&(D=[D[0]&2,w.value]),D[0]){case 0:case 1:w=D;break;case 4:return S.label++,{value:D[1],done:!1};case 5:S.label++,_=D[1],D=[0];continue;case 7:D=S.ops.pop(),S.trys.pop();continue;default:if(w=S.trys,!(w=w.length>0&&w[w.length-1])&&(D[0]===6||D[0]===2)){S=0;continue}if(D[0]===3&&(!w||D[1]>w[0]&&D[1]<w[3])){S.label=D[1];break}if(D[0]===6&&S.label<w[1]){S.label=w[1],w=D;break}if(w&&S.label<w[2]){S.label=w[2],S.ops.push(D);break}w[2]&&S.ops.pop(),S.trys.pop();continue}D=I.call(m,S)}catch(H){D=[6,H],_=0}finally{$=w=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}},G=function(m,I,S,$){$===void 0&&($=S),m[$]=I[S]},y=function(m,I){for(var S in m)S!=="default"&&!I.hasOwnProperty(S)&&(I[S]=m[S])},O=function(m){var I=typeof Symbol=="function"&&Symbol.iterator,S=I&&m[I],$=0;if(S)return S.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&$>=m.length&&(m=void 0),{value:m&&m[$++],done:!m}}};throw new TypeError(I?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(m,I){var S=typeof Symbol=="function"&&m[Symbol.iterator];if(!S)return m;var $=S.call(m),_,w=[],Y;try{for(;(I===void 0||I-- >0)&&!(_=$.next()).done;)w.push(_.value)}catch(ee){Y={error:ee}}finally{try{_&&!_.done&&(S=$.return)&&S.call($)}finally{if(Y)throw Y.error}}return w},F=function(){for(var m=[],I=0;I<arguments.length;I++)m=m.concat(N(arguments[I]));return m},V=function(){for(var m=0,I=0,S=arguments.length;I<S;I++)m+=arguments[I].length;for(var $=Array(m),_=0,I=0;I<S;I++)for(var w=arguments[I],Y=0,ee=w.length;Y<ee;Y++,_++)$[_]=w[Y];return $},j=function(m){return this instanceof j?(this.v=m,this):new j(m)},Q=function(m,I,S){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $=S.apply(m,I||[]),_,w=[];return _={},Y("next"),Y("throw"),Y("return"),_[Symbol.asyncIterator]=function(){return this},_;function Y(ce){$[ce]&&(_[ce]=function(xe){return new Promise(function(jt,be){w.push([ce,xe,jt,be])>1||ee(ce,xe)})})}function ee(ce,xe){try{Z($[ce](xe))}catch(jt){X(w[0][3],jt)}}function Z(ce){ce.value instanceof j?Promise.resolve(ce.value.v).then(D,H):X(w[0][2],ce)}function D(ce){ee("next",ce)}function H(ce){ee("throw",ce)}function X(ce,xe){ce(xe),w.shift(),w.length&&ee(w[0][0],w[0][1])}},ae=function(m){var I,S;return I={},$("next"),$("throw",function(_){throw _}),$("return"),I[Symbol.iterator]=function(){return this},I;function $(_,w){I[_]=m[_]?function(Y){return(S=!S)?{value:j(m[_](Y)),done:_==="return"}:w?w(Y):Y}:w}},he=function(m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var I=m[Symbol.asyncIterator],S;return I?I.call(m):(m=typeof O=="function"?O(m):m[Symbol.iterator](),S={},$("next"),$("throw"),$("return"),S[Symbol.asyncIterator]=function(){return this},S);function $(w){S[w]=m[w]&&function(Y){return new Promise(function(ee,Z){Y=m[w](Y),_(ee,Z,Y.done,Y.value)})}}function _(w,Y,ee,Z){Promise.resolve(Z).then(function(D){w({value:D,done:ee})},Y)}},le=function(m,I){return Object.defineProperty?Object.defineProperty(m,"raw",{value:I}):m.raw=I,m},fe=function(m){if(m&&m.__esModule)return m;var I={};if(m!=null)for(var S in m)Object.hasOwnProperty.call(m,S)&&(I[S]=m[S]);return I.default=m,I},ve=function(m){return m&&m.__esModule?m:{default:m}},me=function(m,I){if(!I.has(m))throw new TypeError("attempted to get private field on non-instance");return I.get(m)},q=function(m,I,S){if(!I.has(m))throw new TypeError("attempted to set private field on non-instance");return I.set(m,S),S},U("__extends",i),U("__assign",r),U("__rest",s),U("__decorate",a),U("__param",l),U("__metadata",d),U("__awaiter",v),U("__generator",E),U("__exportStar",y),U("__createBinding",G),U("__values",O),U("__read",N),U("__spread",F),U("__spreadArrays",V),U("__await",j),U("__asyncGenerator",Q),U("__asyncDelegator",ae),U("__asyncValues",he),U("__makeTemplateObject",le),U("__importStar",fe),U("__importDefault",ve),U("__classPrivateFieldGet",me),U("__classPrivateFieldSet",q)})})(Bn);var Fn={},Vo={},Ln={};class ki{}const h1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ki},Symbol.toStringTag,{value:"Module"})),l1=k0(h1);var Lh;function f1(){if(Lh)return Ln;Lh=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.IHeartBeat=void 0;const c=l1;class i extends c.IEvents{constructor(s){super()}}return Ln.IHeartBeat=i,Ln}var $h;function $l(){return $h||($h=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Bn.exports.__exportStar(f1(),c)}(Vo)),Vo}var Bo={},Mi={},jh;function p1(){if(jh)return Mi;jh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;const c=ue;return Mi.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mi}var Mh;function jl(){return Mh||(Mh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Bn.exports.__exportStar(p1(),c)}(Bo)),Bo}var qh;function d1(){if(qh)return Fn;qh=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.HeartBeat=void 0;const c=Bn.exports,i=mr.exports,r=ue,s=$l(),a=jl();class l extends s.IHeartBeat{constructor(v){super(v),this.events=new i.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=v?.interval||a.HEARTBEAT_INTERVAL}static init(v){return c.__awaiter(this,void 0,void 0,function*(){const E=new l(v);return yield E.init(),E})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,E){this.events.on(v,E)}once(v,E){this.events.once(v,E)}off(v,E){this.events.off(v,E)}removeListener(v,E){this.events.removeListener(v,E)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Fn.HeartBeat=l,Fn}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const i=Bn.exports;i.__exportStar(d1(),c),i.__exportStar($l(),c),i.__exportStar(jl(),c)})(dn);var Fe={},Ml={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(c){var i,r,s,a,l,d,v,E,y,O,N,F,V,j,Q,ae,he,le,fe,ve,me,q,G;(function(U){var pe=typeof wi=="object"?wi:typeof self=="object"?self:typeof this=="object"?this:{};U(m(pe,m(c.exports)));function m(I,S){return I!==pe&&(typeof Object.create=="function"?Object.defineProperty(I,"__esModule",{value:!0}):I.__esModule=!0),function($,_){return I[$]=S?S($,_):_}}})(function(U){var pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,I){m.__proto__=I}||function(m,I){for(var S in I)I.hasOwnProperty(S)&&(m[S]=I[S])};i=function(m,I){pe(m,I);function S(){this.constructor=m}m.prototype=I===null?Object.create(I):(S.prototype=I.prototype,new S)},r=Object.assign||function(m){for(var I,S=1,$=arguments.length;S<$;S++){I=arguments[S];for(var _ in I)Object.prototype.hasOwnProperty.call(I,_)&&(m[_]=I[_])}return m},s=function(m,I){var S={};for(var $ in m)Object.prototype.hasOwnProperty.call(m,$)&&I.indexOf($)<0&&(S[$]=m[$]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,$=Object.getOwnPropertySymbols(m);_<$.length;_++)I.indexOf($[_])<0&&Object.prototype.propertyIsEnumerable.call(m,$[_])&&(S[$[_]]=m[$[_]]);return S},a=function(m,I,S,$){var _=arguments.length,w=_<3?I:$===null?$=Object.getOwnPropertyDescriptor(I,S):$,Y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,I,S,$);else for(var ee=m.length-1;ee>=0;ee--)(Y=m[ee])&&(w=(_<3?Y(w):_>3?Y(I,S,w):Y(I,S))||w);return _>3&&w&&Object.defineProperty(I,S,w),w},l=function(m,I){return function(S,$){I(S,$,m)}},d=function(m,I){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,I)},v=function(m,I,S,$){function _(w){return w instanceof S?w:new S(function(Y){Y(w)})}return new(S||(S=Promise))(function(w,Y){function ee(H){try{D($.next(H))}catch(X){Y(X)}}function Z(H){try{D($.throw(H))}catch(X){Y(X)}}function D(H){H.done?w(H.value):_(H.value).then(ee,Z)}D(($=$.apply(m,I||[])).next())})},E=function(m,I){var S={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},$,_,w,Y;return Y={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(Y[Symbol.iterator]=function(){return this}),Y;function ee(D){return function(H){return Z([D,H])}}function Z(D){if($)throw new TypeError("Generator is already executing.");for(;S;)try{if($=1,_&&(w=D[0]&2?_.return:D[0]?_.throw||((w=_.return)&&w.call(_),0):_.next)&&!(w=w.call(_,D[1])).done)return w;switch(_=0,w&&(D=[D[0]&2,w.value]),D[0]){case 0:case 1:w=D;break;case 4:return S.label++,{value:D[1],done:!1};case 5:S.label++,_=D[1],D=[0];continue;case 7:D=S.ops.pop(),S.trys.pop();continue;default:if(w=S.trys,!(w=w.length>0&&w[w.length-1])&&(D[0]===6||D[0]===2)){S=0;continue}if(D[0]===3&&(!w||D[1]>w[0]&&D[1]<w[3])){S.label=D[1];break}if(D[0]===6&&S.label<w[1]){S.label=w[1],w=D;break}if(w&&S.label<w[2]){S.label=w[2],S.ops.push(D);break}w[2]&&S.ops.pop(),S.trys.pop();continue}D=I.call(m,S)}catch(H){D=[6,H],_=0}finally{$=w=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}},G=function(m,I,S,$){$===void 0&&($=S),m[$]=I[S]},y=function(m,I){for(var S in m)S!=="default"&&!I.hasOwnProperty(S)&&(I[S]=m[S])},O=function(m){var I=typeof Symbol=="function"&&Symbol.iterator,S=I&&m[I],$=0;if(S)return S.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&$>=m.length&&(m=void 0),{value:m&&m[$++],done:!m}}};throw new TypeError(I?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(m,I){var S=typeof Symbol=="function"&&m[Symbol.iterator];if(!S)return m;var $=S.call(m),_,w=[],Y;try{for(;(I===void 0||I-- >0)&&!(_=$.next()).done;)w.push(_.value)}catch(ee){Y={error:ee}}finally{try{_&&!_.done&&(S=$.return)&&S.call($)}finally{if(Y)throw Y.error}}return w},F=function(){for(var m=[],I=0;I<arguments.length;I++)m=m.concat(N(arguments[I]));return m},V=function(){for(var m=0,I=0,S=arguments.length;I<S;I++)m+=arguments[I].length;for(var $=Array(m),_=0,I=0;I<S;I++)for(var w=arguments[I],Y=0,ee=w.length;Y<ee;Y++,_++)$[_]=w[Y];return $},j=function(m){return this instanceof j?(this.v=m,this):new j(m)},Q=function(m,I,S){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $=S.apply(m,I||[]),_,w=[];return _={},Y("next"),Y("throw"),Y("return"),_[Symbol.asyncIterator]=function(){return this},_;function Y(ce){$[ce]&&(_[ce]=function(xe){return new Promise(function(jt,be){w.push([ce,xe,jt,be])>1||ee(ce,xe)})})}function ee(ce,xe){try{Z($[ce](xe))}catch(jt){X(w[0][3],jt)}}function Z(ce){ce.value instanceof j?Promise.resolve(ce.value.v).then(D,H):X(w[0][2],ce)}function D(ce){ee("next",ce)}function H(ce){ee("throw",ce)}function X(ce,xe){ce(xe),w.shift(),w.length&&ee(w[0][0],w[0][1])}},ae=function(m){var I,S;return I={},$("next"),$("throw",function(_){throw _}),$("return"),I[Symbol.iterator]=function(){return this},I;function $(_,w){I[_]=m[_]?function(Y){return(S=!S)?{value:j(m[_](Y)),done:_==="return"}:w?w(Y):Y}:w}},he=function(m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var I=m[Symbol.asyncIterator],S;return I?I.call(m):(m=typeof O=="function"?O(m):m[Symbol.iterator](),S={},$("next"),$("throw"),$("return"),S[Symbol.asyncIterator]=function(){return this},S);function $(w){S[w]=m[w]&&function(Y){return new Promise(function(ee,Z){Y=m[w](Y),_(ee,Z,Y.done,Y.value)})}}function _(w,Y,ee,Z){Promise.resolve(Z).then(function(D){w({value:D,done:ee})},Y)}},le=function(m,I){return Object.defineProperty?Object.defineProperty(m,"raw",{value:I}):m.raw=I,m},fe=function(m){if(m&&m.__esModule)return m;var I={};if(m!=null)for(var S in m)Object.hasOwnProperty.call(m,S)&&(I[S]=m[S]);return I.default=m,I},ve=function(m){return m&&m.__esModule?m:{default:m}},me=function(m,I){if(!I.has(m))throw new TypeError("attempted to get private field on non-instance");return I.get(m)},q=function(m,I,S){if(!I.has(m))throw new TypeError("attempted to set private field on non-instance");return I.set(m,S),S},U("__extends",i),U("__assign",r),U("__rest",s),U("__decorate",a),U("__param",l),U("__metadata",d),U("__awaiter",v),U("__generator",E),U("__exportStar",y),U("__createBinding",G),U("__values",O),U("__read",N),U("__spread",F),U("__spreadArrays",V),U("__await",j),U("__asyncGenerator",Q),U("__asyncDelegator",ae),U("__asyncValues",he),U("__makeTemplateObject",le),U("__importStar",fe),U("__importDefault",ve),U("__classPrivateFieldGet",me),U("__classPrivateFieldSet",q)})})(Ml);var Go,zh;function g1(){if(zh)return Go;zh=1;function c(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Go=i;function i(r,s,a){var l=a&&a.stringify||c,d=1;if(typeof r=="object"&&r!==null){var v=s.length+d;if(v===1)return r;var E=new Array(v);E[0]=l(r);for(var y=1;y<v;y++)E[y]=l(s[y]);return E.join(" ")}if(typeof r!="string")return r;var O=s.length;if(O===0)return r;for(var N="",F=1-d,V=-1,j=r&&r.length||0,Q=0;Q<j;){if(r.charCodeAt(Q)===37&&Q+1<j){switch(V=V>-1?V:0,r.charCodeAt(Q+1)){case 100:case 102:if(F>=O||s[F]==null)break;V<Q&&(N+=r.slice(V,Q)),N+=Number(s[F]),V=Q+2,Q++;break;case 105:if(F>=O||s[F]==null)break;V<Q&&(N+=r.slice(V,Q)),N+=Math.floor(Number(s[F])),V=Q+2,Q++;break;case 79:case 111:case 106:if(F>=O||s[F]===void 0)break;V<Q&&(N+=r.slice(V,Q));var ae=typeof s[F];if(ae==="string"){N+="'"+s[F]+"'",V=Q+2,Q++;break}if(ae==="function"){N+=s[F].name||"<anonymous>",V=Q+2,Q++;break}N+=l(s[F]),V=Q+2,Q++;break;case 115:if(F>=O)break;V<Q&&(N+=r.slice(V,Q)),N+=String(s[F]),V=Q+2,Q++;break;case 37:V<Q&&(N+=r.slice(V,Q)),N+="%",V=Q+2,Q++,F--;break}++F}++Q}return V===-1?r:(V<j&&(N+=r.slice(V)),N)}return Go}var Wo,Uh;function y1(){if(Uh)return Wo;Uh=1;const c=g1();Wo=a;const i=me().console||{},r={mapHttpRequest:j,mapHttpResponse:j,wrapRequestSerializer:Q,wrapResponseSerializer:Q,wrapErrorSerializer:Q,req:j,res:j,err:F};function s(q,G){return Array.isArray(q)?q.filter(function(pe){return pe!=="!stdSerializers.err"}):q===!0?Object.keys(G):!1}function a(q){q=q||{},q.browser=q.browser||{};const G=q.browser.transmit;if(G&&typeof G.send!="function")throw Error("pino: transmit option must have a send function");const U=q.browser.write||i;q.browser.write&&(q.browser.asObject=!0);const pe=q.serializers||{},m=s(q.browser.serialize,pe);let I=q.browser.serialize;Array.isArray(q.browser.serialize)&&q.browser.serialize.indexOf("!stdSerializers.err")>-1&&(I=!1);const S=["error","fatal","warn","info","debug","trace"];typeof U=="function"&&(U.error=U.fatal=U.warn=U.info=U.debug=U.trace=U),q.enabled===!1&&(q.level="silent");const $=q.level||"info",_=Object.create(U);_.log||(_.log=ae),Object.defineProperty(_,"levelVal",{get:Y}),Object.defineProperty(_,"level",{get:ee,set:Z});const w={transmit:G,serialize:m,asObject:q.browser.asObject,levels:S,timestamp:V(q)};_.levels=a.levels,_.level=$,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=ae,_.serializers=pe,_._serialize=m,_._stdErrSerialize=I,_.child=D,G&&(_._logEvent=N());function Y(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ee(){return this._level}function Z(H){if(H!=="silent"&&!this.levels.values[H])throw Error("unknown level "+H);this._level=H,l(w,_,"error","log"),l(w,_,"fatal","error"),l(w,_,"warn","error"),l(w,_,"info","log"),l(w,_,"debug","log"),l(w,_,"trace","log")}function D(H,X){if(!H)throw new Error("missing bindings for child Pino");X=X||{},m&&H.serializers&&(X.serializers=H.serializers);const ce=X.serializers;if(m&&ce){var xe=Object.assign({},pe,ce),jt=q.browser.serialize===!0?Object.keys(xe):m;delete H.serializers,E([H],jt,xe,this._stdErrSerialize)}function be(It){this._childLevel=(It._childLevel|0)+1,this.error=y(It,H,"error"),this.fatal=y(It,H,"fatal"),this.warn=y(It,H,"warn"),this.info=y(It,H,"info"),this.debug=y(It,H,"debug"),this.trace=y(It,H,"trace"),xe&&(this.serializers=xe,this._serialize=jt),G&&(this._logEvent=N([].concat(It._logEvent.bindings,H)))}return be.prototype=this,new be(this)}return _}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:ve});function l(q,G,U,pe){const m=Object.getPrototypeOf(G);G[U]=G.levelVal>G.levels.values[U]?ae:m[U]?m[U]:i[U]||i[pe]||ae,d(q,G,U)}function d(q,G,U){!q.transmit&&G[U]===ae||(G[U]=function(pe){return function(){const I=q.timestamp(),S=new Array(arguments.length),$=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var _=0;_<S.length;_++)S[_]=arguments[_];if(q.serialize&&!q.asObject&&E(S,this._serialize,this.serializers,this._stdErrSerialize),q.asObject?pe.call($,v(this,U,S,I)):pe.apply($,S),q.transmit){const w=q.transmit.level||G.level,Y=a.levels.values[w],ee=a.levels.values[U];if(ee<Y)return;O(this,{ts:I,methodLevel:U,methodValue:ee,transmitLevel:w,transmitValue:a.levels.values[q.transmit.level||G.level],send:q.transmit.send,val:G.levelVal},S)}}}(G[U]))}function v(q,G,U,pe){q._serialize&&E(U,q._serialize,q.serializers,q._stdErrSerialize);const m=U.slice();let I=m[0];const S={};pe&&(S.time=pe),S.level=a.levels.values[G];let $=(q._childLevel|0)+1;if($<1&&($=1),I!==null&&typeof I=="object"){for(;$--&&typeof m[0]=="object";)Object.assign(S,m.shift());I=m.length?c(m.shift(),m):void 0}else typeof I=="string"&&(I=c(m.shift(),m));return I!==void 0&&(S.msg=I),S}function E(q,G,U,pe){for(const m in q)if(pe&&q[m]instanceof Error)q[m]=a.stdSerializers.err(q[m]);else if(typeof q[m]=="object"&&!Array.isArray(q[m]))for(const I in q[m])G&&G.indexOf(I)>-1&&I in U&&(q[m][I]=U[I](q[m][I]))}function y(q,G,U){return function(){const pe=new Array(1+arguments.length);pe[0]=G;for(var m=1;m<pe.length;m++)pe[m]=arguments[m-1];return q[U].apply(this,pe)}}function O(q,G,U){const pe=G.send,m=G.ts,I=G.methodLevel,S=G.methodValue,$=G.val,_=q._logEvent.bindings;E(U,q._serialize||Object.keys(q.serializers),q.serializers,q._stdErrSerialize===void 0?!0:q._stdErrSerialize),q._logEvent.ts=m,q._logEvent.messages=U.filter(function(w){return _.indexOf(w)===-1}),q._logEvent.level.label=I,q._logEvent.level.value=S,pe(I,q._logEvent,$),q._logEvent=N(_)}function N(q){return{ts:0,messages:[],bindings:q||[],level:{label:"",value:0}}}function F(q){const G={type:q.constructor.name,msg:q.message,stack:q.stack};for(const U in q)G[U]===void 0&&(G[U]=q[U]);return G}function V(q){return typeof q.timestamp=="function"?q.timestamp:q.timestamp===!1?he:le}function j(){return{}}function Q(q){return q}function ae(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function ve(){return new Date(Date.now()).toISOString()}function me(){function q(G){return typeof G<"u"&&G}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return q(self)||q(window)||q(this)||{}}}return Wo}var qi={},kh;function ql(){return kh||(kh=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.PINO_CUSTOM_CONTEXT_KEY=qi.PINO_LOGGER_DEFAULTS=void 0,qi.PINO_LOGGER_DEFAULTS={level:"info"},qi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),qi}var tr={},Hh;function v1(){if(Hh)return tr;Hh=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.generateChildLogger=tr.formatChildLoggerContext=tr.getLoggerContext=tr.setBrowserLoggerContext=tr.getBrowserLoggerContext=tr.getDefaultLoggerOptions=void 0;const c=ql();function i(v){return Object.assign(Object.assign({},v),{level:v?.level||c.PINO_LOGGER_DEFAULTS.level})}tr.getDefaultLoggerOptions=i;function r(v,E=c.PINO_CUSTOM_CONTEXT_KEY){return v[E]||""}tr.getBrowserLoggerContext=r;function s(v,E,y=c.PINO_CUSTOM_CONTEXT_KEY){return v[y]=E,v}tr.setBrowserLoggerContext=s;function a(v,E=c.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof v.bindings>"u"?y=r(v,E):y=v.bindings().context||"",y}tr.getLoggerContext=a;function l(v,E,y=c.PINO_CUSTOM_CONTEXT_KEY){const O=a(v,y);return O.trim()?`${O}/${E}`:E}tr.formatChildLoggerContext=l;function d(v,E,y=c.PINO_CUSTOM_CONTEXT_KEY){const O=l(v,E,y),N=v.child({context:O});return s(N,O,y)}return tr.generateChildLogger=d,tr}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const i=Ml.exports,r=i.__importDefault(y1());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(ql(),c),i.__exportStar(v1(),c)})(Fe);class m1 extends ki{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class _1 extends ki{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class w1{constructor(i,r){this.logger=i,this.core=r}}class b1 extends ki{constructor(i,r){super(),this.relayer=i,this.logger=r}}class E1 extends ki{constructor(i){super()}}class I1{constructor(i,r,s,a){this.core=i,this.logger=r,this.name=s}}class x1 extends ki{constructor(i,r){super(),this.relayer=i,this.logger=r}}class S1 extends ki{constructor(i,r){super(),this.core=i,this.logger=r}}class P1{constructor(i,r){this.projectId=i,this.logger=r}}class O1{constructor(i){this.opts=i,this.protocol="wc",this.version=2}}class C1{constructor(i){this.client=i}}var _c={},zl={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var i=H0,r=Pl;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var s=function(){function v(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},v.prototype.update=function(E,y){if(y===void 0&&(y=E.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var O=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=E[O++],y--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(O=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,E,O,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=E[O++],y--;return this},v.prototype.finish=function(E){if(!this._finished){var y=this._bytesHashed,O=this._bufferLength,N=y/536870912|0,F=y<<3,V=y%128<112?128:256;this._buffer[O]=128;for(var j=O+1;j<V-8;j++)this._buffer[j]=0;i.writeUint32BE(N,this._buffer,V-8),i.writeUint32BE(F,this._buffer,V-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,V),this._finished=!0}for(var j=0;j<this.digestLength/8;j++)i.writeUint32BE(this._stateHi[j],E,j*8),i.writeUint32BE(this._stateLo[j],E,j*8+4);return this},v.prototype.digest=function(){var E=new Uint8Array(this.digestLength);return this.finish(E),E},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(E){return this._stateHi.set(E.stateHi),this._stateLo.set(E.stateLo),this._bufferLength=E.bufferLength,E.buffer&&this._buffer.set(E.buffer),this._bytesHashed=E.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(E){r.wipe(E.stateHi),r.wipe(E.stateLo),E.buffer&&r.wipe(E.buffer),E.bufferLength=0,E.bytesHashed=0},v}();c.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(v,E,y,O,N,F,V){for(var j=y[0],Q=y[1],ae=y[2],he=y[3],le=y[4],fe=y[5],ve=y[6],me=y[7],q=O[0],G=O[1],U=O[2],pe=O[3],m=O[4],I=O[5],S=O[6],$=O[7],_,w,Y,ee,Z,D,H,X;V>=128;){for(var ce=0;ce<16;ce++){var xe=8*ce+F;v[ce]=i.readUint32BE(N,xe),E[ce]=i.readUint32BE(N,xe+4)}for(var ce=0;ce<80;ce++){var jt=j,be=Q,It=ae,z=he,M=le,T=fe,u=ve,P=me,se=q,_e=G,Pe=U,Le=pe,je=m,Re=I,xt=S,vt=$;if(_=me,w=$,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=(le>>>14|m<<32-14)^(le>>>18|m<<32-18)^(m>>>41-32|le<<32-(41-32)),w=(m>>>14|le<<32-14)^(m>>>18|le<<32-18)^(le>>>41-32|m<<32-(41-32)),Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,_=le&fe^~le&ve,w=m&I^~m&S,Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,_=a[ce*2],w=a[ce*2+1],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,_=v[ce%16],w=E[ce%16],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,Y=H&65535|X<<16,ee=Z&65535|D<<16,_=Y,w=ee,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=(j>>>28|q<<32-28)^(q>>>34-32|j<<32-(34-32))^(q>>>39-32|j<<32-(39-32)),w=(q>>>28|j<<32-28)^(j>>>34-32|q<<32-(34-32))^(j>>>39-32|q<<32-(39-32)),Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,_=j&Q^j&ae^Q&ae,w=q&G^q&U^G&U,Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,P=H&65535|X<<16,vt=Z&65535|D<<16,_=z,w=Le,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=Y,w=ee,Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,z=H&65535|X<<16,Le=Z&65535|D<<16,Q=jt,ae=be,he=It,le=z,fe=M,ve=T,me=u,j=P,G=se,U=_e,pe=Pe,m=Le,I=je,S=Re,$=xt,q=vt,ce%16===15)for(var xe=0;xe<16;xe++)_=v[xe],w=E[xe],Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=v[(xe+9)%16],w=E[(xe+9)%16],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,Y=v[(xe+1)%16],ee=E[(xe+1)%16],_=(Y>>>1|ee<<32-1)^(Y>>>8|ee<<32-8)^Y>>>7,w=(ee>>>1|Y<<32-1)^(ee>>>8|Y<<32-8)^(ee>>>7|Y<<32-7),Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,Y=v[(xe+14)%16],ee=E[(xe+14)%16],_=(Y>>>19|ee<<32-19)^(ee>>>61-32|Y<<32-(61-32))^Y>>>6,w=(ee>>>19|Y<<32-19)^(Y>>>61-32|ee<<32-(61-32))^(ee>>>6|Y<<32-6),Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,v[xe]=H&65535|X<<16,E[xe]=Z&65535|D<<16}_=j,w=q,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[0],w=O[0],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[0]=j=H&65535|X<<16,O[0]=q=Z&65535|D<<16,_=Q,w=G,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[1],w=O[1],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[1]=Q=H&65535|X<<16,O[1]=G=Z&65535|D<<16,_=ae,w=U,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[2],w=O[2],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[2]=ae=H&65535|X<<16,O[2]=U=Z&65535|D<<16,_=he,w=pe,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[3],w=O[3],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[3]=he=H&65535|X<<16,O[3]=pe=Z&65535|D<<16,_=le,w=m,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[4],w=O[4],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[4]=le=H&65535|X<<16,O[4]=m=Z&65535|D<<16,_=fe,w=I,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[5],w=O[5],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[5]=fe=H&65535|X<<16,O[5]=I=Z&65535|D<<16,_=ve,w=S,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[6],w=O[6],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[6]=ve=H&65535|X<<16,O[6]=S=Z&65535|D<<16,_=me,w=$,Z=w&65535,D=w>>>16,H=_&65535,X=_>>>16,_=y[7],w=O[7],Z+=w&65535,D+=w>>>16,H+=_&65535,X+=_>>>16,D+=Z>>>16,H+=D>>>16,X+=H>>>16,y[7]=me=H&65535|X<<16,O[7]=$=Z&65535|D<<16,F+=128,V-=128}return F}function d(v){var E=new s;E.update(v);var y=E.digest();return E.clean(),y}c.hash=d})(zl);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const i=Ol,r=zl,s=Pl;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function a(z){const M=new Float64Array(16);if(z)for(let T=0;T<z.length;T++)M[T]=z[T];return M}const l=new Uint8Array(32);l[0]=9;const d=a(),v=a([1]),E=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),O=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),F=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function V(z,M){for(let T=0;T<16;T++)z[T]=M[T]|0}function j(z){let M=1;for(let T=0;T<16;T++){let u=z[T]+M+65535;M=Math.floor(u/65536),z[T]=u-M*65536}z[0]+=M-1+37*(M-1)}function Q(z,M,T){const u=~(T-1);for(let P=0;P<16;P++){const se=u&(z[P]^M[P]);z[P]^=se,M[P]^=se}}function ae(z,M){const T=a(),u=a();for(let P=0;P<16;P++)u[P]=M[P];j(u),j(u),j(u);for(let P=0;P<2;P++){T[0]=u[0]-65517;for(let _e=1;_e<15;_e++)T[_e]=u[_e]-65535-(T[_e-1]>>16&1),T[_e-1]&=65535;T[15]=u[15]-32767-(T[14]>>16&1);const se=T[15]>>16&1;T[14]&=65535,Q(u,T,1-se)}for(let P=0;P<16;P++)z[2*P]=u[P]&255,z[2*P+1]=u[P]>>8}function he(z,M){let T=0;for(let u=0;u<32;u++)T|=z[u]^M[u];return(1&T-1>>>8)-1}function le(z,M){const T=new Uint8Array(32),u=new Uint8Array(32);return ae(T,z),ae(u,M),he(T,u)}function fe(z){const M=new Uint8Array(32);return ae(M,z),M[0]&1}function ve(z,M){for(let T=0;T<16;T++)z[T]=M[2*T]+(M[2*T+1]<<8);z[15]&=32767}function me(z,M,T){for(let u=0;u<16;u++)z[u]=M[u]+T[u]}function q(z,M,T){for(let u=0;u<16;u++)z[u]=M[u]-T[u]}function G(z,M,T){let u,P,se=0,_e=0,Pe=0,Le=0,je=0,Re=0,xt=0,vt=0,st=0,qe=0,Qe=0,Xe=0,at=0,He=0,Ze=0,$e=0,Ve=0,ut=0,Ue=0,St=0,Ft=0,kt=0,Ht=0,Mt=0,Jt=0,ir=0,jr=0,Yt=0,Vr=0,ai=0,xi=0,ht=T[0],rt=T[1],lt=T[2],ft=T[3],ot=T[4],it=T[5],Pt=T[6],Ot=T[7],pt=T[8],Ct=T[9],dt=T[10],mt=T[11],gt=T[12],Ye=T[13],At=T[14],Rt=T[15];u=M[0],se+=u*ht,_e+=u*rt,Pe+=u*lt,Le+=u*ft,je+=u*ot,Re+=u*it,xt+=u*Pt,vt+=u*Ot,st+=u*pt,qe+=u*Ct,Qe+=u*dt,Xe+=u*mt,at+=u*gt,He+=u*Ye,Ze+=u*At,$e+=u*Rt,u=M[1],_e+=u*ht,Pe+=u*rt,Le+=u*lt,je+=u*ft,Re+=u*ot,xt+=u*it,vt+=u*Pt,st+=u*Ot,qe+=u*pt,Qe+=u*Ct,Xe+=u*dt,at+=u*mt,He+=u*gt,Ze+=u*Ye,$e+=u*At,Ve+=u*Rt,u=M[2],Pe+=u*ht,Le+=u*rt,je+=u*lt,Re+=u*ft,xt+=u*ot,vt+=u*it,st+=u*Pt,qe+=u*Ot,Qe+=u*pt,Xe+=u*Ct,at+=u*dt,He+=u*mt,Ze+=u*gt,$e+=u*Ye,Ve+=u*At,ut+=u*Rt,u=M[3],Le+=u*ht,je+=u*rt,Re+=u*lt,xt+=u*ft,vt+=u*ot,st+=u*it,qe+=u*Pt,Qe+=u*Ot,Xe+=u*pt,at+=u*Ct,He+=u*dt,Ze+=u*mt,$e+=u*gt,Ve+=u*Ye,ut+=u*At,Ue+=u*Rt,u=M[4],je+=u*ht,Re+=u*rt,xt+=u*lt,vt+=u*ft,st+=u*ot,qe+=u*it,Qe+=u*Pt,Xe+=u*Ot,at+=u*pt,He+=u*Ct,Ze+=u*dt,$e+=u*mt,Ve+=u*gt,ut+=u*Ye,Ue+=u*At,St+=u*Rt,u=M[5],Re+=u*ht,xt+=u*rt,vt+=u*lt,st+=u*ft,qe+=u*ot,Qe+=u*it,Xe+=u*Pt,at+=u*Ot,He+=u*pt,Ze+=u*Ct,$e+=u*dt,Ve+=u*mt,ut+=u*gt,Ue+=u*Ye,St+=u*At,Ft+=u*Rt,u=M[6],xt+=u*ht,vt+=u*rt,st+=u*lt,qe+=u*ft,Qe+=u*ot,Xe+=u*it,at+=u*Pt,He+=u*Ot,Ze+=u*pt,$e+=u*Ct,Ve+=u*dt,ut+=u*mt,Ue+=u*gt,St+=u*Ye,Ft+=u*At,kt+=u*Rt,u=M[7],vt+=u*ht,st+=u*rt,qe+=u*lt,Qe+=u*ft,Xe+=u*ot,at+=u*it,He+=u*Pt,Ze+=u*Ot,$e+=u*pt,Ve+=u*Ct,ut+=u*dt,Ue+=u*mt,St+=u*gt,Ft+=u*Ye,kt+=u*At,Ht+=u*Rt,u=M[8],st+=u*ht,qe+=u*rt,Qe+=u*lt,Xe+=u*ft,at+=u*ot,He+=u*it,Ze+=u*Pt,$e+=u*Ot,Ve+=u*pt,ut+=u*Ct,Ue+=u*dt,St+=u*mt,Ft+=u*gt,kt+=u*Ye,Ht+=u*At,Mt+=u*Rt,u=M[9],qe+=u*ht,Qe+=u*rt,Xe+=u*lt,at+=u*ft,He+=u*ot,Ze+=u*it,$e+=u*Pt,Ve+=u*Ot,ut+=u*pt,Ue+=u*Ct,St+=u*dt,Ft+=u*mt,kt+=u*gt,Ht+=u*Ye,Mt+=u*At,Jt+=u*Rt,u=M[10],Qe+=u*ht,Xe+=u*rt,at+=u*lt,He+=u*ft,Ze+=u*ot,$e+=u*it,Ve+=u*Pt,ut+=u*Ot,Ue+=u*pt,St+=u*Ct,Ft+=u*dt,kt+=u*mt,Ht+=u*gt,Mt+=u*Ye,Jt+=u*At,ir+=u*Rt,u=M[11],Xe+=u*ht,at+=u*rt,He+=u*lt,Ze+=u*ft,$e+=u*ot,Ve+=u*it,ut+=u*Pt,Ue+=u*Ot,St+=u*pt,Ft+=u*Ct,kt+=u*dt,Ht+=u*mt,Mt+=u*gt,Jt+=u*Ye,ir+=u*At,jr+=u*Rt,u=M[12],at+=u*ht,He+=u*rt,Ze+=u*lt,$e+=u*ft,Ve+=u*ot,ut+=u*it,Ue+=u*Pt,St+=u*Ot,Ft+=u*pt,kt+=u*Ct,Ht+=u*dt,Mt+=u*mt,Jt+=u*gt,ir+=u*Ye,jr+=u*At,Yt+=u*Rt,u=M[13],He+=u*ht,Ze+=u*rt,$e+=u*lt,Ve+=u*ft,ut+=u*ot,Ue+=u*it,St+=u*Pt,Ft+=u*Ot,kt+=u*pt,Ht+=u*Ct,Mt+=u*dt,Jt+=u*mt,ir+=u*gt,jr+=u*Ye,Yt+=u*At,Vr+=u*Rt,u=M[14],Ze+=u*ht,$e+=u*rt,Ve+=u*lt,ut+=u*ft,Ue+=u*ot,St+=u*it,Ft+=u*Pt,kt+=u*Ot,Ht+=u*pt,Mt+=u*Ct,Jt+=u*dt,ir+=u*mt,jr+=u*gt,Yt+=u*Ye,Vr+=u*At,ai+=u*Rt,u=M[15],$e+=u*ht,Ve+=u*rt,ut+=u*lt,Ue+=u*ft,St+=u*ot,Ft+=u*it,kt+=u*Pt,Ht+=u*Ot,Mt+=u*pt,Jt+=u*Ct,ir+=u*dt,jr+=u*mt,Yt+=u*gt,Vr+=u*Ye,ai+=u*At,xi+=u*Rt,se+=38*Ve,_e+=38*ut,Pe+=38*Ue,Le+=38*St,je+=38*Ft,Re+=38*kt,xt+=38*Ht,vt+=38*Mt,st+=38*Jt,qe+=38*ir,Qe+=38*jr,Xe+=38*Yt,at+=38*Vr,He+=38*ai,Ze+=38*xi,P=1,u=se+P+65535,P=Math.floor(u/65536),se=u-P*65536,u=_e+P+65535,P=Math.floor(u/65536),_e=u-P*65536,u=Pe+P+65535,P=Math.floor(u/65536),Pe=u-P*65536,u=Le+P+65535,P=Math.floor(u/65536),Le=u-P*65536,u=je+P+65535,P=Math.floor(u/65536),je=u-P*65536,u=Re+P+65535,P=Math.floor(u/65536),Re=u-P*65536,u=xt+P+65535,P=Math.floor(u/65536),xt=u-P*65536,u=vt+P+65535,P=Math.floor(u/65536),vt=u-P*65536,u=st+P+65535,P=Math.floor(u/65536),st=u-P*65536,u=qe+P+65535,P=Math.floor(u/65536),qe=u-P*65536,u=Qe+P+65535,P=Math.floor(u/65536),Qe=u-P*65536,u=Xe+P+65535,P=Math.floor(u/65536),Xe=u-P*65536,u=at+P+65535,P=Math.floor(u/65536),at=u-P*65536,u=He+P+65535,P=Math.floor(u/65536),He=u-P*65536,u=Ze+P+65535,P=Math.floor(u/65536),Ze=u-P*65536,u=$e+P+65535,P=Math.floor(u/65536),$e=u-P*65536,se+=P-1+37*(P-1),P=1,u=se+P+65535,P=Math.floor(u/65536),se=u-P*65536,u=_e+P+65535,P=Math.floor(u/65536),_e=u-P*65536,u=Pe+P+65535,P=Math.floor(u/65536),Pe=u-P*65536,u=Le+P+65535,P=Math.floor(u/65536),Le=u-P*65536,u=je+P+65535,P=Math.floor(u/65536),je=u-P*65536,u=Re+P+65535,P=Math.floor(u/65536),Re=u-P*65536,u=xt+P+65535,P=Math.floor(u/65536),xt=u-P*65536,u=vt+P+65535,P=Math.floor(u/65536),vt=u-P*65536,u=st+P+65535,P=Math.floor(u/65536),st=u-P*65536,u=qe+P+65535,P=Math.floor(u/65536),qe=u-P*65536,u=Qe+P+65535,P=Math.floor(u/65536),Qe=u-P*65536,u=Xe+P+65535,P=Math.floor(u/65536),Xe=u-P*65536,u=at+P+65535,P=Math.floor(u/65536),at=u-P*65536,u=He+P+65535,P=Math.floor(u/65536),He=u-P*65536,u=Ze+P+65535,P=Math.floor(u/65536),Ze=u-P*65536,u=$e+P+65535,P=Math.floor(u/65536),$e=u-P*65536,se+=P-1+37*(P-1),z[0]=se,z[1]=_e,z[2]=Pe,z[3]=Le,z[4]=je,z[5]=Re,z[6]=xt,z[7]=vt,z[8]=st,z[9]=qe,z[10]=Qe,z[11]=Xe,z[12]=at,z[13]=He,z[14]=Ze,z[15]=$e}function U(z,M){G(z,M,M)}function pe(z,M){const T=a();let u;for(u=0;u<16;u++)T[u]=M[u];for(u=253;u>=0;u--)U(T,T),u!==2&&u!==4&&G(T,T,M);for(u=0;u<16;u++)z[u]=T[u]}function m(z,M){const T=a();let u;for(u=0;u<16;u++)T[u]=M[u];for(u=250;u>=0;u--)U(T,T),u!==1&&G(T,T,M);for(u=0;u<16;u++)z[u]=T[u]}function I(z,M){const T=a(),u=a(),P=a(),se=a(),_e=a(),Pe=a(),Le=a(),je=a(),Re=a();q(T,z[1],z[0]),q(Re,M[1],M[0]),G(T,T,Re),me(u,z[0],z[1]),me(Re,M[0],M[1]),G(u,u,Re),G(P,z[3],M[3]),G(P,P,y),G(se,z[2],M[2]),me(se,se,se),q(_e,u,T),q(Pe,se,P),me(Le,se,P),me(je,u,T),G(z[0],_e,Pe),G(z[1],je,Le),G(z[2],Le,Pe),G(z[3],_e,je)}function S(z,M,T){for(let u=0;u<4;u++)Q(z[u],M[u],T)}function $(z,M){const T=a(),u=a(),P=a();pe(P,M[2]),G(T,M[0],P),G(u,M[1],P),ae(z,u),z[31]^=fe(T)<<7}function _(z,M,T){V(z[0],d),V(z[1],v),V(z[2],v),V(z[3],d);for(let u=255;u>=0;--u){const P=T[u/8|0]>>(u&7)&1;S(z,M,P),I(M,z),I(z,z),S(z,M,P)}}function w(z,M){const T=[a(),a(),a(),a()];V(T[0],O),V(T[1],N),V(T[2],v),G(T[3],O,N),_(z,T,M)}function Y(z){if(z.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const M=(0,r.hash)(z);M[0]&=248,M[31]&=127,M[31]|=64;const T=new Uint8Array(32),u=[a(),a(),a(),a()];w(u,M),$(T,u);const P=new Uint8Array(64);return P.set(z),P.set(T,32),{publicKey:T,secretKey:P}}c.generateKeyPairFromSeed=Y;function ee(z){const M=(0,i.randomBytes)(32,z),T=Y(M);return(0,s.wipe)(M),T}c.generateKeyPair=ee;function Z(z){if(z.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}c.extractPublicKeyFromSecretKey=Z;const D=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function H(z,M){let T,u,P,se;for(u=63;u>=32;--u){for(T=0,P=u-32,se=u-12;P<se;++P)M[P]+=T-16*M[u]*D[P-(u-32)],T=Math.floor((M[P]+128)/256),M[P]-=T*256;M[P]+=T,M[u]=0}for(T=0,P=0;P<32;P++)M[P]+=T-(M[31]>>4)*D[P],T=M[P]>>8,M[P]&=255;for(P=0;P<32;P++)M[P]-=T*D[P];for(u=0;u<32;u++)M[u+1]+=M[u]>>8,z[u]=M[u]&255}function X(z){const M=new Float64Array(64);for(let T=0;T<64;T++)M[T]=z[T];for(let T=0;T<64;T++)z[T]=0;H(z,M)}function ce(z,M){const T=new Float64Array(64),u=[a(),a(),a(),a()],P=(0,r.hash)(z.subarray(0,32));P[0]&=248,P[31]&=127,P[31]|=64;const se=new Uint8Array(64);se.set(P.subarray(32),32);const _e=new r.SHA512;_e.update(se.subarray(32)),_e.update(M);const Pe=_e.digest();_e.clean(),X(Pe),w(u,Pe),$(se,u),_e.reset(),_e.update(se.subarray(0,32)),_e.update(z.subarray(32)),_e.update(M);const Le=_e.digest();X(Le);for(let je=0;je<32;je++)T[je]=Pe[je];for(let je=0;je<32;je++)for(let Re=0;Re<32;Re++)T[je+Re]+=Le[je]*P[Re];return H(se.subarray(32),T),se}c.sign=ce;function xe(z,M){const T=a(),u=a(),P=a(),se=a(),_e=a(),Pe=a(),Le=a();return V(z[2],v),ve(z[1],M),U(P,z[1]),G(se,P,E),q(P,P,z[2]),me(se,z[2],se),U(_e,se),U(Pe,_e),G(Le,Pe,_e),G(T,Le,P),G(T,T,se),m(T,T),G(T,T,P),G(T,T,se),G(T,T,se),G(z[0],T,se),U(u,z[0]),G(u,u,se),le(u,P)&&G(z[0],z[0],F),U(u,z[0]),G(u,u,se),le(u,P)?-1:(fe(z[0])===M[31]>>7&&q(z[0],d,z[0]),G(z[3],z[0],z[1]),0)}function jt(z,M,T){const u=new Uint8Array(32),P=[a(),a(),a(),a()],se=[a(),a(),a(),a()];if(T.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(xe(se,z))return!1;const _e=new r.SHA512;_e.update(T.subarray(0,32)),_e.update(z),_e.update(M);const Pe=_e.digest();return X(Pe),_(P,se,Pe),w(se,T.subarray(32)),I(P,se),$(u,P),!he(T,u)}c.verify=jt;function be(z){let M=[a(),a(),a(),a()];if(xe(M,z))throw new Error("Ed25519: invalid public key");let T=a(),u=a(),P=M[1];me(T,v,P),q(u,v,P),pe(u,u),G(T,T,u);let se=new Uint8Array(32);return ae(se,T),se}c.convertPublicKeyToX25519=be;function It(z){const M=(0,r.hash)(z.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const T=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),T}c.convertSecretKeyToX25519=It})(_c);const A1="EdDSA",R1="JWT",Ul=".",kl="base64url",T1="utf8",N1="utf8",D1=":",F1="did",L1="key",Kh="base58btc",$1="z",j1="K36",M1=32;function ha(c){return fa(dc(Kn(c),T1),kl)}function Hl(c){const i=dc(j1,Kh),r=$1+fa(K0([i,c]),Kh);return[F1,L1,r].join(D1)}function q1(c){return fa(c,kl)}function z1(c){return dc([ha(c.header),ha(c.payload)].join(Ul),N1)}function U1(c){return[ha(c.header),ha(c.payload),q1(c.signature)].join(Ul)}function Vh(c=Ol.randomBytes(M1)){return _c.generateKeyPairFromSeed(c)}async function k1(c,i,r,s,a=ue.fromMiliseconds(Date.now())){const l={alg:A1,typ:R1},d=Hl(s.publicKey),v=a+r,E={iss:d,sub:c,aud:i,iat:a,exp:v},y=z1({header:l,payload:E}),O=_c.sign(s.secretKey,y);return U1({header:l,payload:E,signature:O})}const H1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),K1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Bh=c=>c.split("?")[0],Gh=10,V1=H1();class B1{constructor(i){if(this.url=i,this.events=new mr.exports.EventEmitter,this.registering=!1,!Rh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Kn(i))}catch(s){this.onError(i.id,s)}}register(i=this.url){if(!Rh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,s)=>{const a=Am.isReactNative()?void 0:{rejectUnauthorized:!Rm(i)},l=new V1(i,[],a);K1()?l.onerror=d=>{const v=d;s(this.emitError(v.error))}:l.on("error",d=>{s(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?pa(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const s=this.parseError(r),a=s.message||s.toString(),l=gc(i,a);this.events.emit("payload",l)}parseError(i,r=this.url){return Tm(i,Bh(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Gh&&this.events.setMaxListeners(Gh)}emitError(i){const r=this.parseError(new Error(i?.message||`WebSocket connection failed for host: ${Bh(this.url)}`));return this.events.emit("register_error",r),r}}var oc={exports:{}};(function(c,i){var r=200,s="__lodash_hash_undefined__",a=1,l=2,d=9007199254740991,v="[object Arguments]",E="[object Array]",y="[object AsyncFunction]",O="[object Boolean]",N="[object Date]",F="[object Error]",V="[object Function]",j="[object GeneratorFunction]",Q="[object Map]",ae="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",ve="[object Proxy]",me="[object RegExp]",q="[object Set]",G="[object String]",U="[object Symbol]",pe="[object Undefined]",m="[object WeakMap]",I="[object ArrayBuffer]",S="[object DataView]",$="[object Float32Array]",_="[object Float64Array]",w="[object Int8Array]",Y="[object Int16Array]",ee="[object Int32Array]",Z="[object Uint8Array]",D="[object Uint8ClampedArray]",H="[object Uint16Array]",X="[object Uint32Array]",ce=/[\\^$.*+?()[\]{}|]/g,xe=/^\[object .+?Constructor\]$/,jt=/^(?:0|[1-9]\d*)$/,be={};be[$]=be[_]=be[w]=be[Y]=be[ee]=be[Z]=be[D]=be[H]=be[X]=!0,be[v]=be[E]=be[I]=be[O]=be[S]=be[N]=be[F]=be[V]=be[Q]=be[ae]=be[le]=be[me]=be[q]=be[G]=be[m]=!1;var It=typeof wi=="object"&&wi&&wi.Object===Object&&wi,z=typeof self=="object"&&self&&self.Object===Object&&self,M=It||z||Function("return this")(),T=i&&!i.nodeType&&i,u=T&&!0&&c&&!c.nodeType&&c,P=u&&u.exports===T,se=P&&It.process,_e=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Pe=_e&&_e.isTypedArray;function Le(g,C){for(var W=-1,re=g==null?0:g.length,Ge=0,Ee=[];++W<re;){var et=g[W];C(et,W,g)&&(Ee[Ge++]=et)}return Ee}function je(g,C){for(var W=-1,re=C.length,Ge=g.length;++W<re;)g[Ge+W]=C[W];return g}function Re(g,C){for(var W=-1,re=g==null?0:g.length;++W<re;)if(C(g[W],W,g))return!0;return!1}function xt(g,C){for(var W=-1,re=Array(g);++W<g;)re[W]=C(W);return re}function vt(g){return function(C){return g(C)}}function st(g,C){return g.has(C)}function qe(g,C){return g?.[C]}function Qe(g){var C=-1,W=Array(g.size);return g.forEach(function(re,Ge){W[++C]=[Ge,re]}),W}function Xe(g,C){return function(W){return g(C(W))}}function at(g){var C=-1,W=Array(g.size);return g.forEach(function(re){W[++C]=re}),W}var He=Array.prototype,Ze=Function.prototype,$e=Object.prototype,Ve=M["__core-js_shared__"],ut=Ze.toString,Ue=$e.hasOwnProperty,St=function(){var g=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Ft=$e.toString,kt=RegExp("^"+ut.call(Ue).replace(ce,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=P?M.Buffer:void 0,Mt=M.Symbol,Jt=M.Uint8Array,ir=$e.propertyIsEnumerable,jr=He.splice,Yt=Mt?Mt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,ai=Ht?Ht.isBuffer:void 0,xi=Xe(Object.keys,Object),ht=fr(M,"DataView"),rt=fr(M,"Map"),lt=fr(M,"Promise"),ft=fr(M,"Set"),ot=fr(M,"WeakMap"),it=fr(Object,"create"),Pt=Gr(ht),Ot=Gr(rt),pt=Gr(lt),Ct=Gr(ft),dt=Gr(ot),mt=Mt?Mt.prototype:void 0,gt=mt?mt.valueOf:void 0;function Ye(g){var C=-1,W=g==null?0:g.length;for(this.clear();++C<W;){var re=g[C];this.set(re[0],re[1])}}function At(){this.__data__=it?it(null):{},this.size=0}function Rt(g){var C=this.has(g)&&delete this.__data__[g];return this.size-=C?1:0,C}function ya(g){var C=this.__data__;if(it){var W=C[g];return W===s?void 0:W}return Ue.call(C,g)?C[g]:void 0}function va(g){var C=this.__data__;return it?C[g]!==void 0:Ue.call(C,g)}function ma(g,C){var W=this.__data__;return this.size+=this.has(g)?0:1,W[g]=it&&C===void 0?s:C,this}Ye.prototype.clear=At,Ye.prototype.delete=Rt,Ye.prototype.get=ya,Ye.prototype.has=va,Ye.prototype.set=ma;function _r(g){var C=-1,W=g==null?0:g.length;for(this.clear();++C<W;){var re=g[C];this.set(re[0],re[1])}}function _a(){this.__data__=[],this.size=0}function wa(g){var C=this.__data__,W=Si(C,g);if(W<0)return!1;var re=C.length-1;return W==re?C.pop():jr.call(C,W,1),--this.size,!0}function ba(g){var C=this.__data__,W=Si(C,g);return W<0?void 0:C[W][1]}function Ea(g){return Si(this.__data__,g)>-1}function Ia(g,C){var W=this.__data__,re=Si(W,g);return re<0?(++this.size,W.push([g,C])):W[re][1]=C,this}_r.prototype.clear=_a,_r.prototype.delete=wa,_r.prototype.get=ba,_r.prototype.has=Ea,_r.prototype.set=Ia;function Br(g){var C=-1,W=g==null?0:g.length;for(this.clear();++C<W;){var re=g[C];this.set(re[0],re[1])}}function Hi(){this.size=0,this.__data__={hash:new Ye,map:new(rt||_r),string:new Ye}}function xa(g){var C=oi(this,g).delete(g);return this.size-=C?1:0,C}function Ki(g){return oi(this,g).get(g)}function Sa(g){return oi(this,g).has(g)}function Pa(g,C){var W=oi(this,g),re=W.size;return W.set(g,C),this.size+=W.size==re?0:1,this}Br.prototype.clear=Hi,Br.prototype.delete=xa,Br.prototype.get=Ki,Br.prototype.has=Sa,Br.prototype.set=Pa;function Vi(g){var C=-1,W=g==null?0:g.length;for(this.__data__=new Br;++C<W;)this.add(g[C])}function Wn(g){return this.__data__.set(g,s),this}function Jn(g){return this.__data__.has(g)}Vi.prototype.add=Vi.prototype.push=Wn,Vi.prototype.has=Jn;function Rr(g){var C=this.__data__=new _r(g);this.size=C.size}function Oa(){this.__data__=new _r,this.size=0}function Ca(g){var C=this.__data__,W=C.delete(g);return this.size=C.size,W}function Aa(g){return this.__data__.get(g)}function Ra(g){return this.__data__.has(g)}function Yn(g,C){var W=this.__data__;if(W instanceof _r){var re=W.__data__;if(!rt||re.length<r-1)return re.push([g,C]),this.size=++W.size,this;W=this.__data__=new Br(re)}return W.set(g,C),this.size=W.size,this}Rr.prototype.clear=Oa,Rr.prototype.delete=Ca,Rr.prototype.get=Aa,Rr.prototype.has=Ra,Rr.prototype.set=Yn;function Qn(g,C){var W=Wi(g),re=!W&&us(g),Ge=!W&&!re&&vn(g),Ee=!W&&!re&&!Ge&&fs(g),et=W||re||Ge||Ee,Tt=et?xt(g.length,String):[],Ne=Tt.length;for(var We in g)(C||Ue.call(g,We))&&!(et&&(We=="length"||Ge&&(We=="offset"||We=="parent")||Ee&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||ns(We,Ne)))&&Tt.push(We);return Tt}function Si(g,C){for(var W=g.length;W--;)if(cs(g[W][0],C))return W;return-1}function gn(g,C,W){var re=C(g);return Wi(g)?re:je(re,W(g))}function Pi(g){return g==null?g===void 0?pe:he:Yt&&Yt in Object(g)?rs(g):Da(g)}function yn(g){return Ci(g)&&Pi(g)==v}function Oi(g,C,W,re,Ge){return g===C?!0:g==null||C==null||!Ci(g)&&!Ci(C)?g!==g&&C!==C:Xn(g,C,W,re,Oi,Ge)}function Xn(g,C,W,re,Ge,Ee){var et=Wi(g),Tt=Wi(C),Ne=et?E:Mr(g),We=Tt?E:Mr(C);Ne=Ne==v?le:Ne,We=We==v?le:We;var _t=Ne==le,nr=We==le,Nt=Ne==We;if(Nt&&vn(g)){if(!vn(C))return!1;et=!0,_t=!1}if(Nt&&!_t)return Ee||(Ee=new Rr),et||fs(g)?Bi(g,C,W,re,Ge,Ee):Na(g,C,Ne,W,re,Ge,Ee);if(!(W&a)){var tt=_t&&Ue.call(g,"__wrapped__"),Qt=nr&&Ue.call(C,"__wrapped__");if(tt||Qt){var Tr=tt?g.value():g,wr=Qt?C.value():C;return Ee||(Ee=new Rr),Ge(Tr,wr,W,re,Ee)}}return Nt?(Ee||(Ee=new Rr),ts(g,C,W,re,Ge,Ee)):!1}function Ta(g){if(!ls(g)||as(g))return!1;var C=Ji(g)?kt:xe;return C.test(Gr(g))}function Zn(g){return Ci(g)&&hs(g.length)&&!!be[Pi(g)]}function es(g){if(!os(g))return xi(g);var C=[];for(var W in Object(g))Ue.call(g,W)&&W!="constructor"&&C.push(W);return C}function Bi(g,C,W,re,Ge,Ee){var et=W&a,Tt=g.length,Ne=C.length;if(Tt!=Ne&&!(et&&Ne>Tt))return!1;var We=Ee.get(g);if(We&&Ee.get(C))return We==C;var _t=-1,nr=!0,Nt=W&l?new Vi:void 0;for(Ee.set(g,C),Ee.set(C,g);++_t<Tt;){var tt=g[_t],Qt=C[_t];if(re)var Tr=et?re(Qt,tt,_t,C,g,Ee):re(tt,Qt,_t,g,C,Ee);if(Tr!==void 0){if(Tr)continue;nr=!1;break}if(Nt){if(!Re(C,function(wr,qr){if(!st(Nt,qr)&&(tt===wr||Ge(tt,wr,W,re,Ee)))return Nt.push(qr)})){nr=!1;break}}else if(!(tt===Qt||Ge(tt,Qt,W,re,Ee))){nr=!1;break}}return Ee.delete(g),Ee.delete(C),nr}function Na(g,C,W,re,Ge,Ee,et){switch(W){case S:if(g.byteLength!=C.byteLength||g.byteOffset!=C.byteOffset)return!1;g=g.buffer,C=C.buffer;case I:return!(g.byteLength!=C.byteLength||!Ee(new Jt(g),new Jt(C)));case O:case N:case ae:return cs(+g,+C);case F:return g.name==C.name&&g.message==C.message;case me:case G:return g==C+"";case Q:var Tt=Qe;case q:var Ne=re&a;if(Tt||(Tt=at),g.size!=C.size&&!Ne)return!1;var We=et.get(g);if(We)return We==C;re|=l,et.set(g,C);var _t=Bi(Tt(g),Tt(C),re,Ge,Ee,et);return et.delete(g),_t;case U:if(gt)return gt.call(g)==gt.call(C)}return!1}function ts(g,C,W,re,Ge,Ee){var et=W&a,Tt=Gi(g),Ne=Tt.length,We=Gi(C),_t=We.length;if(Ne!=_t&&!et)return!1;for(var nr=Ne;nr--;){var Nt=Tt[nr];if(!(et?Nt in C:Ue.call(C,Nt)))return!1}var tt=Ee.get(g);if(tt&&Ee.get(C))return tt==C;var Qt=!0;Ee.set(g,C),Ee.set(C,g);for(var Tr=et;++nr<Ne;){Nt=Tt[nr];var wr=g[Nt],qr=C[Nt];if(re)var mn=et?re(qr,wr,Nt,C,g,Ee):re(wr,qr,Nt,g,C,Ee);if(!(mn===void 0?wr===qr||Ge(wr,qr,W,re,Ee):mn)){Qt=!1;break}Tr||(Tr=Nt=="constructor")}if(Qt&&!Tr){var Ai=g.constructor,qt=C.constructor;Ai!=qt&&"constructor"in g&&"constructor"in C&&!(typeof Ai=="function"&&Ai instanceof Ai&&typeof qt=="function"&&qt instanceof qt)&&(Qt=!1)}return Ee.delete(g),Ee.delete(C),Qt}function Gi(g){return gn(g,$a,is)}function oi(g,C){var W=g.__data__;return ss(C)?W[typeof C=="string"?"string":"hash"]:W.map}function fr(g,C){var W=qe(g,C);return Ta(W)?W:void 0}function rs(g){var C=Ue.call(g,Yt),W=g[Yt];try{g[Yt]=void 0;var re=!0}catch{}var Ge=Ft.call(g);return re&&(C?g[Yt]=W:delete g[Yt]),Ge}var is=Vr?function(g){return g==null?[]:(g=Object(g),Le(Vr(g),function(C){return ir.call(g,C)}))}:Be,Mr=Pi;(ht&&Mr(new ht(new ArrayBuffer(1)))!=S||rt&&Mr(new rt)!=Q||lt&&Mr(lt.resolve())!=fe||ft&&Mr(new ft)!=q||ot&&Mr(new ot)!=m)&&(Mr=function(g){var C=Pi(g),W=C==le?g.constructor:void 0,re=W?Gr(W):"";if(re)switch(re){case Pt:return S;case Ot:return Q;case pt:return fe;case Ct:return q;case dt:return m}return C});function ns(g,C){return C=C??d,!!C&&(typeof g=="number"||jt.test(g))&&g>-1&&g%1==0&&g<C}function ss(g){var C=typeof g;return C=="string"||C=="number"||C=="symbol"||C=="boolean"?g!=="__proto__":g===null}function as(g){return!!St&&St in g}function os(g){var C=g&&g.constructor,W=typeof C=="function"&&C.prototype||$e;return g===W}function Da(g){return Ft.call(g)}function Gr(g){if(g!=null){try{return ut.call(g)}catch{}try{return g+""}catch{}}return""}function cs(g,C){return g===C||g!==g&&C!==C}var us=yn(function(){return arguments}())?yn:function(g){return Ci(g)&&Ue.call(g,"callee")&&!ir.call(g,"callee")},Wi=Array.isArray;function Fa(g){return g!=null&&hs(g.length)&&!Ji(g)}var vn=ai||Ke;function La(g,C){return Oi(g,C)}function Ji(g){if(!ls(g))return!1;var C=Pi(g);return C==V||C==j||C==y||C==ve}function hs(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function ls(g){var C=typeof g;return g!=null&&(C=="object"||C=="function")}function Ci(g){return g!=null&&typeof g=="object"}var fs=Pe?vt(Pe):Zn;function $a(g){return Fa(g)?Qn(g):es(g)}function Be(){return[]}function Ke(){return!1}c.exports=La})(oc,oc.exports);const G1=oc.exports;function W1(c,i){if(c.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<c.length;a++){var l=c.charAt(a),d=l.charCodeAt(0);if(r[d]!==255)throw new TypeError(l+" is ambiguous");r[d]=a}var v=c.length,E=c.charAt(0),y=Math.log(v)/Math.log(256),O=Math.log(256)/Math.log(v);function N(j){if(j instanceof Uint8Array||(ArrayBuffer.isView(j)?j=new Uint8Array(j.buffer,j.byteOffset,j.byteLength):Array.isArray(j)&&(j=Uint8Array.from(j))),!(j instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(j.length===0)return"";for(var Q=0,ae=0,he=0,le=j.length;he!==le&&j[he]===0;)he++,Q++;for(var fe=(le-he)*O+1>>>0,ve=new Uint8Array(fe);he!==le;){for(var me=j[he],q=0,G=fe-1;(me!==0||q<ae)&&G!==-1;G--,q++)me+=256*ve[G]>>>0,ve[G]=me%v>>>0,me=me/v>>>0;if(me!==0)throw new Error("Non-zero carry");ae=q,he++}for(var U=fe-ae;U!==fe&&ve[U]===0;)U++;for(var pe=E.repeat(Q);U<fe;++U)pe+=c.charAt(ve[U]);return pe}function F(j){if(typeof j!="string")throw new TypeError("Expected String");if(j.length===0)return new Uint8Array;var Q=0;if(j[Q]!==" "){for(var ae=0,he=0;j[Q]===E;)ae++,Q++;for(var le=(j.length-Q)*y+1>>>0,fe=new Uint8Array(le);j[Q];){var ve=r[j.charCodeAt(Q)];if(ve===255)return;for(var me=0,q=le-1;(ve!==0||me<he)&&q!==-1;q--,me++)ve+=v*fe[q]>>>0,fe[q]=ve%256>>>0,ve=ve/256>>>0;if(ve!==0)throw new Error("Non-zero carry");he=me,Q++}if(j[Q]!==" "){for(var G=le-he;G!==le&&fe[G]===0;)G++;for(var U=new Uint8Array(ae+(le-G)),pe=ae;G!==le;)U[pe++]=fe[G++];return U}}}function V(j){var Q=F(j);if(Q)return Q;throw new Error(`Non-${i} character`)}return{encode:N,decodeUnsafe:F,decode:V}}var J1=W1,Y1=J1;const Kl=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},Q1=c=>new TextEncoder().encode(c),X1=c=>new TextDecoder().decode(c);class Z1{constructor(i,r,s){this.name=i,this.prefix=r,this.baseEncode=s}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class e_{constructor(i,r,s){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return Vl(this,i)}}class t_{constructor(i){this.decoders=i}or(i){return Vl(this,i)}decode(i){const r=i[0],s=this.decoders[r];if(s)return s.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Vl=(c,i)=>new t_({...c.decoders||{[c.prefix]:c},...i.decoders||{[i.prefix]:i}});class r_{constructor(i,r,s,a){this.name=i,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new Z1(i,r,s),this.decoder=new e_(i,r,a)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const da=({name:c,prefix:i,encode:r,decode:s})=>new r_(c,i,r,s),Gn=({prefix:c,name:i,alphabet:r})=>{const{encode:s,decode:a}=Y1(r,i);return da({prefix:c,name:i,encode:s,decode:l=>Kl(a(l))})},i_=(c,i,r,s)=>{const a={};for(let O=0;O<i.length;++O)a[i[O]]=O;let l=c.length;for(;c[l-1]==="=";)--l;const d=new Uint8Array(l*r/8|0);let v=0,E=0,y=0;for(let O=0;O<l;++O){const N=a[c[O]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);E=E<<r|N,v+=r,v>=8&&(v-=8,d[y++]=255&E>>v)}if(v>=r||255&E<<8-v)throw new SyntaxError("Unexpected end of data");return d},n_=(c,i,r)=>{const s=i[i.length-1]==="=",a=(1<<r)-1;let l="",d=0,v=0;for(let E=0;E<c.length;++E)for(v=v<<8|c[E],d+=8;d>r;)d-=r,l+=i[a&v>>d];if(d&&(l+=i[a&v<<r-d]),s)for(;l.length*r&7;)l+="=";return l},Vt=({name:c,prefix:i,bitsPerChar:r,alphabet:s})=>da({prefix:i,name:c,encode(a){return n_(a,s,r)},decode(a){return i_(a,s,r,c)}}),s_=da({prefix:"\0",name:"identity",encode:c=>X1(c),decode:c=>Q1(c)});var a_=Object.freeze({__proto__:null,identity:s_});const o_=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var c_=Object.freeze({__proto__:null,base2:o_});const u_=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var h_=Object.freeze({__proto__:null,base8:u_});const l_=Gn({prefix:"9",name:"base10",alphabet:"0123456789"});var f_=Object.freeze({__proto__:null,base10:l_});const p_=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),d_=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var g_=Object.freeze({__proto__:null,base16:p_,base16upper:d_});const y_=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),v_=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),m_=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),__=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),w_=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),b_=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),E_=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),I_=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),x_=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var S_=Object.freeze({__proto__:null,base32:y_,base32upper:v_,base32pad:m_,base32padupper:__,base32hex:w_,base32hexupper:b_,base32hexpad:E_,base32hexpadupper:I_,base32z:x_});const P_=Gn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),O_=Gn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var C_=Object.freeze({__proto__:null,base36:P_,base36upper:O_});const A_=Gn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),R_=Gn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var T_=Object.freeze({__proto__:null,base58btc:A_,base58flickr:R_});const N_=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),D_=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),F_=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),L_=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $_=Object.freeze({__proto__:null,base64:N_,base64pad:D_,base64url:F_,base64urlpad:L_});const Bl=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),j_=Bl.reduce((c,i,r)=>(c[r]=i,c),[]),M_=Bl.reduce((c,i,r)=>(c[i.codePointAt(0)]=r,c),[]);function q_(c){return c.reduce((i,r)=>(i+=j_[r],i),"")}function z_(c){const i=[];for(const r of c){const s=M_[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(s)}return new Uint8Array(i)}const U_=da({prefix:"\u{1F680}",name:"base256emoji",encode:q_,decode:z_});var k_=Object.freeze({__proto__:null,base256emoji:U_}),H_=Gl,Wh=128,K_=127,V_=~K_,B_=Math.pow(2,31);function Gl(c,i,r){i=i||[],r=r||0;for(var s=r;c>=B_;)i[r++]=c&255|Wh,c/=128;for(;c&V_;)i[r++]=c&255|Wh,c>>>=7;return i[r]=c|0,Gl.bytes=r-s+1,i}var G_=cc,W_=128,Jh=127;function cc(c,s){var r=0,s=s||0,a=0,l=s,d,v=c.length;do{if(l>=v)throw cc.bytes=0,new RangeError("Could not decode varint");d=c[l++],r+=a<28?(d&Jh)<<a:(d&Jh)*Math.pow(2,a),a+=7}while(d>=W_);return cc.bytes=l-s,r}var J_=Math.pow(2,7),Y_=Math.pow(2,14),Q_=Math.pow(2,21),X_=Math.pow(2,28),Z_=Math.pow(2,35),ew=Math.pow(2,42),tw=Math.pow(2,49),rw=Math.pow(2,56),iw=Math.pow(2,63),nw=function(c){return c<J_?1:c<Y_?2:c<Q_?3:c<X_?4:c<Z_?5:c<ew?6:c<tw?7:c<rw?8:c<iw?9:10},sw={encode:H_,decode:G_,encodingLength:nw},Wl=sw;const Yh=(c,i,r=0)=>(Wl.encode(c,i,r),i),Qh=c=>Wl.encodingLength(c),uc=(c,i)=>{const r=i.byteLength,s=Qh(c),a=s+Qh(r),l=new Uint8Array(a+r);return Yh(c,l,0),Yh(r,l,s),l.set(i,a),new aw(c,r,i,l)};class aw{constructor(i,r,s,a){this.code=i,this.size=r,this.digest=s,this.bytes=a}}const Jl=({name:c,code:i,encode:r})=>new ow(c,i,r);class ow{constructor(i,r,s){this.name=i,this.code=r,this.encode=s}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?uc(this.code,r):r.then(s=>uc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Yl=c=>async i=>new Uint8Array(await crypto.subtle.digest(c,i)),cw=Jl({name:"sha2-256",code:18,encode:Yl("SHA-256")}),uw=Jl({name:"sha2-512",code:19,encode:Yl("SHA-512")});var hw=Object.freeze({__proto__:null,sha256:cw,sha512:uw});const Ql=0,lw="identity",Xl=Kl,fw=c=>uc(Ql,Xl(c)),pw={code:Ql,name:lw,encode:Xl,digest:fw};var dw=Object.freeze({__proto__:null,identity:pw});new TextEncoder,new TextDecoder;const Xh={...a_,...c_,...h_,...f_,...g_,...S_,...C_,...T_,...$_,...k_};({...hw,...dw});function Zl(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function gw(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zl(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function ef(c,i,r,s){return{name:c,prefix:i,encoder:{name:c,prefix:i,encode:r},decoder:{decode:s}}}const Zh=ef("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),Jo=ef("ascii","a",c=>{let i="a";for(let r=0;r<c.length;r++)i+=String.fromCharCode(c[r]);return i},c=>{c=c.substring(1);const i=gw(c.length);for(let r=0;r<c.length;r++)i[r]=c.charCodeAt(r);return i}),yw={utf8:Zh,"utf-8":Zh,hex:Xh.base16,latin1:Jo,ascii:Jo,binary:Jo,...Xh};function vw(c,i="utf8"){const r=yw[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zl(globalThis.Buffer.from(c,"utf-8")):r.decoder.decode(`${r.prefix}${c}`)}const tf="wc",mw=2,wc="core",bi=`${tf}@2:${wc}:`,_w={name:wc,logger:"error"},ww={database:":memory:"},bw="crypto",el="client_ed25519_seed",Ew=ue.ONE_DAY,Iw="keychain",xw="0.3",Sw="messages",Pw="0.3",Ow=ue.SIX_HOURS,Cw="publisher",rf="irn",Aw="error",nf="wss://relay.walletconnect.com",tl="wss://relay.walletconnect.org",Rw="relayer",Wt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Tw="_subscription",ii={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Nw=ue.ONE_SECOND,Dw="2.10.0",Fw=1e4,Lw="0.3",$w="WALLETCONNECT_CLIENT_ID",Kr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},jw="subscription",Mw="0.3",qw=ue.FIVE_SECONDS*1e3,zw="pairing",Uw="0.3",$n={wc_pairingDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:0},res:{ttl:ue.ONE_DAY,prompt:!1,tag:0}}},Hr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},kw="history",Hw="0.3",Kw="expirer",Cr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Vw="0.3",Yo="verify-api",ca="https://verify.walletconnect.com",rl="https://verify.walletconnect.org";class Bw{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=Iw,this.version=xw,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:l}=ne("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=i,this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,Tl(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Nl(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Gw{constructor(i,r,s){this.core=i,this.logger=r,this.name=bw,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=Vh(a);return Hl(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=G0();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),d=Vh(l),v=nc();return await k1(v,a,Ew,d)},this.generateSharedKey=(a,l,d)=>{this.isInitialized();const v=this.getPrivateKey(a),E=W0(v,l);return this.setSymKey(E,d)},this.setSymKey=async(a,l)=>{this.isInitialized();const d=l||J0(a);return await this.keychain.set(d,a),d},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,d)=>{this.isInitialized();const v=Y0(d),E=Kn(l);if(Sh(v)){const F=v.senderPublicKey,V=v.receiverPublicKey;a=await this.generateSharedKey(F,V)}const y=this.getSymKey(a),{type:O,senderPublicKey:N}=v;return Q0({type:O,symKey:y,message:E,senderPublicKey:N})},this.decode=async(a,l,d)=>{this.isInitialized();const v=X0(l,d);if(Sh(v)){const E=v.receiverPublicKey,y=v.senderPublicKey;a=await this.generateSharedKey(E,y)}try{const E=this.getSymKey(a),y=Z0({symKey:E,encoded:l});return pa(y)}catch(E){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(E)}},this.getPayloadType=a=>{const l=Ph(a);return em(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Ph(a);return l.senderPublicKey?fa(l.senderPublicKey,tm):void 0},this.core=i,this.logger=Fe.generateChildLogger(r,this.name),this.keychain=s||new Bw(this.core,this.logger)}get context(){return Fe.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(el)}catch{i=nc(),await this.keychain.set(el,i)}return vw(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Ww extends w1{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=Sw,this.version=Pw,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const l=fn(a);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[l]<"u"||(d[l]=a,this.messages.set(s,d),await this.persist()),l},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const l=this.get(s),d=fn(a);return typeof l[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Fe.generateChildLogger(i,this.name),this.core=r}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,Tl(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Nl(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Jw extends b1{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new mr.exports.EventEmitter,this.name=Cw,this.queue=new Map,this.publishTimeout=ue.toMiliseconds(ue.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,l)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}});try{const v=l?.ttl||Ow,E=sc(l),y=l?.prompt||!1,O=l?.tag||0,N=l?.id||Nm().toString(),F={topic:s,message:a,opts:{ttl:v,relay:E,prompt:y,tag:O,id:N}},V=setTimeout(()=>this.queue.set(N,F),this.publishTimeout);try{await await Hn(this.rpcPublish(s,a,v,E,y,O,N),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(N),this.relayer.events.emit(Wt.publish,F)}catch(j){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=l?.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(N),j;return}finally{clearTimeout(V)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}})}catch(v){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(v),v}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=i,this.logger=Fe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Fe.getLoggerContext(this.logger)}rpcPublish(i,r,s,a,l,d,v){var E,y,O,N;const F={method:na(a.protocol).publish,params:{topic:i,message:r,ttl:s,prompt:l,tag:d},id:v};return _i((E=F.params)==null?void 0:E.prompt)&&((y=F.params)==null||delete y.prompt),_i((O=F.params)==null?void 0:O.tag)&&((N=F.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:F}),this.relayer.request(F)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:s,opts:a}=i;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Wt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Wt.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}}class Yw{constructor(){this.map=new Map,this.set=(i,r)=>{const s=this.get(i);this.exists(i,r)||this.map.set(i,[...s,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const s=this.get(i);if(!this.exists(i,r))return;const a=s.filter(l=>l!==r);if(!a.length){this.map.delete(i);return}this.map.set(i,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Qw=Object.defineProperty,Xw=Object.defineProperties,Zw=Object.getOwnPropertyDescriptors,il=Object.getOwnPropertySymbols,eb=Object.prototype.hasOwnProperty,tb=Object.prototype.propertyIsEnumerable,nl=(c,i,r)=>i in c?Qw(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,jn=(c,i)=>{for(var r in i||(i={}))eb.call(i,r)&&nl(c,r,i[r]);if(il)for(var r of il(i))tb.call(i,r)&&nl(c,r,i[r]);return c},Qo=(c,i)=>Xw(c,Zw(i));class rb extends x1{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new Yw,this.events=new mr.exports.EventEmitter,this.name=jw,this.version=Mw,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=bi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const l=sc(a),d={topic:s,relay:l};this.pending.set(s,d);const v=await this.rpcSubscribe(s,l);return this.onSubscribe(v,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),v}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof a?.id<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,l)=>{const d=new ue.Watch;d.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),a(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=qw&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Fe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let s=!1;try{s=this.getSubscription(i).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const s=this.topicMap.get(i);await Promise.all(s.map(async a=>await this.unsubscribeById(i,a,r)))}async unsubscribeById(i,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:s}});try{const a=sc(s);await this.rpcUnsubscribe(i,r,a);const l=rr("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(i,r){const s={method:na(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Hn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}return fn(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,s={method:na(r.protocol).batchSubscribe,params:{topics:i.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Hn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}}rpcUnsubscribe(i,r,s){const a={method:na(s.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(i,r){this.setSubscription(i,Qo(jn({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,jn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,s),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,jn({},r)),this.topicMap.set(r.topic,i),this.events.emit(Kr.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:s}=ne("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const s=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(s.topic,i),this.events.emit(Kr.deleted,Qo(jn({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Kr.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Kr.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);pn(r)&&this.onBatchSubscribe(r.map((s,a)=>Qo(jn({},i[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Wt.connect,async()=>{await this.onConnect()}),this.relayer.on(Wt.disconnect,()=>{this.onDisconnect()}),this.events.on(Kr.created,async i=>{const r=Kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(Kr.deleted,async i=>{const r=Kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var ib=Object.defineProperty,sl=Object.getOwnPropertySymbols,nb=Object.prototype.hasOwnProperty,sb=Object.prototype.propertyIsEnumerable,al=(c,i,r)=>i in c?ib(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ab=(c,i)=>{for(var r in i||(i={}))nb.call(i,r)&&al(c,r,i[r]);if(sl)for(var r of sl(i))sb.call(i,r)&&al(c,r,i[r]);return c};class ob extends E1{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new mr.exports.EventEmitter,this.name=Rw,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Wt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Wt.error,r)},this.registerProviderListeners=()=>{this.provider.on(ii.payload,this.onPayloadHandler),this.provider.on(ii.connect,this.onConnectHandler),this.provider.on(ii.disconnect,this.onDisconnectHandler),this.provider.on(ii.error,this.onProviderErrorHandler)},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Fe.generateChildLogger(i.logger,this.name):Fe.pino(Fe.getDefaultLoggerOptions({level:i.logger||Aw})),this.messages=new Ww(this.logger,i.core),this.subscriber=new rb(this,this.logger),this.publisher=new Jw(this,this.logger),this.relayUrl=i?.relayUrl||nf,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${tl}...`),await this.restartTransport(tl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Fw)}get context(){return Fe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,s){this.isInitialized(),await this.publisher.publish(i,r,s),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(i))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(l=>{this.subscriber.once(Kr.created,d=>{d.topic===i&&l()})}),new Promise(async l=>{a=await this.subscriber.subscribe(i,r),l()})]),a)}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Hn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Kr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await Hn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(ii.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Oh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ei(new B1(rm({sdkVersion:Dw,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:s}=i;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(i){const{topic:r,message:s}=i;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),yc(i)){if(!i.method.endsWith(Tw))return;const r=i.params,{topic:s,message:a,publishedAt:l}=r.data,d={topic:s,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(ab({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(i),await this.onMessageEvent(d)}else vc(i)&&this.events.emit(Wt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(Wt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=mc(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ii.payload,this.onPayloadHandler),this.provider.off(ii.connect,this.onConnectHandler),this.provider.off(ii.disconnect,this.onDisconnectHandler),this.provider.off(ii.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Wt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let i=await Oh();im(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Wt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},ue.toMiliseconds(Nw)))}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var cb=Object.defineProperty,ol=Object.getOwnPropertySymbols,ub=Object.prototype.hasOwnProperty,hb=Object.prototype.propertyIsEnumerable,cl=(c,i,r)=>i in c?cb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ul=(c,i)=>{for(var r in i||(i={}))ub.call(i,r)&&cl(c,r,i[r]);if(ol)for(var r of ol(i))hb.call(i,r)&&cl(c,r,i[r]);return c};class ga extends I1{constructor(i,r,s,a=bi,l=void 0){super(i,r,s,a),this.core=i,this.logger=r,this.name=s,this.map=new Map,this.version=Lw,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):V0(d)?this.map.set(d.id,d):B0(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,v)=>{this.isInitialized(),this.map.has(d)?await this.update(d,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:v}),this.map.set(d,v),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(v=>Object.keys(d).every(E=>G1(v[E],d[E]))):this.values),this.update=async(d,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:v});const E=ul(ul({},this.getData(d)),v);this.map.set(d,E),await this.persist()},this.delete=async(d,v)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:v}),this.map.delete(d),await this.persist())},this.logger=Fe.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:s}=ne("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}}class lb{constructor(i,r){this.core=i,this.logger=r,this.name=zw,this.version=Uw,this.events=new mr.exports,this.initialized=!1,this.storagePrefix=bi,this.ignoredPayloadTypes=[Cl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=nc(),a=await this.core.crypto.setSymKey(s),l=$r(ue.FIVE_MINUTES),d={protocol:rf},v={topic:a,expiry:l,relay:d,active:!1},E=nm({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:d});return await this.pairings.set(a,v),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:E}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:l,relay:d}=sm(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const v=$r(ue.FIVE_MINUTES),E={topic:a,relay:d,expiry:v,active:!1};return await this.pairings.set(a,E),await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:d}),this.core.expirer.set(a,v),s.activatePairing&&await this.activate({topic:a}),E},this.activate=async({topic:s})=>{this.isInitialized();const a=$r(ue.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:d,resolve:v,reject:E}=hn();this.events.once(Dt("pairing_ping",l),({error:y})=>{y?E(y):v()}),await d()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",rr("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,l)=>{const d=ua(a,l),v=await this.core.crypto.encode(s,d),E=$n[a].req;return this.core.history.set(s,d),this.core.relayer.publish(s,v,E),d.id},this.sendResult=async(s,a,l)=>{const d=mc(s,l),v=await this.core.crypto.encode(a,d),E=await this.core.history.get(a,s),y=$n[E.request.method].res;await this.core.relayer.publish(a,v,y),await this.core.history.resolve(d)},this.sendError=async(s,a,l)=>{const d=gc(s,l),v=await this.core.crypto.encode(a,d),E=await this.core.history.get(a,s),y=$n[E.request.method]?$n[E.request.method].res:$n.unregistered_method.res;await this.core.relayer.publish(a,v,y),await this.core.history.resolve(d)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,rr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>mi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:l}=s;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:l}=s,d=(await this.core.history.get(a,l.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,a)=>{const{id:l}=a;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit("pairing_ping",{id:l,topic:s})}catch(d){await this.sendError(l,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,a)=>{const{id:l}=a;setTimeout(()=>{vi(a)?this.events.emit(Dt("pairing_ping",l),{}):si(a)&&this.events.emit(Dt("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:l,topic:s})}catch(d){await this.sendError(l,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:l,method:d}=a;try{if(this.registeredMethods.includes(d))return;const v=rr("WC_METHOD_UNSUPPORTED",d);await this.sendError(l,s,v),this.logger.error(v)}catch(v){await this.sendError(l,s,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(rr("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!lr(s)){const{message:a}=ne("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!am(s.uri)){const{message:a}=ne("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!lr(s)){const{message:l}=ne("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!lr(s)){const{message:l}=ne("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!ln(s,!1)){const{message:a}=ne("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ne("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(mi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ne("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=i,this.logger=Fe.generateChildLogger(r,this.name),this.pairings=new ga(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Fe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(Wt.message,async i=>{const{topic:r,message:s}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{yc(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):vc(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(Cr.expired,async i=>{const{topic:r}=Al(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class fb extends _1{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new mr.exports.EventEmitter,this.name=kw,this.version=Hw,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:l}),this.records.has(a.id))return;const d={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:l,expiry:$r(ue.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Hr.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=si(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Hr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===s){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(Hr.deleted,l)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:ua(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(s)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:s}=ne("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Hr.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(Hr.created,i=>{const r=Hr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.updated,i=>{const r=Hr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.deleted,i=>{const r=Hr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{ue.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}}class pb extends S1{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new mr.exports.EventEmitter,this.name=Kw,this.version=Vw,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const l=this.formatTarget(s),d={target:l,expiry:a};this.expirations.set(l,d),this.checkExpiry(l,d),this.events.emit(Cr.created,{target:l,expiration:d})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Cr.deleted,{target:a,expiration:l})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return om(i);if(typeof i=="number")return cm(i);const{message:r}=ne("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Cr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:s}=ne("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(i,r){const{expiry:s}=r;ue.toMiliseconds(s)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Cr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(dn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Cr.created,i=>{const r=Cr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Cr.expired,i=>{const r=Cr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Cr.deleted,i=>{const r=Cr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}}}class db extends P1{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=Yo,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||um()||!Rl())return;const a=s?.verifyUrl||ca;this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(l){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(l)}if(!this.initialized){this.removeIframe(),this.verifyUrl=rl;try{await this.createIframe()}catch(l){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(l),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=s?.verifyUrl||ca;let l="";try{l=await this.fetchAttestation(s.attestationId,a)}catch(d){this.logger.warn(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.warn(d),l=await this.fetchAttestation(s.attestationId,rl)}return l},this.fetchAttestation=async(s,a)=>{var l;this.logger.info(`resolving attestation: ${s} from url: ${a}`);const d=this.startAbortTimer(ue.ONE_SECOND*2),v=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(d),v.status===200?(l=await v.json())==null?void 0:l.origin:""},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(l=>{if(document.getElementById(Yo))return l();window.addEventListener("message",a);const d=document.createElement("iframe");d.id=Yo,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=l}),new Promise((l,d)=>setTimeout(()=>{window.removeEventListener("message",a),d("verify iframe load timeout")},ue.toMiliseconds(ue.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Fe.generateChildLogger(r,this.name),this.verifyUrl=ca,this.abortController=new AbortController,this.isDevEnv=hm()&&{NVM_INC:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/include/node",MANPATH:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/share/man:/opt/homebrew/share/man:/usr/share/man:/usr/local/share/man:/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/share/man:/opt/homebrew/share/man::",TERM_PROGRAM:"vscode",NODE:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/bin/node",INIT_CWD:"/Users/fatihaamitchi/Documents/Dev/zkCV",NVM_CD_FLAGS:"-q",TERM:"xterm-256color",SHELL:"/bin/zsh",npm_config_metrics_registry:"https://registry.npmjs.org/",HOMEBREW_REPOSITORY:"/opt/homebrew",TMPDIR:"/var/folders/_m/ls6gl7s97mb4njlxz3hh2zr80000gn/T/",npm_config_global_prefix:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2",TERM_PROGRAM_VERSION:"1.86.2",ZDOTDIR:"/Users/fatihaamitchi",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/fatihaamitchi/Documents/Dev/zkCV",ZSH:"/Users/fatihaamitchi/.oh-my-zsh",NVM_DIR:"/Users/fatihaamitchi/.nvm",USER:"fatihaamitchi",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.tf1oIHGLZl/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0:2",npm_execpath:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/lib/node_modules/npm/bin/npm-cli.js",PAGER:"less",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/fatihaamitchi/Documents/Dev/zkCV/node_modules/.bin:/Users/fatihaamitchi/Documents/Dev/node_modules/.bin:/Users/fatihaamitchi/Documents/node_modules/.bin:/Users/fatihaamitchi/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/bin:/opt/homebrew/bin:/opt/homebrew/sbin",npm_package_json:"/Users/fatihaamitchi/Documents/Dev/zkCV/package.json",_:"/Users/fatihaamitchi/Documents/Dev/zkCV/node_modules/.bin/vite",npm_config_userconfig:"/Users/fatihaamitchi/.npmrc",npm_config_init_module:"/Users/fatihaamitchi/.npm-init.js",USER_ZDOTDIR:"/Users/fatihaamitchi",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/fatihaamitchi/Documents/Dev/zkCV",npm_lifecycle_event:"build",EDITOR:"vi",npm_package_name:"particle-rainbowkit-boilerplate",LANG:"en_US.UTF-8",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_config_node_gyp:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",SHLVL:"2",HOME:"/Users/fatihaamitchi",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",HOMEBREW_PREFIX:"/opt/homebrew",npm_config_cache:"/Users/fatihaamitchi/.npm",LESS:"-R",LOGNAME:"fatihaamitchi",npm_lifecycle_script:"vite build",VSCODE_GIT_IPC_HANDLE:"/var/folders/_m/ls6gl7s97mb4njlxz3hh2zr80000gn/T/vscode-git-dda2d9ab2f.sock",NVM_BIN:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/bin",npm_config_user_agent:"npm/8.5.0 node/v16.14.2 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper (Plugin).app/Contents/MacOS/Code Helper (Plugin)",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",npm_node_execpath:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2/bin/node",npm_config_prefix:"/Users/fatihaamitchi/.nvm/versions/node/v16.14.2",COLORTERM:"truecolor",NODE_ENV:"production"}.IS_VITEST}get context(){return Fe.getLoggerContext(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ue.toMiliseconds(i))}}var gb=Object.defineProperty,hl=Object.getOwnPropertySymbols,yb=Object.prototype.hasOwnProperty,vb=Object.prototype.propertyIsEnumerable,ll=(c,i,r)=>i in c?gb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,fl=(c,i)=>{for(var r in i||(i={}))yb.call(i,r)&&ll(c,r,i[r]);if(hl)for(var r of hl(i))vb.call(i,r)&&ll(c,r,i[r]);return c};class bc extends m1{constructor(i){super(i),this.protocol=tf,this.version=mw,this.name=wc,this.events=new mr.exports.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=i?.projectId,this.relayUrl=i?.relayUrl||nf;const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Fe.pino(Fe.getDefaultLoggerOptions({level:i?.logger||_w.logger}));this.logger=Fe.generateChildLogger(r,this.name),this.heartbeat=new dn.HeartBeat,this.crypto=new Gw(this,this.logger,i?.keychain),this.history=new fb(this,this.logger),this.expirer=new pb(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new u1(fl(fl({},ww),i?.storageOptions)),this.relayer=new ob({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new lb(this,this.logger),this.verify=new db(this.projectId||"",this.logger)}static async init(i){const r=new bc(i);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem($w,s),r}get context(){return Fe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const mb=bc,sf="wc",af=2,of="client",Ec=`${sf}@${af}:${of}:`,Xo={name:of,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},pl="WALLETCONNECT_DEEPLINK_CHOICE",_b="proposal",cf="Proposal expired",wb="session",ta=ue.SEVEN_DAYS,bb="engine",Mn={wc_sessionPropose:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1115}}},Zo={min:ue.FIVE_MINUTES,max:ue.SEVEN_DAYS},ni={idle:"IDLE",active:"ACTIVE"},Eb="request",Ib=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var xb=Object.defineProperty,Sb=Object.defineProperties,Pb=Object.getOwnPropertyDescriptors,dl=Object.getOwnPropertySymbols,Ob=Object.prototype.hasOwnProperty,Cb=Object.prototype.propertyIsEnumerable,gl=(c,i,r)=>i in c?xb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ur=(c,i)=>{for(var r in i||(i={}))Ob.call(i,r)&&gl(c,r,i[r]);if(dl)for(var r of dl(i))Cb.call(i,r)&&gl(c,r,i[r]);return c},qn=(c,i)=>Sb(c,Pb(i));class Ab extends C1{constructor(i){super(i),this.name=bb,this.events=new mr.exports,this.initialized=!1,this.ignoredPayloadTypes=[Cl],this.requestQueue={state:ni.idle,queue:[]},this.sessionRequestQueue={state:ni.idle,queue:[]},this.requestQueueDelay=ue.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Mn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ue.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=qn(ur({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:d,sessionProperties:v,relays:E}=s;let y=a,O,N=!1;if(y&&(N=this.client.core.pairing.pairings.get(y).active),!y||!N){const{topic:fe,uri:ve}=await this.client.core.pairing.create();y=fe,O=ve}const F=await this.client.core.crypto.generateKeyPair(),V=ur({requiredNamespaces:l,optionalNamespaces:d,relays:E??[{protocol:rf}],proposer:{publicKey:F,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:j,resolve:Q,done:ae}=hn(ue.FIVE_MINUTES,cf);if(this.events.once(Dt("session_connect"),async({error:fe,session:ve})=>{if(fe)j(fe);else if(ve){ve.self.publicKey=F;const me=qn(ur({},ve),{requiredNamespaces:ve.requiredNamespaces,optionalNamespaces:ve.optionalNamespaces});await this.client.session.set(ve.topic,me),await this.setExpiry(ve.topic,ve.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:ve.peer.metadata}),Q(me)}}),!y){const{message:fe}=ne("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(fe)}const he=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:V}),le=$r(ue.FIVE_MINUTES);return await this.setProposal(he,ur({id:he,expiry:le},V)),{uri:O,approval:ae}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:l,sessionProperties:d}=r,v=this.client.proposal.get(s);let{pairingTopic:E,proposer:y,requiredNamespaces:O,optionalNamespaces:N}=v;E=E||"",sa(O)||(O=lm(l,"approve()"));const F=await this.client.core.crypto.generateKeyPair(),V=y.publicKey,j=await this.client.core.crypto.generateSharedKey(F,V);E&&s&&(await this.client.core.pairing.updateMetadata({topic:E,metadata:y.metadata}),await this.sendResult({id:s,topic:E,result:{relay:{protocol:a??"irn"},responderPublicKey:F}}),await this.client.proposal.delete(s,rr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:E}));const Q=ur({relay:{protocol:a??"irn"},namespaces:l,requiredNamespaces:O,optionalNamespaces:N,pairingTopic:E,controller:{publicKey:F,metadata:this.client.metadata},expiry:$r(ta)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(j),await this.sendRequest({topic:j,method:"wc_sessionSettle",params:Q,throwOnFailedPublish:!0});const ae=qn(ur({},Q),{topic:j,pairingTopic:E,acknowledged:!1,self:Q.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:F});return await this.client.session.set(j,ae),await this.setExpiry(j,$r(ta)),{topic:j,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(j)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,a),await this.client.proposal.delete(s,rr("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,l=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:d,resolve:v,reject:E}=hn();return this.events.once(Dt("session_update",l),({error:y})=>{y?E(y):v()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:l,resolve:d,reject:v}=hn();return this.events.once(Dt("session_extend",a),({error:E})=>{E?v(E):d()}),await this.setExpiry(s,$r(ta)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:l,expiry:d}=r,v=Dm(),{done:E,resolve:y,reject:O}=hn(d);return this.events.once(Dt("session_request",v),({error:N,result:F})=>{N?O(N):y(F)}),await Promise.all([new Promise(async N=>{await this.sendRequest({clientRpcId:v,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:d,throwOnFailedPublish:!0}).catch(F=>O(F)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:s,id:v}),N()}),new Promise(async N=>{const F=await this.client.core.storage.getItem(pl);fm({id:v,topic:l,wcDeepLink:F}),N()}),E()]).then(N=>N[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:l}=a;vi(a)?await this.sendResult({id:l,topic:s,result:a.result,throwOnFailedPublish:!0}):si(a)&&await this.sendError(l,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:l,resolve:d,reject:v}=hn();this.events.once(Dt("session_ping",a),({error:E})=>{E?v(E):d()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:l}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:rr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>pm(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var d,v;return((d=l.peerMetadata)==null?void 0:d.url)&&((v=l.peerMetadata)==null?void 0:v.url)===r.peer.metadata.url&&l.topic&&l.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,rr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(pl).catch(l=>this.client.logger.warn(l))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,rr("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=ni.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Mn.wc_sessionRequest.req.ttl,{id:a,topic:l,params:d}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:d}),s&&this.client.core.expirer.set(a,$r(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:l,expiry:d,relayRpcId:v,clientRpcId:E,throwOnFailedPublish:y}=r,O=ua(a,l,E);if(Rl()&&Ib.includes(a)){const V=fn(JSON.stringify(O));this.client.core.verify.register({attestationId:V})}const N=await this.client.core.crypto.encode(s,O),F=Mn[a].req;return d&&(F.ttl=d),v&&(F.id=v),this.client.core.history.set(s,O),y?(F.internal=qn(ur({},F.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,N,F)):this.client.core.relayer.publish(s,N,F).catch(V=>this.client.logger.error(V)),O.id},this.sendResult=async r=>{const{id:s,topic:a,result:l,throwOnFailedPublish:d}=r,v=mc(s,l),E=await this.client.core.crypto.encode(a,v),y=await this.client.core.history.get(a,s),O=Mn[y.request.method].res;d?(O.internal=qn(ur({},O.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,E,O)):this.client.core.relayer.publish(a,E,O).catch(N=>this.client.logger.error(N)),await this.client.core.history.resolve(v)},this.sendError=async(r,s,a)=>{const l=gc(r,a),d=await this.client.core.crypto.encode(s,l),v=await this.client.core.history.get(s,r),E=Mn[v.request.method].res;this.client.core.relayer.publish(s,d,E),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{mi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{mi(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ni.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ni.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=ni.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,l=(await this.client.core.history.get(s,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=ne("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidConnect(ur({},s.params));const d=$r(ue.FIVE_MINUTES),v=ur({id:l,pairingTopic:r,expiry:d},a);await this.setProposal(l,v);const E=fn(JSON.stringify(s)),y=await this.getVerifyContext(E,v.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:v,verifyContext:y})}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(vi(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const d=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const v=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const E=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:E});const y=await this.client.core.crypto.generateSharedKey(v,E);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const O=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:O}),await this.client.core.pairing.activate({topic:r})}else si(s)&&(await this.client.proposal.delete(a,rr("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:d,controller:v,expiry:E,namespaces:y,requiredNamespaces:O,optionalNamespaces:N,sessionProperties:F,pairingTopic:V}=s.params,j=ur({topic:r,relay:d,expiry:E,namespaces:y,acknowledged:!0,pairingTopic:V,requiredNamespaces:O,optionalNamespaces:N,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},F&&{sessionProperties:F});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Dt("session_connect"),{session:j}),this.cleanupDuplicatePairings(j)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;vi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Dt("session_approve",a),{})):si(s)&&(await this.client.session.delete(r,rr("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:l}=s;try{const d=`${r}_session_update`,v=Xs.get(d);if(v&&this.isRequestOutOfSync(v,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(ur({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),Xs.set(d,l)}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;vi(s)?this.events.emit(Dt("session_update",a),{}):si(s)&&this.events.emit(Dt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,$r(ta)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;vi(s)?this.events.emit(Dt("session_extend",a),{}):si(s)&&this.events.emit(Dt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{vi(s)?this.events.emit(Dt("session_ping",a),{}):si(s)&&this.events.emit(Dt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Wt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidRequest(ur({topic:r},l)),await this.setPendingSessionRequest({id:a,topic:r,params:l}),this.addSessionRequestToSessionRequestQueue({id:a,topic:r,params:l}),await this.processSessionRequestQueue()}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;vi(s)?this.events.emit(Dt("session_request",a),{result:s.result}):si(s)&&this.events.emit(Dt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:l}=s;try{const d=`${r}_session_event_${l.event.name}`,v=Xs.get(d);if(v&&this.isRequestOutOfSync(v,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(ur({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),Xs.set(d,a)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ni.idle,this.processSessionRequestQueue()},ue.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===ni.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{const{id:s,topic:a,params:l}=r,d=fn(JSON.stringify(ua("wc_sessionRequest",l,s))),v=this.client.session.get(a),E=await this.getVerifyContext(d,v.peer.metadata);this.sessionRequestQueue.state=ni.active,this.client.events.emit("session_request",{id:s,topic:a,params:l,verifyContext:E})}catch(s){this.client.logger.error(s)}},this.isValidConnect=async r=>{if(!lr(r)){const{message:E}=ne("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(E)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:d,relays:v}=r;if(_i(s)||await this.isValidPairingTopic(s),!dm(v,!0)){const{message:E}=ne("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(E)}!_i(a)&&sa(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!_i(l)&&sa(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=gm(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!lr(r))throw new Error(ne("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:l,sessionProperties:d}=r;await this.isValidProposalId(s);const v=this.client.proposal.get(s),E=Uo(a,"approve()");if(E)throw new Error(E.message);const y=Ch(v.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!ln(l,!0)){const{message:O}=ne("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(O)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!lr(r)){const{message:l}=ne("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!ym(a)){const{message:l}=ne("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!lr(r)){const{message:y}=ne("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:s,controller:a,namespaces:l,expiry:d}=r;if(!vm(s)){const{message:y}=ne("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const v=mm(a,"onSessionSettleRequest()");if(v)throw new Error(v.message);const E=Uo(l,"onSessionSettleRequest()");if(E)throw new Error(E.message);if(mi(d)){const{message:y}=ne("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!lr(r)){const{message:E}=ne("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(E)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),d=Uo(a,"update()");if(d)throw new Error(d.message);const v=Ch(l.requiredNamespaces,a,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async r=>{if(!lr(r)){const{message:a}=ne("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!lr(r)){const{message:E}=ne("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(E)}const{topic:s,request:a,chainId:l,expiry:d}=r;await this.isValidSessionTopic(s);const{namespaces:v}=this.client.session.get(s);if(!Ah(v,l)){const{message:E}=ne("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(E)}if(!_m(a)){const{message:E}=ne("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(E)}if(!wm(v,l,a.method)){const{message:E}=ne("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(E)}if(d&&!bm(d,Zo)){const{message:E}=ne("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${Zo.min} and ${Zo.max}`);throw new Error(E)}},this.isValidRespond=async r=>{if(!lr(r)){const{message:l}=ne("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!Em(a)){const{message:l}=ne("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!lr(r)){const{message:a}=ne("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!lr(r)){const{message:v}=ne("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(v)}const{topic:s,event:a,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Ah(d,l)){const{message:v}=ne("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(v)}if(!Im(a)){const{message:v}=ne("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(v)}if(!xm(d,l,a.name)){const{message:v}=ne("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(v)}},this.isValidDisconnect=async r=>{if(!lr(r)){const{message:a}=ne("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||ca,validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(a.verified.origin=l,a.verified.validation=l===new URL(s.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!ln(a,!1)){const{message:l}=ne("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:i}=ne("NOT_INITIALIZED",this.name);throw new Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Wt.message,async i=>{const{topic:r,message:s}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{yc(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):vc(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(Cr.expired,async i=>{const{topic:r,id:s}=Al(i.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ne("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(i){if(!ln(i,!1)){const{message:r}=ne("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=ne("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=ne("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!ln(i,!1)){const{message:r}=ne("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=ne("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=ne("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(ln(i,!1)){const{message:r}=ne("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=ne("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!Sm(i)){const{message:r}=ne("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=ne("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=ne("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class Rb extends ga{constructor(i,r){super(i,r,_b,Ec),this.core=i,this.logger=r}}class Tb extends ga{constructor(i,r){super(i,r,wb,Ec),this.core=i,this.logger=r}}class Nb extends ga{constructor(i,r){super(i,r,Eb,Ec,s=>s.id),this.core=i,this.logger=r}}class Ic extends O1{constructor(i){super(i),this.protocol=sf,this.version=af,this.name=Xo.name,this.events=new mr.exports.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=i?.name||Xo.name,this.metadata=i?.metadata||Pm();const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Fe.pino(Fe.getDefaultLoggerOptions({level:i?.logger||Xo.logger}));this.core=i?.core||new mb(i),this.logger=Fe.generateChildLogger(r,this.name),this.session=new Tb(this.core,this.logger),this.proposal=new Rb(this.core,this.logger),this.pendingRequest=new Nb(this.core,this.logger),this.engine=new Ab(this)}static async init(i){const r=new Ic(i);return await r.initialize(),r}get context(){return Fe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}}const yl="error",Db="wss://relay.walletconnect.com",Fb="wc",Lb="universal_provider",vl=`${Fb}@2:${Lb}:`,$b="https://rpc.walletconnect.com/v1",Ii={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,i){(function(){var r,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",v="Invalid `variable` option passed into `_.template`",E="__lodash_hash_undefined__",y=500,O="__lodash_placeholder__",N=1,F=2,V=4,j=1,Q=2,ae=1,he=2,le=4,fe=8,ve=16,me=32,q=64,G=128,U=256,pe=512,m=30,I="...",S=800,$=16,_=1,w=2,Y=3,ee=1/0,Z=9007199254740991,D=17976931348623157e292,H=0/0,X=4294967295,ce=X-1,xe=X>>>1,jt=[["ary",G],["bind",ae],["bindKey",he],["curry",fe],["curryRight",ve],["flip",pe],["partial",me],["partialRight",q],["rearg",U]],be="[object Arguments]",It="[object Array]",z="[object AsyncFunction]",M="[object Boolean]",T="[object Date]",u="[object DOMException]",P="[object Error]",se="[object Function]",_e="[object GeneratorFunction]",Pe="[object Map]",Le="[object Number]",je="[object Null]",Re="[object Object]",xt="[object Promise]",vt="[object Proxy]",st="[object RegExp]",qe="[object Set]",Qe="[object String]",Xe="[object Symbol]",at="[object Undefined]",He="[object WeakMap]",Ze="[object WeakSet]",$e="[object ArrayBuffer]",Ve="[object DataView]",ut="[object Float32Array]",Ue="[object Float64Array]",St="[object Int8Array]",Ft="[object Int16Array]",kt="[object Int32Array]",Ht="[object Uint8Array]",Mt="[object Uint8ClampedArray]",Jt="[object Uint16Array]",ir="[object Uint32Array]",jr=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ai=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,ht=RegExp(ai.source),rt=RegExp(xi.source),lt=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pt=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(pt.source),dt=/^\s+/,mt=/\s/,gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,Rt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ya=/[()=,{}\[\]\/\s]/,va=/\\(\\)?/g,ma=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_r=/\w*$/,_a=/^[-+]0x[0-9a-f]+$/i,wa=/^0b[01]+$/i,ba=/^\[object .+?Constructor\]$/,Ea=/^0o[0-7]+$/i,Ia=/^(?:0|[1-9]\d*)$/,Br=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Hi=/($^)/,xa=/['\n\r\u2028\u2029\\]/g,Ki="\\ud800-\\udfff",Sa="\\u0300-\\u036f",Pa="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",Wn=Sa+Pa+Vi,Jn="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Oa="\\xac\\xb1\\xd7\\xf7",Ca="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Aa="\\u2000-\\u206f",Ra=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Yn="A-Z\\xc0-\\xd6\\xd8-\\xde",Qn="\\ufe0e\\ufe0f",Si=Oa+Ca+Aa+Ra,gn="['\u2019]",Pi="["+Ki+"]",yn="["+Si+"]",Oi="["+Wn+"]",Xn="\\d+",Ta="["+Jn+"]",Zn="["+Rr+"]",es="[^"+Ki+Si+Xn+Jn+Rr+Yn+"]",Bi="\\ud83c[\\udffb-\\udfff]",Na="(?:"+Oi+"|"+Bi+")",ts="[^"+Ki+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",oi="[\\ud800-\\udbff][\\udc00-\\udfff]",fr="["+Yn+"]",rs="\\u200d",is="(?:"+Zn+"|"+es+")",Mr="(?:"+fr+"|"+es+")",ns="(?:"+gn+"(?:d|ll|m|re|s|t|ve))?",ss="(?:"+gn+"(?:D|LL|M|RE|S|T|VE))?",as=Na+"?",os="["+Qn+"]?",Da="(?:"+rs+"(?:"+[ts,Gi,oi].join("|")+")"+os+as+")*",Gr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",us=os+as+Da,Wi="(?:"+[Ta,Gi,oi].join("|")+")"+us,Fa="(?:"+[ts+Oi+"?",Oi,Gi,oi,Pi].join("|")+")",vn=RegExp(gn,"g"),La=RegExp(Oi,"g"),Ji=RegExp(Bi+"(?="+Bi+")|"+Fa+us,"g"),hs=RegExp([fr+"?"+Zn+"+"+ns+"(?="+[yn,fr,"$"].join("|")+")",Mr+"+"+ss+"(?="+[yn,fr+is,"$"].join("|")+")",fr+"?"+is+"+"+ns,fr+"+"+ss,cs,Gr,Xn,Wi].join("|"),"g"),ls=RegExp("["+rs+Ki+Wn+Qn+"]"),Ci=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],$a=-1,Be={};Be[ut]=Be[Ue]=Be[St]=Be[Ft]=Be[kt]=Be[Ht]=Be[Mt]=Be[Jt]=Be[ir]=!0,Be[be]=Be[It]=Be[$e]=Be[M]=Be[Ve]=Be[T]=Be[P]=Be[se]=Be[Pe]=Be[Le]=Be[Re]=Be[st]=Be[qe]=Be[Qe]=Be[He]=!1;var Ke={};Ke[be]=Ke[It]=Ke[$e]=Ke[Ve]=Ke[M]=Ke[T]=Ke[ut]=Ke[Ue]=Ke[St]=Ke[Ft]=Ke[kt]=Ke[Pe]=Ke[Le]=Ke[Re]=Ke[st]=Ke[qe]=Ke[Qe]=Ke[Xe]=Ke[Ht]=Ke[Mt]=Ke[Jt]=Ke[ir]=!0,Ke[P]=Ke[se]=Ke[He]=!1;var g={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},W={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},re={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,Ee=parseInt,et=typeof zn=="object"&&zn&&zn.Object===Object&&zn,Tt=typeof self=="object"&&self&&self.Object===Object&&self,Ne=et||Tt||Function("return this")(),We=i&&!i.nodeType&&i,_t=We&&!0&&c&&!c.nodeType&&c,nr=_t&&_t.exports===We,Nt=nr&&et.process,tt=function(){try{var A=_t&&_t.require&&_t.require("util").types;return A||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Qt=tt&&tt.isArrayBuffer,Tr=tt&&tt.isDate,wr=tt&&tt.isMap,qr=tt&&tt.isRegExp,mn=tt&&tt.isSet,Ai=tt&&tt.isTypedArray;function qt(A,k,L){switch(L.length){case 0:return A.call(k);case 1:return A.call(k,L[0]);case 2:return A.call(k,L[0],L[1]);case 3:return A.call(k,L[0],L[1],L[2])}return A.apply(k,L)}function lf(A,k,L,ie){for(var we=-1,Me=A==null?0:A.length;++we<Me;){var Lt=A[we];k(ie,Lt,L(Lt),A)}return ie}function br(A,k){for(var L=-1,ie=A==null?0:A.length;++L<ie&&k(A[L],L,A)!==!1;);return A}function ff(A,k){for(var L=A==null?0:A.length;L--&&k(A[L],L,A)!==!1;);return A}function Pc(A,k){for(var L=-1,ie=A==null?0:A.length;++L<ie;)if(!k(A[L],L,A))return!1;return!0}function ci(A,k){for(var L=-1,ie=A==null?0:A.length,we=0,Me=[];++L<ie;){var Lt=A[L];k(Lt,L,A)&&(Me[we++]=Lt)}return Me}function ps(A,k){var L=A==null?0:A.length;return!!L&&Yi(A,k,0)>-1}function ja(A,k,L){for(var ie=-1,we=A==null?0:A.length;++ie<we;)if(L(k,A[ie]))return!0;return!1}function nt(A,k){for(var L=-1,ie=A==null?0:A.length,we=Array(ie);++L<ie;)we[L]=k(A[L],L,A);return we}function ui(A,k){for(var L=-1,ie=k.length,we=A.length;++L<ie;)A[we+L]=k[L];return A}function Ma(A,k,L,ie){var we=-1,Me=A==null?0:A.length;for(ie&&Me&&(L=A[++we]);++we<Me;)L=k(L,A[we],we,A);return L}function pf(A,k,L,ie){var we=A==null?0:A.length;for(ie&&we&&(L=A[--we]);we--;)L=k(L,A[we],we,A);return L}function qa(A,k){for(var L=-1,ie=A==null?0:A.length;++L<ie;)if(k(A[L],L,A))return!0;return!1}var df=za("length");function gf(A){return A.split("")}function yf(A){return A.match(Rt)||[]}function Oc(A,k,L){var ie;return L(A,function(we,Me,Lt){if(k(we,Me,Lt))return ie=Me,!1}),ie}function ds(A,k,L,ie){for(var we=A.length,Me=L+(ie?1:-1);ie?Me--:++Me<we;)if(k(A[Me],Me,A))return Me;return-1}function Yi(A,k,L){return k===k?Cf(A,k,L):ds(A,Cc,L)}function vf(A,k,L,ie){for(var we=L-1,Me=A.length;++we<Me;)if(ie(A[we],k))return we;return-1}function Cc(A){return A!==A}function Ac(A,k){var L=A==null?0:A.length;return L?ka(A,k)/L:H}function za(A){return function(k){return k==null?r:k[A]}}function Ua(A){return function(k){return A==null?r:A[k]}}function Rc(A,k,L,ie,we){return we(A,function(Me,Lt,Je){L=ie?(ie=!1,Me):k(L,Me,Lt,Je)}),L}function mf(A,k){var L=A.length;for(A.sort(k);L--;)A[L]=A[L].value;return A}function ka(A,k){for(var L,ie=-1,we=A.length;++ie<we;){var Me=k(A[ie]);Me!==r&&(L=L===r?Me:L+Me)}return L}function Ha(A,k){for(var L=-1,ie=Array(A);++L<A;)ie[L]=k(L);return ie}function _f(A,k){return nt(k,function(L){return[L,A[L]]})}function Tc(A){return A&&A.slice(0,Lc(A)+1).replace(dt,"")}function pr(A){return function(k){return A(k)}}function Ka(A,k){return nt(k,function(L){return A[L]})}function _n(A,k){return A.has(k)}function Nc(A,k){for(var L=-1,ie=A.length;++L<ie&&Yi(k,A[L],0)>-1;);return L}function Dc(A,k){for(var L=A.length;L--&&Yi(k,A[L],0)>-1;);return L}function wf(A,k){for(var L=A.length,ie=0;L--;)A[L]===k&&++ie;return ie}var bf=Ua(g),Ef=Ua(C);function If(A){return"\\"+re[A]}function xf(A,k){return A==null?r:A[k]}function Qi(A){return ls.test(A)}function Sf(A){return Ci.test(A)}function Pf(A){for(var k,L=[];!(k=A.next()).done;)L.push(k.value);return L}function Va(A){var k=-1,L=Array(A.size);return A.forEach(function(ie,we){L[++k]=[we,ie]}),L}function Fc(A,k){return function(L){return A(k(L))}}function hi(A,k){for(var L=-1,ie=A.length,we=0,Me=[];++L<ie;){var Lt=A[L];(Lt===k||Lt===O)&&(A[L]=O,Me[we++]=L)}return Me}function gs(A){var k=-1,L=Array(A.size);return A.forEach(function(ie){L[++k]=ie}),L}function Of(A){var k=-1,L=Array(A.size);return A.forEach(function(ie){L[++k]=[ie,ie]}),L}function Cf(A,k,L){for(var ie=L-1,we=A.length;++ie<we;)if(A[ie]===k)return ie;return-1}function Af(A,k,L){for(var ie=L+1;ie--;)if(A[ie]===k)return ie;return ie}function Xi(A){return Qi(A)?Tf(A):df(A)}function Nr(A){return Qi(A)?Nf(A):gf(A)}function Lc(A){for(var k=A.length;k--&&mt.test(A.charAt(k)););return k}var Rf=Ua(W);function Tf(A){for(var k=Ji.lastIndex=0;Ji.test(A);)++k;return k}function Nf(A){return A.match(Ji)||[]}function Df(A){return A.match(hs)||[]}var Ff=function A(k){k=k==null?Ne:Zi.defaults(Ne.Object(),k,Zi.pick(Ne,fs));var L=k.Array,ie=k.Date,we=k.Error,Me=k.Function,Lt=k.Math,Je=k.Object,Ba=k.RegExp,Lf=k.String,Er=k.TypeError,ys=L.prototype,$f=Me.prototype,en=Je.prototype,vs=k["__core-js_shared__"],ms=$f.toString,ke=en.hasOwnProperty,jf=0,$c=function(){var e=/[^.]+$/.exec(vs&&vs.keys&&vs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),_s=en.toString,Mf=ms.call(Je),qf=Ne._,zf=Ba("^"+ms.call(ke).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ws=nr?k.Buffer:r,li=k.Symbol,bs=k.Uint8Array,jc=ws?ws.allocUnsafe:r,Es=Fc(Je.getPrototypeOf,Je),Mc=Je.create,qc=en.propertyIsEnumerable,Is=ys.splice,zc=li?li.isConcatSpreadable:r,wn=li?li.iterator:r,Ri=li?li.toStringTag:r,xs=function(){try{var e=Li(Je,"defineProperty");return e({},"",{}),e}catch{}}(),Uf=k.clearTimeout!==Ne.clearTimeout&&k.clearTimeout,kf=ie&&ie.now!==Ne.Date.now&&ie.now,Hf=k.setTimeout!==Ne.setTimeout&&k.setTimeout,Ss=Lt.ceil,Ps=Lt.floor,Ga=Je.getOwnPropertySymbols,Kf=ws?ws.isBuffer:r,Uc=k.isFinite,Vf=ys.join,Bf=Fc(Je.keys,Je),$t=Lt.max,Bt=Lt.min,Gf=ie.now,Wf=k.parseInt,kc=Lt.random,Jf=ys.reverse,Wa=Li(k,"DataView"),bn=Li(k,"Map"),Ja=Li(k,"Promise"),tn=Li(k,"Set"),En=Li(k,"WeakMap"),In=Li(Je,"create"),Os=En&&new En,rn={},Yf=$i(Wa),Qf=$i(bn),Xf=$i(Ja),Zf=$i(tn),ep=$i(En),Cs=li?li.prototype:r,xn=Cs?Cs.valueOf:r,Hc=Cs?Cs.toString:r;function f(e){if(yt(e)&&!Ie(e)&&!(e instanceof Te)){if(e instanceof Ir)return e;if(ke.call(e,"__wrapped__"))return Ku(e)}return new Ir(e)}var nn=function(){function e(){}return function(t){if(!ct(t))return{};if(Mc)return Mc(t);e.prototype=t;var n=new e;return e.prototype=r,n}}();function As(){}function Ir(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}f.templateSettings={escape:lt,evaluate:ft,interpolate:ot,variable:"",imports:{_:f}},f.prototype=As.prototype,f.prototype.constructor=f,Ir.prototype=nn(As.prototype),Ir.prototype.constructor=Ir;function Te(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=X,this.__views__=[]}function tp(){var e=new Te(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function rp(){if(this.__filtered__){var e=new Te(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function ip(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ie(e),o=t<0,h=n?e.length:0,p=gd(0,h,this.__views__),b=p.start,x=p.end,R=x-b,K=o?x:b-1,B=this.__iteratees__,J=B.length,te=0,oe=Bt(R,this.__takeCount__);if(!n||!o&&h==R&&oe==R)return pu(e,this.__actions__);var ge=[];e:for(;R--&&te<oe;){K+=t;for(var Oe=-1,ye=e[K];++Oe<J;){var Ae=B[Oe],De=Ae.iteratee,yr=Ae.type,er=De(ye);if(yr==w)ye=er;else if(!er){if(yr==_)continue e;break e}}ge[te++]=ye}return ge}Te.prototype=nn(As.prototype),Te.prototype.constructor=Te;function Ti(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function np(){this.__data__=In?In(null):{},this.size=0}function sp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function ap(e){var t=this.__data__;if(In){var n=t[e];return n===E?r:n}return ke.call(t,e)?t[e]:r}function op(e){var t=this.__data__;return In?t[e]!==r:ke.call(t,e)}function cp(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=In&&t===r?E:t,this}Ti.prototype.clear=np,Ti.prototype.delete=sp,Ti.prototype.get=ap,Ti.prototype.has=op,Ti.prototype.set=cp;function Wr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function up(){this.__data__=[],this.size=0}function hp(e){var t=this.__data__,n=Rs(t,e);if(n<0)return!1;var o=t.length-1;return n==o?t.pop():Is.call(t,n,1),--this.size,!0}function lp(e){var t=this.__data__,n=Rs(t,e);return n<0?r:t[n][1]}function fp(e){return Rs(this.__data__,e)>-1}function pp(e,t){var n=this.__data__,o=Rs(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}Wr.prototype.clear=up,Wr.prototype.delete=hp,Wr.prototype.get=lp,Wr.prototype.has=fp,Wr.prototype.set=pp;function Jr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function dp(){this.size=0,this.__data__={hash:new Ti,map:new(bn||Wr),string:new Ti}}function gp(e){var t=ks(this,e).delete(e);return this.size-=t?1:0,t}function yp(e){return ks(this,e).get(e)}function vp(e){return ks(this,e).has(e)}function mp(e,t){var n=ks(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}Jr.prototype.clear=dp,Jr.prototype.delete=gp,Jr.prototype.get=yp,Jr.prototype.has=vp,Jr.prototype.set=mp;function Ni(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Jr;++t<n;)this.add(e[t])}function _p(e){return this.__data__.set(e,E),this}function wp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=_p,Ni.prototype.has=wp;function Dr(e){var t=this.__data__=new Wr(e);this.size=t.size}function bp(){this.__data__=new Wr,this.size=0}function Ep(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Ip(e){return this.__data__.get(e)}function xp(e){return this.__data__.has(e)}function Sp(e,t){var n=this.__data__;if(n instanceof Wr){var o=n.__data__;if(!bn||o.length<a-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new Jr(o)}return n.set(e,t),this.size=n.size,this}Dr.prototype.clear=bp,Dr.prototype.delete=Ep,Dr.prototype.get=Ip,Dr.prototype.has=xp,Dr.prototype.set=Sp;function Kc(e,t){var n=Ie(e),o=!n&&ji(e),h=!n&&!o&&yi(e),p=!n&&!o&&!h&&cn(e),b=n||o||h||p,x=b?Ha(e.length,Lf):[],R=x.length;for(var K in e)(t||ke.call(e,K))&&!(b&&(K=="length"||h&&(K=="offset"||K=="parent")||p&&(K=="buffer"||K=="byteLength"||K=="byteOffset")||Zr(K,R)))&&x.push(K);return x}function Vc(e){var t=e.length;return t?e[ao(0,t-1)]:r}function Pp(e,t){return Hs(sr(e),Di(t,0,e.length))}function Op(e){return Hs(sr(e))}function Ya(e,t,n){(n!==r&&!Fr(e[t],n)||n===r&&!(t in e))&&Yr(e,t,n)}function Sn(e,t,n){var o=e[t];(!(ke.call(e,t)&&Fr(o,n))||n===r&&!(t in e))&&Yr(e,t,n)}function Rs(e,t){for(var n=e.length;n--;)if(Fr(e[n][0],t))return n;return-1}function Cp(e,t,n,o){return fi(e,function(h,p,b){t(o,h,n(h),b)}),o}function Bc(e,t){return e&&Ur(t,zt(t),e)}function Ap(e,t){return e&&Ur(t,or(t),e)}function Yr(e,t,n){t=="__proto__"&&xs?xs(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Qa(e,t){for(var n=-1,o=t.length,h=L(o),p=e==null;++n<o;)h[n]=p?r:No(e,t[n]);return h}function Di(e,t,n){return e===e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function xr(e,t,n,o,h,p){var b,x=t&N,R=t&F,K=t&V;if(n&&(b=h?n(e,o,h,p):n(e)),b!==r)return b;if(!ct(e))return e;var B=Ie(e);if(B){if(b=vd(e),!x)return sr(e,b)}else{var J=Gt(e),te=J==se||J==_e;if(yi(e))return yu(e,x);if(J==Re||J==be||te&&!h){if(b=R||te?{}:Lu(e),!x)return R?ad(e,Ap(b,e)):sd(e,Bc(b,e))}else{if(!Ke[J])return h?e:{};b=md(e,J,x)}}p||(p=new Dr);var oe=p.get(e);if(oe)return oe;p.set(e,b),hh(e)?e.forEach(function(ye){b.add(xr(ye,t,n,ye,e,p))}):ch(e)&&e.forEach(function(ye,Ae){b.set(Ae,xr(ye,t,n,Ae,e,p))});var ge=K?R?mo:vo:R?or:zt,Oe=B?r:ge(e);return br(Oe||e,function(ye,Ae){Oe&&(Ae=ye,ye=e[Ae]),Sn(b,Ae,xr(ye,t,n,Ae,e,p))}),b}function Rp(e){var t=zt(e);return function(n){return Gc(n,e,t)}}function Gc(e,t,n){var o=n.length;if(e==null)return!o;for(e=Je(e);o--;){var h=n[o],p=t[h],b=e[h];if(b===r&&!(h in e)||!p(b))return!1}return!0}function Wc(e,t,n){if(typeof e!="function")throw new Er(d);return Nn(function(){e.apply(r,n)},t)}function Pn(e,t,n,o){var h=-1,p=ps,b=!0,x=e.length,R=[],K=t.length;if(!x)return R;n&&(t=nt(t,pr(n))),o?(p=ja,b=!1):t.length>=a&&(p=_n,b=!1,t=new Ni(t));e:for(;++h<x;){var B=e[h],J=n==null?B:n(B);if(B=o||B!==0?B:0,b&&J===J){for(var te=K;te--;)if(t[te]===J)continue e;R.push(B)}else p(t,J,o)||R.push(B)}return R}var fi=bu(zr),Jc=bu(Za,!0);function Tp(e,t){var n=!0;return fi(e,function(o,h,p){return n=!!t(o,h,p),n}),n}function Ts(e,t,n){for(var o=-1,h=e.length;++o<h;){var p=e[o],b=t(p);if(b!=null&&(x===r?b===b&&!gr(b):n(b,x)))var x=b,R=p}return R}function Np(e,t,n,o){var h=e.length;for(n=Se(n),n<0&&(n=-n>h?0:h+n),o=o===r||o>h?h:Se(o),o<0&&(o+=h),o=n>o?0:fh(o);n<o;)e[n++]=t;return e}function Yc(e,t){var n=[];return fi(e,function(o,h,p){t(o,h,p)&&n.push(o)}),n}function Kt(e,t,n,o,h){var p=-1,b=e.length;for(n||(n=wd),h||(h=[]);++p<b;){var x=e[p];t>0&&n(x)?t>1?Kt(x,t-1,n,o,h):ui(h,x):o||(h[h.length]=x)}return h}var Xa=Eu(),Qc=Eu(!0);function zr(e,t){return e&&Xa(e,t,zt)}function Za(e,t){return e&&Qc(e,t,zt)}function Ns(e,t){return ci(t,function(n){return ei(e[n])})}function Fi(e,t){t=di(t,e);for(var n=0,o=t.length;e!=null&&n<o;)e=e[kr(t[n++])];return n&&n==o?e:r}function Xc(e,t,n){var o=t(e);return Ie(e)?o:ui(o,n(e))}function Xt(e){return e==null?e===r?at:je:Ri&&Ri in Je(e)?dd(e):Od(e)}function eo(e,t){return e>t}function Dp(e,t){return e!=null&&ke.call(e,t)}function Fp(e,t){return e!=null&&t in Je(e)}function Lp(e,t,n){return e>=Bt(t,n)&&e<$t(t,n)}function to(e,t,n){for(var o=n?ja:ps,h=e[0].length,p=e.length,b=p,x=L(p),R=1/0,K=[];b--;){var B=e[b];b&&t&&(B=nt(B,pr(t))),R=Bt(B.length,R),x[b]=!n&&(t||h>=120&&B.length>=120)?new Ni(b&&B):r}B=e[0];var J=-1,te=x[0];e:for(;++J<h&&K.length<R;){var oe=B[J],ge=t?t(oe):oe;if(oe=n||oe!==0?oe:0,!(te?_n(te,ge):o(K,ge,n))){for(b=p;--b;){var Oe=x[b];if(!(Oe?_n(Oe,ge):o(e[b],ge,n)))continue e}te&&te.push(ge),K.push(oe)}}return K}function $p(e,t,n,o){return zr(e,function(h,p,b){t(o,n(h),p,b)}),o}function On(e,t,n){t=di(t,e),e=qu(e,t);var o=e==null?e:e[kr(Pr(t))];return o==null?r:qt(o,e,n)}function Zc(e){return yt(e)&&Xt(e)==be}function jp(e){return yt(e)&&Xt(e)==$e}function Mp(e){return yt(e)&&Xt(e)==T}function Cn(e,t,n,o,h){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:qp(e,t,n,o,Cn,h)}function qp(e,t,n,o,h,p){var b=Ie(e),x=Ie(t),R=b?It:Gt(e),K=x?It:Gt(t);R=R==be?Re:R,K=K==be?Re:K;var B=R==Re,J=K==Re,te=R==K;if(te&&yi(e)){if(!yi(t))return!1;b=!0,B=!1}if(te&&!B)return p||(p=new Dr),b||cn(e)?Nu(e,t,n,o,h,p):fd(e,t,R,n,o,h,p);if(!(n&j)){var oe=B&&ke.call(e,"__wrapped__"),ge=J&&ke.call(t,"__wrapped__");if(oe||ge){var Oe=oe?e.value():e,ye=ge?t.value():t;return p||(p=new Dr),h(Oe,ye,n,o,p)}}return te?(p||(p=new Dr),pd(e,t,n,o,h,p)):!1}function zp(e){return yt(e)&&Gt(e)==Pe}function ro(e,t,n,o){var h=n.length,p=h,b=!o;if(e==null)return!p;for(e=Je(e);h--;){var x=n[h];if(b&&x[2]?x[1]!==e[x[0]]:!(x[0]in e))return!1}for(;++h<p;){x=n[h];var R=x[0],K=e[R],B=x[1];if(b&&x[2]){if(K===r&&!(R in e))return!1}else{var J=new Dr;if(o)var te=o(K,B,R,e,t,J);if(!(te===r?Cn(B,K,j|Q,o,J):te))return!1}}return!0}function eu(e){if(!ct(e)||Ed(e))return!1;var t=ei(e)?zf:ba;return t.test($i(e))}function Up(e){return yt(e)&&Xt(e)==st}function kp(e){return yt(e)&&Gt(e)==qe}function Hp(e){return yt(e)&&Js(e.length)&&!!Be[Xt(e)]}function tu(e){return typeof e=="function"?e:e==null?cr:typeof e=="object"?Ie(e)?nu(e[0],e[1]):iu(e):Ih(e)}function io(e){if(!Tn(e))return Bf(e);var t=[];for(var n in Je(e))ke.call(e,n)&&n!="constructor"&&t.push(n);return t}function Kp(e){if(!ct(e))return Pd(e);var t=Tn(e),n=[];for(var o in e)o=="constructor"&&(t||!ke.call(e,o))||n.push(o);return n}function no(e,t){return e<t}function ru(e,t){var n=-1,o=ar(e)?L(e.length):[];return fi(e,function(h,p,b){o[++n]=t(h,p,b)}),o}function iu(e){var t=wo(e);return t.length==1&&t[0][2]?ju(t[0][0],t[0][1]):function(n){return n===e||ro(n,e,t)}}function nu(e,t){return Eo(e)&&$u(t)?ju(kr(e),t):function(n){var o=No(n,e);return o===r&&o===t?Do(n,e):Cn(t,o,j|Q)}}function Ds(e,t,n,o,h){e!==t&&Xa(t,function(p,b){if(h||(h=new Dr),ct(p))Vp(e,t,b,n,Ds,o,h);else{var x=o?o(xo(e,b),p,b+"",e,t,h):r;x===r&&(x=p),Ya(e,b,x)}},or)}function Vp(e,t,n,o,h,p,b){var x=xo(e,n),R=xo(t,n),K=b.get(R);if(K){Ya(e,n,K);return}var B=p?p(x,R,n+"",e,t,b):r,J=B===r;if(J){var te=Ie(R),oe=!te&&yi(R),ge=!te&&!oe&&cn(R);B=R,te||oe||ge?Ie(x)?B=x:wt(x)?B=sr(x):oe?(J=!1,B=yu(R,!0)):ge?(J=!1,B=vu(R,!0)):B=[]:Dn(R)||ji(R)?(B=x,ji(x)?B=ph(x):(!ct(x)||ei(x))&&(B=Lu(R))):J=!1}J&&(b.set(R,B),h(B,R,o,p,b),b.delete(R)),Ya(e,n,B)}function su(e,t){var n=e.length;if(n)return t+=t<0?n:0,Zr(t,n)?e[t]:r}function au(e,t,n){t.length?t=nt(t,function(p){return Ie(p)?function(b){return Fi(b,p.length===1?p[0]:p)}:p}):t=[cr];var o=-1;t=nt(t,pr(de()));var h=ru(e,function(p,b,x){var R=nt(t,function(K){return K(p)});return{criteria:R,index:++o,value:p}});return mf(h,function(p,b){return nd(p,b,n)})}function Bp(e,t){return ou(e,t,function(n,o){return Do(e,o)})}function ou(e,t,n){for(var o=-1,h=t.length,p={};++o<h;){var b=t[o],x=Fi(e,b);n(x,b)&&An(p,di(b,e),x)}return p}function Gp(e){return function(t){return Fi(t,e)}}function so(e,t,n,o){var h=o?vf:Yi,p=-1,b=t.length,x=e;for(e===t&&(t=sr(t)),n&&(x=nt(e,pr(n)));++p<b;)for(var R=0,K=t[p],B=n?n(K):K;(R=h(x,B,R,o))>-1;)x!==e&&Is.call(x,R,1),Is.call(e,R,1);return e}function cu(e,t){for(var n=e?t.length:0,o=n-1;n--;){var h=t[n];if(n==o||h!==p){var p=h;Zr(h)?Is.call(e,h,1):uo(e,h)}}return e}function ao(e,t){return e+Ps(kc()*(t-e+1))}function Wp(e,t,n,o){for(var h=-1,p=$t(Ss((t-e)/(n||1)),0),b=L(p);p--;)b[o?p:++h]=e,e+=n;return b}function oo(e,t){var n="";if(!e||t<1||t>Z)return n;do t%2&&(n+=e),t=Ps(t/2),t&&(e+=e);while(t);return n}function Ce(e,t){return So(Mu(e,t,cr),e+"")}function Jp(e){return Vc(un(e))}function Yp(e,t){var n=un(e);return Hs(n,Di(t,0,n.length))}function An(e,t,n,o){if(!ct(e))return e;t=di(t,e);for(var h=-1,p=t.length,b=p-1,x=e;x!=null&&++h<p;){var R=kr(t[h]),K=n;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(h!=b){var B=x[R];K=o?o(B,R,x):r,K===r&&(K=ct(B)?B:Zr(t[h+1])?[]:{})}Sn(x,R,K),x=x[R]}return e}var uu=Os?function(e,t){return Os.set(e,t),e}:cr,Qp=xs?function(e,t){return xs(e,"toString",{configurable:!0,enumerable:!1,value:Lo(t),writable:!0})}:cr;function Xp(e){return Hs(un(e))}function Sr(e,t,n){var o=-1,h=e.length;t<0&&(t=-t>h?0:h+t),n=n>h?h:n,n<0&&(n+=h),h=t>n?0:n-t>>>0,t>>>=0;for(var p=L(h);++o<h;)p[o]=e[o+t];return p}function Zp(e,t){var n;return fi(e,function(o,h,p){return n=t(o,h,p),!n}),!!n}function Fs(e,t,n){var o=0,h=e==null?o:e.length;if(typeof t=="number"&&t===t&&h<=xe){for(;o<h;){var p=o+h>>>1,b=e[p];b!==null&&!gr(b)&&(n?b<=t:b<t)?o=p+1:h=p}return h}return co(e,t,cr,n)}function co(e,t,n,o){var h=0,p=e==null?0:e.length;if(p===0)return 0;t=n(t);for(var b=t!==t,x=t===null,R=gr(t),K=t===r;h<p;){var B=Ps((h+p)/2),J=n(e[B]),te=J!==r,oe=J===null,ge=J===J,Oe=gr(J);if(b)var ye=o||ge;else K?ye=ge&&(o||te):x?ye=ge&&te&&(o||!oe):R?ye=ge&&te&&!oe&&(o||!Oe):oe||Oe?ye=!1:ye=o?J<=t:J<t;ye?h=B+1:p=B}return Bt(p,ce)}function hu(e,t){for(var n=-1,o=e.length,h=0,p=[];++n<o;){var b=e[n],x=t?t(b):b;if(!n||!Fr(x,R)){var R=x;p[h++]=b===0?0:b}}return p}function lu(e){return typeof e=="number"?e:gr(e)?H:+e}function dr(e){if(typeof e=="string")return e;if(Ie(e))return nt(e,dr)+"";if(gr(e))return Hc?Hc.call(e):"";var t=e+"";return t=="0"&&1/e==-ee?"-0":t}function pi(e,t,n){var o=-1,h=ps,p=e.length,b=!0,x=[],R=x;if(n)b=!1,h=ja;else if(p>=a){var K=t?null:hd(e);if(K)return gs(K);b=!1,h=_n,R=new Ni}else R=t?[]:x;e:for(;++o<p;){var B=e[o],J=t?t(B):B;if(B=n||B!==0?B:0,b&&J===J){for(var te=R.length;te--;)if(R[te]===J)continue e;t&&R.push(J),x.push(B)}else h(R,J,n)||(R!==x&&R.push(J),x.push(B))}return x}function uo(e,t){return t=di(t,e),e=qu(e,t),e==null||delete e[kr(Pr(t))]}function fu(e,t,n,o){return An(e,t,n(Fi(e,t)),o)}function Ls(e,t,n,o){for(var h=e.length,p=o?h:-1;(o?p--:++p<h)&&t(e[p],p,e););return n?Sr(e,o?0:p,o?p+1:h):Sr(e,o?p+1:0,o?h:p)}function pu(e,t){var n=e;return n instanceof Te&&(n=n.value()),Ma(t,function(o,h){return h.func.apply(h.thisArg,ui([o],h.args))},n)}function ho(e,t,n){var o=e.length;if(o<2)return o?pi(e[0]):[];for(var h=-1,p=L(o);++h<o;)for(var b=e[h],x=-1;++x<o;)x!=h&&(p[h]=Pn(p[h]||b,e[x],t,n));return pi(Kt(p,1),t,n)}function du(e,t,n){for(var o=-1,h=e.length,p=t.length,b={};++o<h;){var x=o<p?t[o]:r;n(b,e[o],x)}return b}function lo(e){return wt(e)?e:[]}function fo(e){return typeof e=="function"?e:cr}function di(e,t){return Ie(e)?e:Eo(e,t)?[e]:Hu(ze(e))}var ed=Ce;function gi(e,t,n){var o=e.length;return n=n===r?o:n,!t&&n>=o?e:Sr(e,t,n)}var gu=Uf||function(e){return Ne.clearTimeout(e)};function yu(e,t){if(t)return e.slice();var n=e.length,o=jc?jc(n):new e.constructor(n);return e.copy(o),o}function po(e){var t=new e.constructor(e.byteLength);return new bs(t).set(new bs(e)),t}function td(e,t){var n=t?po(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function rd(e){var t=new e.constructor(e.source,_r.exec(e));return t.lastIndex=e.lastIndex,t}function id(e){return xn?Je(xn.call(e)):{}}function vu(e,t){var n=t?po(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function mu(e,t){if(e!==t){var n=e!==r,o=e===null,h=e===e,p=gr(e),b=t!==r,x=t===null,R=t===t,K=gr(t);if(!x&&!K&&!p&&e>t||p&&b&&R&&!x&&!K||o&&b&&R||!n&&R||!h)return 1;if(!o&&!p&&!K&&e<t||K&&n&&h&&!o&&!p||x&&n&&h||!b&&h||!R)return-1}return 0}function nd(e,t,n){for(var o=-1,h=e.criteria,p=t.criteria,b=h.length,x=n.length;++o<b;){var R=mu(h[o],p[o]);if(R){if(o>=x)return R;var K=n[o];return R*(K=="desc"?-1:1)}}return e.index-t.index}function _u(e,t,n,o){for(var h=-1,p=e.length,b=n.length,x=-1,R=t.length,K=$t(p-b,0),B=L(R+K),J=!o;++x<R;)B[x]=t[x];for(;++h<b;)(J||h<p)&&(B[n[h]]=e[h]);for(;K--;)B[x++]=e[h++];return B}function wu(e,t,n,o){for(var h=-1,p=e.length,b=-1,x=n.length,R=-1,K=t.length,B=$t(p-x,0),J=L(B+K),te=!o;++h<B;)J[h]=e[h];for(var oe=h;++R<K;)J[oe+R]=t[R];for(;++b<x;)(te||h<p)&&(J[oe+n[b]]=e[h++]);return J}function sr(e,t){var n=-1,o=e.length;for(t||(t=L(o));++n<o;)t[n]=e[n];return t}function Ur(e,t,n,o){var h=!n;n||(n={});for(var p=-1,b=t.length;++p<b;){var x=t[p],R=o?o(n[x],e[x],x,n,e):r;R===r&&(R=e[x]),h?Yr(n,x,R):Sn(n,x,R)}return n}function sd(e,t){return Ur(e,bo(e),t)}function ad(e,t){return Ur(e,Du(e),t)}function $s(e,t){return function(n,o){var h=Ie(n)?lf:Cp,p=t?t():{};return h(n,e,de(o,2),p)}}function sn(e){return Ce(function(t,n){var o=-1,h=n.length,p=h>1?n[h-1]:r,b=h>2?n[2]:r;for(p=e.length>3&&typeof p=="function"?(h--,p):r,b&&Zt(n[0],n[1],b)&&(p=h<3?r:p,h=1),t=Je(t);++o<h;){var x=n[o];x&&e(t,x,o,p)}return t})}function bu(e,t){return function(n,o){if(n==null)return n;if(!ar(n))return e(n,o);for(var h=n.length,p=t?h:-1,b=Je(n);(t?p--:++p<h)&&o(b[p],p,b)!==!1;);return n}}function Eu(e){return function(t,n,o){for(var h=-1,p=Je(t),b=o(t),x=b.length;x--;){var R=b[e?x:++h];if(n(p[R],R,p)===!1)break}return t}}function od(e,t,n){var o=t&ae,h=Rn(e);function p(){var b=this&&this!==Ne&&this instanceof p?h:e;return b.apply(o?n:this,arguments)}return p}function Iu(e){return function(t){t=ze(t);var n=Qi(t)?Nr(t):r,o=n?n[0]:t.charAt(0),h=n?gi(n,1).join(""):t.slice(1);return o[e]()+h}}function an(e){return function(t){return Ma(bh(wh(t).replace(vn,"")),e,"")}}function Rn(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=nn(e.prototype),o=e.apply(n,t);return ct(o)?o:n}}function cd(e,t,n){var o=Rn(e);function h(){for(var p=arguments.length,b=L(p),x=p,R=on(h);x--;)b[x]=arguments[x];var K=p<3&&b[0]!==R&&b[p-1]!==R?[]:hi(b,R);if(p-=K.length,p<n)return Cu(e,t,js,h.placeholder,r,b,K,r,r,n-p);var B=this&&this!==Ne&&this instanceof h?o:e;return qt(B,this,b)}return h}function xu(e){return function(t,n,o){var h=Je(t);if(!ar(t)){var p=de(n,3);t=zt(t),n=function(x){return p(h[x],x,h)}}var b=e(t,n,o);return b>-1?h[p?t[b]:b]:r}}function Su(e){return Xr(function(t){var n=t.length,o=n,h=Ir.prototype.thru;for(e&&t.reverse();o--;){var p=t[o];if(typeof p!="function")throw new Er(d);if(h&&!b&&Us(p)=="wrapper")var b=new Ir([],!0)}for(o=b?o:n;++o<n;){p=t[o];var x=Us(p),R=x=="wrapper"?_o(p):r;R&&Io(R[0])&&R[1]==(G|fe|me|U)&&!R[4].length&&R[9]==1?b=b[Us(R[0])].apply(b,R[3]):b=p.length==1&&Io(p)?b[x]():b.thru(p)}return function(){var K=arguments,B=K[0];if(b&&K.length==1&&Ie(B))return b.plant(B).value();for(var J=0,te=n?t[J].apply(this,K):B;++J<n;)te=t[J].call(this,te);return te}})}function js(e,t,n,o,h,p,b,x,R,K){var B=t&G,J=t&ae,te=t&he,oe=t&(fe|ve),ge=t&pe,Oe=te?r:Rn(e);function ye(){for(var Ae=arguments.length,De=L(Ae),yr=Ae;yr--;)De[yr]=arguments[yr];if(oe)var er=on(ye),vr=wf(De,er);if(o&&(De=_u(De,o,h,oe)),p&&(De=wu(De,p,b,oe)),Ae-=vr,oe&&Ae<K){var bt=hi(De,er);return Cu(e,t,js,ye.placeholder,n,De,bt,x,R,K-Ae)}var Lr=J?n:this,ri=te?Lr[e]:e;return Ae=De.length,x?De=Cd(De,x):ge&&Ae>1&&De.reverse(),B&&R<Ae&&(De.length=R),this&&this!==Ne&&this instanceof ye&&(ri=Oe||Rn(ri)),ri.apply(Lr,De)}return ye}function Pu(e,t){return function(n,o){return $p(n,e,t(o),{})}}function Ms(e,t){return function(n,o){var h;if(n===r&&o===r)return t;if(n!==r&&(h=n),o!==r){if(h===r)return o;typeof n=="string"||typeof o=="string"?(n=dr(n),o=dr(o)):(n=lu(n),o=lu(o)),h=e(n,o)}return h}}function go(e){return Xr(function(t){return t=nt(t,pr(de())),Ce(function(n){var o=this;return e(t,function(h){return qt(h,o,n)})})})}function qs(e,t){t=t===r?" ":dr(t);var n=t.length;if(n<2)return n?oo(t,e):t;var o=oo(t,Ss(e/Xi(t)));return Qi(t)?gi(Nr(o),0,e).join(""):o.slice(0,e)}function ud(e,t,n,o){var h=t&ae,p=Rn(e);function b(){for(var x=-1,R=arguments.length,K=-1,B=o.length,J=L(B+R),te=this&&this!==Ne&&this instanceof b?p:e;++K<B;)J[K]=o[K];for(;R--;)J[K++]=arguments[++x];return qt(te,h?n:this,J)}return b}function Ou(e){return function(t,n,o){return o&&typeof o!="number"&&Zt(t,n,o)&&(n=o=r),t=ti(t),n===r?(n=t,t=0):n=ti(n),o=o===r?t<n?1:-1:ti(o),Wp(t,n,o,e)}}function zs(e){return function(t,n){return typeof t=="string"&&typeof n=="string"||(t=Or(t),n=Or(n)),e(t,n)}}function Cu(e,t,n,o,h,p,b,x,R,K){var B=t&fe,J=B?b:r,te=B?r:b,oe=B?p:r,ge=B?r:p;t|=B?me:q,t&=~(B?q:me),t&le||(t&=~(ae|he));var Oe=[e,t,h,oe,J,ge,te,x,R,K],ye=n.apply(r,Oe);return Io(e)&&zu(ye,Oe),ye.placeholder=o,Uu(ye,e,t)}function yo(e){var t=Lt[e];return function(n,o){if(n=Or(n),o=o==null?0:Bt(Se(o),292),o&&Uc(n)){var h=(ze(n)+"e").split("e"),p=t(h[0]+"e"+(+h[1]+o));return h=(ze(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-o))}return t(n)}}var hd=tn&&1/gs(new tn([,-0]))[1]==ee?function(e){return new tn(e)}:Mo;function Au(e){return function(t){var n=Gt(t);return n==Pe?Va(t):n==qe?Of(t):_f(t,e(t))}}function Qr(e,t,n,o,h,p,b,x){var R=t&he;if(!R&&typeof e!="function")throw new Er(d);var K=o?o.length:0;if(K||(t&=~(me|q),o=h=r),b=b===r?b:$t(Se(b),0),x=x===r?x:Se(x),K-=h?h.length:0,t&q){var B=o,J=h;o=h=r}var te=R?r:_o(e),oe=[e,t,n,o,h,B,J,p,b,x];if(te&&Sd(oe,te),e=oe[0],t=oe[1],n=oe[2],o=oe[3],h=oe[4],x=oe[9]=oe[9]===r?R?0:e.length:$t(oe[9]-K,0),!x&&t&(fe|ve)&&(t&=~(fe|ve)),!t||t==ae)var ge=od(e,t,n);else t==fe||t==ve?ge=cd(e,t,x):(t==me||t==(ae|me))&&!h.length?ge=ud(e,t,n,o):ge=js.apply(r,oe);var Oe=te?uu:zu;return Uu(Oe(ge,oe),e,t)}function Ru(e,t,n,o){return e===r||Fr(e,en[n])&&!ke.call(o,n)?t:e}function Tu(e,t,n,o,h,p){return ct(e)&&ct(t)&&(p.set(t,e),Ds(e,t,r,Tu,p),p.delete(t)),e}function ld(e){return Dn(e)?r:e}function Nu(e,t,n,o,h,p){var b=n&j,x=e.length,R=t.length;if(x!=R&&!(b&&R>x))return!1;var K=p.get(e),B=p.get(t);if(K&&B)return K==t&&B==e;var J=-1,te=!0,oe=n&Q?new Ni:r;for(p.set(e,t),p.set(t,e);++J<x;){var ge=e[J],Oe=t[J];if(o)var ye=b?o(Oe,ge,J,t,e,p):o(ge,Oe,J,e,t,p);if(ye!==r){if(ye)continue;te=!1;break}if(oe){if(!qa(t,function(Ae,De){if(!_n(oe,De)&&(ge===Ae||h(ge,Ae,n,o,p)))return oe.push(De)})){te=!1;break}}else if(!(ge===Oe||h(ge,Oe,n,o,p))){te=!1;break}}return p.delete(e),p.delete(t),te}function fd(e,t,n,o,h,p,b){switch(n){case Ve:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case $e:return!(e.byteLength!=t.byteLength||!p(new bs(e),new bs(t)));case M:case T:case Le:return Fr(+e,+t);case P:return e.name==t.name&&e.message==t.message;case st:case Qe:return e==t+"";case Pe:var x=Va;case qe:var R=o&j;if(x||(x=gs),e.size!=t.size&&!R)return!1;var K=b.get(e);if(K)return K==t;o|=Q,b.set(e,t);var B=Nu(x(e),x(t),o,h,p,b);return b.delete(e),B;case Xe:if(xn)return xn.call(e)==xn.call(t)}return!1}function pd(e,t,n,o,h,p){var b=n&j,x=vo(e),R=x.length,K=vo(t),B=K.length;if(R!=B&&!b)return!1;for(var J=R;J--;){var te=x[J];if(!(b?te in t:ke.call(t,te)))return!1}var oe=p.get(e),ge=p.get(t);if(oe&&ge)return oe==t&&ge==e;var Oe=!0;p.set(e,t),p.set(t,e);for(var ye=b;++J<R;){te=x[J];var Ae=e[te],De=t[te];if(o)var yr=b?o(De,Ae,te,t,e,p):o(Ae,De,te,e,t,p);if(!(yr===r?Ae===De||h(Ae,De,n,o,p):yr)){Oe=!1;break}ye||(ye=te=="constructor")}if(Oe&&!ye){var er=e.constructor,vr=t.constructor;er!=vr&&"constructor"in e&&"constructor"in t&&!(typeof er=="function"&&er instanceof er&&typeof vr=="function"&&vr instanceof vr)&&(Oe=!1)}return p.delete(e),p.delete(t),Oe}function Xr(e){return So(Mu(e,r,Gu),e+"")}function vo(e){return Xc(e,zt,bo)}function mo(e){return Xc(e,or,Du)}var _o=Os?function(e){return Os.get(e)}:Mo;function Us(e){for(var t=e.name+"",n=rn[t],o=ke.call(rn,t)?n.length:0;o--;){var h=n[o],p=h.func;if(p==null||p==e)return h.name}return t}function on(e){var t=ke.call(f,"placeholder")?f:e;return t.placeholder}function de(){var e=f.iteratee||$o;return e=e===$o?tu:e,arguments.length?e(arguments[0],arguments[1]):e}function ks(e,t){var n=e.__data__;return bd(t)?n[typeof t=="string"?"string":"hash"]:n.map}function wo(e){for(var t=zt(e),n=t.length;n--;){var o=t[n],h=e[o];t[n]=[o,h,$u(h)]}return t}function Li(e,t){var n=xf(e,t);return eu(n)?n:r}function dd(e){var t=ke.call(e,Ri),n=e[Ri];try{e[Ri]=r;var o=!0}catch{}var h=_s.call(e);return o&&(t?e[Ri]=n:delete e[Ri]),h}var bo=Ga?function(e){return e==null?[]:(e=Je(e),ci(Ga(e),function(t){return qc.call(e,t)}))}:qo,Du=Ga?function(e){for(var t=[];e;)ui(t,bo(e)),e=Es(e);return t}:qo,Gt=Xt;(Wa&&Gt(new Wa(new ArrayBuffer(1)))!=Ve||bn&&Gt(new bn)!=Pe||Ja&&Gt(Ja.resolve())!=xt||tn&&Gt(new tn)!=qe||En&&Gt(new En)!=He)&&(Gt=function(e){var t=Xt(e),n=t==Re?e.constructor:r,o=n?$i(n):"";if(o)switch(o){case Yf:return Ve;case Qf:return Pe;case Xf:return xt;case Zf:return qe;case ep:return He}return t});function gd(e,t,n){for(var o=-1,h=n.length;++o<h;){var p=n[o],b=p.size;switch(p.type){case"drop":e+=b;break;case"dropRight":t-=b;break;case"take":t=Bt(t,e+b);break;case"takeRight":e=$t(e,t-b);break}}return{start:e,end:t}}function yd(e){var t=e.match(Ye);return t?t[1].split(At):[]}function Fu(e,t,n){t=di(t,e);for(var o=-1,h=t.length,p=!1;++o<h;){var b=kr(t[o]);if(!(p=e!=null&&n(e,b)))break;e=e[b]}return p||++o!=h?p:(h=e==null?0:e.length,!!h&&Js(h)&&Zr(b,h)&&(Ie(e)||ji(e)))}function vd(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&ke.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Lu(e){return typeof e.constructor=="function"&&!Tn(e)?nn(Es(e)):{}}function md(e,t,n){var o=e.constructor;switch(t){case $e:return po(e);case M:case T:return new o(+e);case Ve:return td(e,n);case ut:case Ue:case St:case Ft:case kt:case Ht:case Mt:case Jt:case ir:return vu(e,n);case Pe:return new o;case Le:case Qe:return new o(e);case st:return rd(e);case qe:return new o;case Xe:return id(e)}}function _d(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(gt,`{
/* [wrapped with `+t+`] */
`)}function wd(e){return Ie(e)||ji(e)||!!(zc&&e&&e[zc])}function Zr(e,t){var n=typeof e;return t=t??Z,!!t&&(n=="number"||n!="symbol"&&Ia.test(e))&&e>-1&&e%1==0&&e<t}function Zt(e,t,n){if(!ct(n))return!1;var o=typeof t;return(o=="number"?ar(n)&&Zr(t,n.length):o=="string"&&t in n)?Fr(n[t],e):!1}function Eo(e,t){if(Ie(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||gr(e)?!0:Pt.test(e)||!it.test(e)||t!=null&&e in Je(t)}function bd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Io(e){var t=Us(e),n=f[t];if(typeof n!="function"||!(t in Te.prototype))return!1;if(e===n)return!0;var o=_o(n);return!!o&&e===o[0]}function Ed(e){return!!$c&&$c in e}var Id=vs?ei:zo;function Tn(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||en;return e===n}function $u(e){return e===e&&!ct(e)}function ju(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==r||e in Je(n))}}function xd(e){var t=Gs(e,function(o){return n.size===y&&n.clear(),o}),n=t.cache;return t}function Sd(e,t){var n=e[1],o=t[1],h=n|o,p=h<(ae|he|G),b=o==G&&n==fe||o==G&&n==U&&e[7].length<=t[8]||o==(G|U)&&t[7].length<=t[8]&&n==fe;if(!(p||b))return e;o&ae&&(e[2]=t[2],h|=n&ae?0:le);var x=t[3];if(x){var R=e[3];e[3]=R?_u(R,x,t[4]):x,e[4]=R?hi(e[3],O):t[4]}return x=t[5],x&&(R=e[5],e[5]=R?wu(R,x,t[6]):x,e[6]=R?hi(e[5],O):t[6]),x=t[7],x&&(e[7]=x),o&G&&(e[8]=e[8]==null?t[8]:Bt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=h,e}function Pd(e){var t=[];if(e!=null)for(var n in Je(e))t.push(n);return t}function Od(e){return _s.call(e)}function Mu(e,t,n){return t=$t(t===r?e.length-1:t,0),function(){for(var o=arguments,h=-1,p=$t(o.length-t,0),b=L(p);++h<p;)b[h]=o[t+h];h=-1;for(var x=L(t+1);++h<t;)x[h]=o[h];return x[t]=n(b),qt(e,this,x)}}function qu(e,t){return t.length<2?e:Fi(e,Sr(t,0,-1))}function Cd(e,t){for(var n=e.length,o=Bt(t.length,n),h=sr(e);o--;){var p=t[o];e[o]=Zr(p,n)?h[p]:r}return e}function xo(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var zu=ku(uu),Nn=Hf||function(e,t){return Ne.setTimeout(e,t)},So=ku(Qp);function Uu(e,t,n){var o=t+"";return So(e,_d(o,Ad(yd(o),n)))}function ku(e){var t=0,n=0;return function(){var o=Gf(),h=$-(o-n);if(n=o,h>0){if(++t>=S)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Hs(e,t){var n=-1,o=e.length,h=o-1;for(t=t===r?o:t;++n<t;){var p=ao(n,h),b=e[p];e[p]=e[n],e[n]=b}return e.length=t,e}var Hu=xd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ot,function(n,o,h,p){t.push(h?p.replace(va,"$1"):o||n)}),t});function kr(e){if(typeof e=="string"||gr(e))return e;var t=e+"";return t=="0"&&1/e==-ee?"-0":t}function $i(e){if(e!=null){try{return ms.call(e)}catch{}try{return e+""}catch{}}return""}function Ad(e,t){return br(jt,function(n){var o="_."+n[0];t&n[1]&&!ps(e,o)&&e.push(o)}),e.sort()}function Ku(e){if(e instanceof Te)return e.clone();var t=new Ir(e.__wrapped__,e.__chain__);return t.__actions__=sr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Rd(e,t,n){(n?Zt(e,t,n):t===r)?t=1:t=$t(Se(t),0);var o=e==null?0:e.length;if(!o||t<1)return[];for(var h=0,p=0,b=L(Ss(o/t));h<o;)b[p++]=Sr(e,h,h+=t);return b}function Td(e){for(var t=-1,n=e==null?0:e.length,o=0,h=[];++t<n;){var p=e[t];p&&(h[o++]=p)}return h}function Nd(){var e=arguments.length;if(!e)return[];for(var t=L(e-1),n=arguments[0],o=e;o--;)t[o-1]=arguments[o];return ui(Ie(n)?sr(n):[n],Kt(t,1))}var Dd=Ce(function(e,t){return wt(e)?Pn(e,Kt(t,1,wt,!0)):[]}),Fd=Ce(function(e,t){var n=Pr(t);return wt(n)&&(n=r),wt(e)?Pn(e,Kt(t,1,wt,!0),de(n,2)):[]}),Ld=Ce(function(e,t){var n=Pr(t);return wt(n)&&(n=r),wt(e)?Pn(e,Kt(t,1,wt,!0),r,n):[]});function $d(e,t,n){var o=e==null?0:e.length;return o?(t=n||t===r?1:Se(t),Sr(e,t<0?0:t,o)):[]}function jd(e,t,n){var o=e==null?0:e.length;return o?(t=n||t===r?1:Se(t),t=o-t,Sr(e,0,t<0?0:t)):[]}function Md(e,t){return e&&e.length?Ls(e,de(t,3),!0,!0):[]}function qd(e,t){return e&&e.length?Ls(e,de(t,3),!0):[]}function zd(e,t,n,o){var h=e==null?0:e.length;return h?(n&&typeof n!="number"&&Zt(e,t,n)&&(n=0,o=h),Np(e,t,n,o)):[]}function Vu(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var h=n==null?0:Se(n);return h<0&&(h=$t(o+h,0)),ds(e,de(t,3),h)}function Bu(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var h=o-1;return n!==r&&(h=Se(n),h=n<0?$t(o+h,0):Bt(h,o-1)),ds(e,de(t,3),h,!0)}function Gu(e){var t=e==null?0:e.length;return t?Kt(e,1):[]}function Ud(e){var t=e==null?0:e.length;return t?Kt(e,ee):[]}function kd(e,t){var n=e==null?0:e.length;return n?(t=t===r?1:Se(t),Kt(e,t)):[]}function Hd(e){for(var t=-1,n=e==null?0:e.length,o={};++t<n;){var h=e[t];o[h[0]]=h[1]}return o}function Wu(e){return e&&e.length?e[0]:r}function Kd(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var h=n==null?0:Se(n);return h<0&&(h=$t(o+h,0)),Yi(e,t,h)}function Vd(e){var t=e==null?0:e.length;return t?Sr(e,0,-1):[]}var Bd=Ce(function(e){var t=nt(e,lo);return t.length&&t[0]===e[0]?to(t):[]}),Gd=Ce(function(e){var t=Pr(e),n=nt(e,lo);return t===Pr(n)?t=r:n.pop(),n.length&&n[0]===e[0]?to(n,de(t,2)):[]}),Wd=Ce(function(e){var t=Pr(e),n=nt(e,lo);return t=typeof t=="function"?t:r,t&&n.pop(),n.length&&n[0]===e[0]?to(n,r,t):[]});function Jd(e,t){return e==null?"":Vf.call(e,t)}function Pr(e){var t=e==null?0:e.length;return t?e[t-1]:r}function Yd(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var h=o;return n!==r&&(h=Se(n),h=h<0?$t(o+h,0):Bt(h,o-1)),t===t?Af(e,t,h):ds(e,Cc,h,!0)}function Qd(e,t){return e&&e.length?su(e,Se(t)):r}var Xd=Ce(Ju);function Ju(e,t){return e&&e.length&&t&&t.length?so(e,t):e}function Zd(e,t,n){return e&&e.length&&t&&t.length?so(e,t,de(n,2)):e}function eg(e,t,n){return e&&e.length&&t&&t.length?so(e,t,r,n):e}var tg=Xr(function(e,t){var n=e==null?0:e.length,o=Qa(e,t);return cu(e,nt(t,function(h){return Zr(h,n)?+h:h}).sort(mu)),o});function rg(e,t){var n=[];if(!(e&&e.length))return n;var o=-1,h=[],p=e.length;for(t=de(t,3);++o<p;){var b=e[o];t(b,o,e)&&(n.push(b),h.push(o))}return cu(e,h),n}function Po(e){return e==null?e:Jf.call(e)}function ig(e,t,n){var o=e==null?0:e.length;return o?(n&&typeof n!="number"&&Zt(e,t,n)?(t=0,n=o):(t=t==null?0:Se(t),n=n===r?o:Se(n)),Sr(e,t,n)):[]}function ng(e,t){return Fs(e,t)}function sg(e,t,n){return co(e,t,de(n,2))}function ag(e,t){var n=e==null?0:e.length;if(n){var o=Fs(e,t);if(o<n&&Fr(e[o],t))return o}return-1}function og(e,t){return Fs(e,t,!0)}function cg(e,t,n){return co(e,t,de(n,2),!0)}function ug(e,t){var n=e==null?0:e.length;if(n){var o=Fs(e,t,!0)-1;if(Fr(e[o],t))return o}return-1}function hg(e){return e&&e.length?hu(e):[]}function lg(e,t){return e&&e.length?hu(e,de(t,2)):[]}function fg(e){var t=e==null?0:e.length;return t?Sr(e,1,t):[]}function pg(e,t,n){return e&&e.length?(t=n||t===r?1:Se(t),Sr(e,0,t<0?0:t)):[]}function dg(e,t,n){var o=e==null?0:e.length;return o?(t=n||t===r?1:Se(t),t=o-t,Sr(e,t<0?0:t,o)):[]}function gg(e,t){return e&&e.length?Ls(e,de(t,3),!1,!0):[]}function yg(e,t){return e&&e.length?Ls(e,de(t,3)):[]}var vg=Ce(function(e){return pi(Kt(e,1,wt,!0))}),mg=Ce(function(e){var t=Pr(e);return wt(t)&&(t=r),pi(Kt(e,1,wt,!0),de(t,2))}),_g=Ce(function(e){var t=Pr(e);return t=typeof t=="function"?t:r,pi(Kt(e,1,wt,!0),r,t)});function wg(e){return e&&e.length?pi(e):[]}function bg(e,t){return e&&e.length?pi(e,de(t,2)):[]}function Eg(e,t){return t=typeof t=="function"?t:r,e&&e.length?pi(e,r,t):[]}function Oo(e){if(!(e&&e.length))return[];var t=0;return e=ci(e,function(n){if(wt(n))return t=$t(n.length,t),!0}),Ha(t,function(n){return nt(e,za(n))})}function Yu(e,t){if(!(e&&e.length))return[];var n=Oo(e);return t==null?n:nt(n,function(o){return qt(t,r,o)})}var Ig=Ce(function(e,t){return wt(e)?Pn(e,t):[]}),xg=Ce(function(e){return ho(ci(e,wt))}),Sg=Ce(function(e){var t=Pr(e);return wt(t)&&(t=r),ho(ci(e,wt),de(t,2))}),Pg=Ce(function(e){var t=Pr(e);return t=typeof t=="function"?t:r,ho(ci(e,wt),r,t)}),Og=Ce(Oo);function Cg(e,t){return du(e||[],t||[],Sn)}function Ag(e,t){return du(e||[],t||[],An)}var Rg=Ce(function(e){var t=e.length,n=t>1?e[t-1]:r;return n=typeof n=="function"?(e.pop(),n):r,Yu(e,n)});function Qu(e){var t=f(e);return t.__chain__=!0,t}function Tg(e,t){return t(e),e}function Ks(e,t){return t(e)}var Ng=Xr(function(e){var t=e.length,n=t?e[0]:0,o=this.__wrapped__,h=function(p){return Qa(p,e)};return t>1||this.__actions__.length||!(o instanceof Te)||!Zr(n)?this.thru(h):(o=o.slice(n,+n+(t?1:0)),o.__actions__.push({func:Ks,args:[h],thisArg:r}),new Ir(o,this.__chain__).thru(function(p){return t&&!p.length&&p.push(r),p}))});function Dg(){return Qu(this)}function Fg(){return new Ir(this.value(),this.__chain__)}function Lg(){this.__values__===r&&(this.__values__=lh(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function $g(){return this}function jg(e){for(var t,n=this;n instanceof As;){var o=Ku(n);o.__index__=0,o.__values__=r,t?h.__wrapped__=o:t=o;var h=o;n=n.__wrapped__}return h.__wrapped__=e,t}function Mg(){var e=this.__wrapped__;if(e instanceof Te){var t=e;return this.__actions__.length&&(t=new Te(this)),t=t.reverse(),t.__actions__.push({func:Ks,args:[Po],thisArg:r}),new Ir(t,this.__chain__)}return this.thru(Po)}function qg(){return pu(this.__wrapped__,this.__actions__)}var zg=$s(function(e,t,n){ke.call(e,n)?++e[n]:Yr(e,n,1)});function Ug(e,t,n){var o=Ie(e)?Pc:Tp;return n&&Zt(e,t,n)&&(t=r),o(e,de(t,3))}function kg(e,t){var n=Ie(e)?ci:Yc;return n(e,de(t,3))}var Hg=xu(Vu),Kg=xu(Bu);function Vg(e,t){return Kt(Vs(e,t),1)}function Bg(e,t){return Kt(Vs(e,t),ee)}function Gg(e,t,n){return n=n===r?1:Se(n),Kt(Vs(e,t),n)}function Xu(e,t){var n=Ie(e)?br:fi;return n(e,de(t,3))}function Zu(e,t){var n=Ie(e)?ff:Jc;return n(e,de(t,3))}var Wg=$s(function(e,t,n){ke.call(e,n)?e[n].push(t):Yr(e,n,[t])});function Jg(e,t,n,o){e=ar(e)?e:un(e),n=n&&!o?Se(n):0;var h=e.length;return n<0&&(n=$t(h+n,0)),Ys(e)?n<=h&&e.indexOf(t,n)>-1:!!h&&Yi(e,t,n)>-1}var Yg=Ce(function(e,t,n){var o=-1,h=typeof t=="function",p=ar(e)?L(e.length):[];return fi(e,function(b){p[++o]=h?qt(t,b,n):On(b,t,n)}),p}),Qg=$s(function(e,t,n){Yr(e,n,t)});function Vs(e,t){var n=Ie(e)?nt:ru;return n(e,de(t,3))}function Xg(e,t,n,o){return e==null?[]:(Ie(t)||(t=t==null?[]:[t]),n=o?r:n,Ie(n)||(n=n==null?[]:[n]),au(e,t,n))}var Zg=$s(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function ey(e,t,n){var o=Ie(e)?Ma:Rc,h=arguments.length<3;return o(e,de(t,4),n,h,fi)}function ty(e,t,n){var o=Ie(e)?pf:Rc,h=arguments.length<3;return o(e,de(t,4),n,h,Jc)}function ry(e,t){var n=Ie(e)?ci:Yc;return n(e,Ws(de(t,3)))}function iy(e){var t=Ie(e)?Vc:Jp;return t(e)}function ny(e,t,n){(n?Zt(e,t,n):t===r)?t=1:t=Se(t);var o=Ie(e)?Pp:Yp;return o(e,t)}function sy(e){var t=Ie(e)?Op:Xp;return t(e)}function ay(e){if(e==null)return 0;if(ar(e))return Ys(e)?Xi(e):e.length;var t=Gt(e);return t==Pe||t==qe?e.size:io(e).length}function oy(e,t,n){var o=Ie(e)?qa:Zp;return n&&Zt(e,t,n)&&(t=r),o(e,de(t,3))}var cy=Ce(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Zt(e,t[0],t[1])?t=[]:n>2&&Zt(t[0],t[1],t[2])&&(t=[t[0]]),au(e,Kt(t,1),[])}),Bs=kf||function(){return Ne.Date.now()};function uy(e,t){if(typeof t!="function")throw new Er(d);return e=Se(e),function(){if(--e<1)return t.apply(this,arguments)}}function eh(e,t,n){return t=n?r:t,t=e&&t==null?e.length:t,Qr(e,G,r,r,r,r,t)}function th(e,t){var n;if(typeof t!="function")throw new Er(d);return e=Se(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var Co=Ce(function(e,t,n){var o=ae;if(n.length){var h=hi(n,on(Co));o|=me}return Qr(e,o,t,n,h)}),rh=Ce(function(e,t,n){var o=ae|he;if(n.length){var h=hi(n,on(rh));o|=me}return Qr(t,o,e,n,h)});function ih(e,t,n){t=n?r:t;var o=Qr(e,fe,r,r,r,r,r,t);return o.placeholder=ih.placeholder,o}function nh(e,t,n){t=n?r:t;var o=Qr(e,ve,r,r,r,r,r,t);return o.placeholder=nh.placeholder,o}function sh(e,t,n){var o,h,p,b,x,R,K=0,B=!1,J=!1,te=!0;if(typeof e!="function")throw new Er(d);t=Or(t)||0,ct(n)&&(B=!!n.leading,J="maxWait"in n,p=J?$t(Or(n.maxWait)||0,t):p,te="trailing"in n?!!n.trailing:te);function oe(bt){var Lr=o,ri=h;return o=h=r,K=bt,b=e.apply(ri,Lr),b}function ge(bt){return K=bt,x=Nn(Ae,t),B?oe(bt):b}function Oe(bt){var Lr=bt-R,ri=bt-K,xh=t-Lr;return J?Bt(xh,p-ri):xh}function ye(bt){var Lr=bt-R,ri=bt-K;return R===r||Lr>=t||Lr<0||J&&ri>=p}function Ae(){var bt=Bs();if(ye(bt))return De(bt);x=Nn(Ae,Oe(bt))}function De(bt){return x=r,te&&o?oe(bt):(o=h=r,b)}function yr(){x!==r&&gu(x),K=0,o=R=h=x=r}function er(){return x===r?b:De(Bs())}function vr(){var bt=Bs(),Lr=ye(bt);if(o=arguments,h=this,R=bt,Lr){if(x===r)return ge(R);if(J)return gu(x),x=Nn(Ae,t),oe(R)}return x===r&&(x=Nn(Ae,t)),b}return vr.cancel=yr,vr.flush=er,vr}var hy=Ce(function(e,t){return Wc(e,1,t)}),ly=Ce(function(e,t,n){return Wc(e,Or(t)||0,n)});function fy(e){return Qr(e,pe)}function Gs(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Er(d);var n=function(){var o=arguments,h=t?t.apply(this,o):o[0],p=n.cache;if(p.has(h))return p.get(h);var b=e.apply(this,o);return n.cache=p.set(h,b)||p,b};return n.cache=new(Gs.Cache||Jr),n}Gs.Cache=Jr;function Ws(e){if(typeof e!="function")throw new Er(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function py(e){return th(2,e)}var dy=ed(function(e,t){t=t.length==1&&Ie(t[0])?nt(t[0],pr(de())):nt(Kt(t,1),pr(de()));var n=t.length;return Ce(function(o){for(var h=-1,p=Bt(o.length,n);++h<p;)o[h]=t[h].call(this,o[h]);return qt(e,this,o)})}),Ao=Ce(function(e,t){var n=hi(t,on(Ao));return Qr(e,me,r,t,n)}),ah=Ce(function(e,t){var n=hi(t,on(ah));return Qr(e,q,r,t,n)}),gy=Xr(function(e,t){return Qr(e,U,r,r,r,t)});function yy(e,t){if(typeof e!="function")throw new Er(d);return t=t===r?t:Se(t),Ce(e,t)}function vy(e,t){if(typeof e!="function")throw new Er(d);return t=t==null?0:$t(Se(t),0),Ce(function(n){var o=n[t],h=gi(n,0,t);return o&&ui(h,o),qt(e,this,h)})}function my(e,t,n){var o=!0,h=!0;if(typeof e!="function")throw new Er(d);return ct(n)&&(o="leading"in n?!!n.leading:o,h="trailing"in n?!!n.trailing:h),sh(e,t,{leading:o,maxWait:t,trailing:h})}function _y(e){return eh(e,1)}function wy(e,t){return Ao(fo(t),e)}function by(){if(!arguments.length)return[];var e=arguments[0];return Ie(e)?e:[e]}function Ey(e){return xr(e,V)}function Iy(e,t){return t=typeof t=="function"?t:r,xr(e,V,t)}function xy(e){return xr(e,N|V)}function Sy(e,t){return t=typeof t=="function"?t:r,xr(e,N|V,t)}function Py(e,t){return t==null||Gc(e,t,zt(t))}function Fr(e,t){return e===t||e!==e&&t!==t}var Oy=zs(eo),Cy=zs(function(e,t){return e>=t}),ji=Zc(function(){return arguments}())?Zc:function(e){return yt(e)&&ke.call(e,"callee")&&!qc.call(e,"callee")},Ie=L.isArray,Ay=Qt?pr(Qt):jp;function ar(e){return e!=null&&Js(e.length)&&!ei(e)}function wt(e){return yt(e)&&ar(e)}function Ry(e){return e===!0||e===!1||yt(e)&&Xt(e)==M}var yi=Kf||zo,Ty=Tr?pr(Tr):Mp;function Ny(e){return yt(e)&&e.nodeType===1&&!Dn(e)}function Dy(e){if(e==null)return!0;if(ar(e)&&(Ie(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||cn(e)||ji(e)))return!e.length;var t=Gt(e);if(t==Pe||t==qe)return!e.size;if(Tn(e))return!io(e).length;for(var n in e)if(ke.call(e,n))return!1;return!0}function Fy(e,t){return Cn(e,t)}function Ly(e,t,n){n=typeof n=="function"?n:r;var o=n?n(e,t):r;return o===r?Cn(e,t,r,n):!!o}function Ro(e){if(!yt(e))return!1;var t=Xt(e);return t==P||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Dn(e)}function $y(e){return typeof e=="number"&&Uc(e)}function ei(e){if(!ct(e))return!1;var t=Xt(e);return t==se||t==_e||t==z||t==vt}function oh(e){return typeof e=="number"&&e==Se(e)}function Js(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Z}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var ch=wr?pr(wr):zp;function jy(e,t){return e===t||ro(e,t,wo(t))}function My(e,t,n){return n=typeof n=="function"?n:r,ro(e,t,wo(t),n)}function qy(e){return uh(e)&&e!=+e}function zy(e){if(Id(e))throw new we(l);return eu(e)}function Uy(e){return e===null}function ky(e){return e==null}function uh(e){return typeof e=="number"||yt(e)&&Xt(e)==Le}function Dn(e){if(!yt(e)||Xt(e)!=Re)return!1;var t=Es(e);if(t===null)return!0;var n=ke.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&ms.call(n)==Mf}var To=qr?pr(qr):Up;function Hy(e){return oh(e)&&e>=-Z&&e<=Z}var hh=mn?pr(mn):kp;function Ys(e){return typeof e=="string"||!Ie(e)&&yt(e)&&Xt(e)==Qe}function gr(e){return typeof e=="symbol"||yt(e)&&Xt(e)==Xe}var cn=Ai?pr(Ai):Hp;function Ky(e){return e===r}function Vy(e){return yt(e)&&Gt(e)==He}function By(e){return yt(e)&&Xt(e)==Ze}var Gy=zs(no),Wy=zs(function(e,t){return e<=t});function lh(e){if(!e)return[];if(ar(e))return Ys(e)?Nr(e):sr(e);if(wn&&e[wn])return Pf(e[wn]());var t=Gt(e),n=t==Pe?Va:t==qe?gs:un;return n(e)}function ti(e){if(!e)return e===0?e:0;if(e=Or(e),e===ee||e===-ee){var t=e<0?-1:1;return t*D}return e===e?e:0}function Se(e){var t=ti(e),n=t%1;return t===t?n?t-n:t:0}function fh(e){return e?Di(Se(e),0,X):0}function Or(e){if(typeof e=="number")return e;if(gr(e))return H;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Tc(e);var n=wa.test(e);return n||Ea.test(e)?Ee(e.slice(2),n?2:8):_a.test(e)?H:+e}function ph(e){return Ur(e,or(e))}function Jy(e){return e?Di(Se(e),-Z,Z):e===0?e:0}function ze(e){return e==null?"":dr(e)}var Yy=sn(function(e,t){if(Tn(t)||ar(t)){Ur(t,zt(t),e);return}for(var n in t)ke.call(t,n)&&Sn(e,n,t[n])}),dh=sn(function(e,t){Ur(t,or(t),e)}),Qs=sn(function(e,t,n,o){Ur(t,or(t),e,o)}),Qy=sn(function(e,t,n,o){Ur(t,zt(t),e,o)}),Xy=Xr(Qa);function Zy(e,t){var n=nn(e);return t==null?n:Bc(n,t)}var ev=Ce(function(e,t){e=Je(e);var n=-1,o=t.length,h=o>2?t[2]:r;for(h&&Zt(t[0],t[1],h)&&(o=1);++n<o;)for(var p=t[n],b=or(p),x=-1,R=b.length;++x<R;){var K=b[x],B=e[K];(B===r||Fr(B,en[K])&&!ke.call(e,K))&&(e[K]=p[K])}return e}),tv=Ce(function(e){return e.push(r,Tu),qt(gh,r,e)});function rv(e,t){return Oc(e,de(t,3),zr)}function iv(e,t){return Oc(e,de(t,3),Za)}function nv(e,t){return e==null?e:Xa(e,de(t,3),or)}function sv(e,t){return e==null?e:Qc(e,de(t,3),or)}function av(e,t){return e&&zr(e,de(t,3))}function ov(e,t){return e&&Za(e,de(t,3))}function cv(e){return e==null?[]:Ns(e,zt(e))}function uv(e){return e==null?[]:Ns(e,or(e))}function No(e,t,n){var o=e==null?r:Fi(e,t);return o===r?n:o}function hv(e,t){return e!=null&&Fu(e,t,Dp)}function Do(e,t){return e!=null&&Fu(e,t,Fp)}var lv=Pu(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=_s.call(t)),e[t]=n},Lo(cr)),fv=Pu(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=_s.call(t)),ke.call(e,t)?e[t].push(n):e[t]=[n]},de),pv=Ce(On);function zt(e){return ar(e)?Kc(e):io(e)}function or(e){return ar(e)?Kc(e,!0):Kp(e)}function dv(e,t){var n={};return t=de(t,3),zr(e,function(o,h,p){Yr(n,t(o,h,p),o)}),n}function gv(e,t){var n={};return t=de(t,3),zr(e,function(o,h,p){Yr(n,h,t(o,h,p))}),n}var yv=sn(function(e,t,n){Ds(e,t,n)}),gh=sn(function(e,t,n,o){Ds(e,t,n,o)}),vv=Xr(function(e,t){var n={};if(e==null)return n;var o=!1;t=nt(t,function(p){return p=di(p,e),o||(o=p.length>1),p}),Ur(e,mo(e),n),o&&(n=xr(n,N|F|V,ld));for(var h=t.length;h--;)uo(n,t[h]);return n});function mv(e,t){return yh(e,Ws(de(t)))}var _v=Xr(function(e,t){return e==null?{}:Bp(e,t)});function yh(e,t){if(e==null)return{};var n=nt(mo(e),function(o){return[o]});return t=de(t),ou(e,n,function(o,h){return t(o,h[0])})}function wv(e,t,n){t=di(t,e);var o=-1,h=t.length;for(h||(h=1,e=r);++o<h;){var p=e==null?r:e[kr(t[o])];p===r&&(o=h,p=n),e=ei(p)?p.call(e):p}return e}function bv(e,t,n){return e==null?e:An(e,t,n)}function Ev(e,t,n,o){return o=typeof o=="function"?o:r,e==null?e:An(e,t,n,o)}var vh=Au(zt),mh=Au(or);function Iv(e,t,n){var o=Ie(e),h=o||yi(e)||cn(e);if(t=de(t,4),n==null){var p=e&&e.constructor;h?n=o?new p:[]:ct(e)?n=ei(p)?nn(Es(e)):{}:n={}}return(h?br:zr)(e,function(b,x,R){return t(n,b,x,R)}),n}function xv(e,t){return e==null?!0:uo(e,t)}function Sv(e,t,n){return e==null?e:fu(e,t,fo(n))}function Pv(e,t,n,o){return o=typeof o=="function"?o:r,e==null?e:fu(e,t,fo(n),o)}function un(e){return e==null?[]:Ka(e,zt(e))}function Ov(e){return e==null?[]:Ka(e,or(e))}function Cv(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=Or(n),n=n===n?n:0),t!==r&&(t=Or(t),t=t===t?t:0),Di(Or(e),t,n)}function Av(e,t,n){return t=ti(t),n===r?(n=t,t=0):n=ti(n),e=Or(e),Lp(e,t,n)}function Rv(e,t,n){if(n&&typeof n!="boolean"&&Zt(e,t,n)&&(t=n=r),n===r&&(typeof t=="boolean"?(n=t,t=r):typeof e=="boolean"&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ti(e),t===r?(t=e,e=0):t=ti(t)),e>t){var o=e;e=t,t=o}if(n||e%1||t%1){var h=kc();return Bt(e+h*(t-e+Ge("1e-"+((h+"").length-1))),t)}return ao(e,t)}var Tv=an(function(e,t,n){return t=t.toLowerCase(),e+(n?_h(t):t)});function _h(e){return Fo(ze(e).toLowerCase())}function wh(e){return e=ze(e),e&&e.replace(Br,bf).replace(La,"")}function Nv(e,t,n){e=ze(e),t=dr(t);var o=e.length;n=n===r?o:Di(Se(n),0,o);var h=n;return n-=t.length,n>=0&&e.slice(n,h)==t}function Dv(e){return e=ze(e),e&&rt.test(e)?e.replace(xi,Ef):e}function Fv(e){return e=ze(e),e&&Ct.test(e)?e.replace(pt,"\\$&"):e}var Lv=an(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),$v=an(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),jv=Iu("toLowerCase");function Mv(e,t,n){e=ze(e),t=Se(t);var o=t?Xi(e):0;if(!t||o>=t)return e;var h=(t-o)/2;return qs(Ps(h),n)+e+qs(Ss(h),n)}function qv(e,t,n){e=ze(e),t=Se(t);var o=t?Xi(e):0;return t&&o<t?e+qs(t-o,n):e}function zv(e,t,n){e=ze(e),t=Se(t);var o=t?Xi(e):0;return t&&o<t?qs(t-o,n)+e:e}function Uv(e,t,n){return n||t==null?t=0:t&&(t=+t),Wf(ze(e).replace(dt,""),t||0)}function kv(e,t,n){return(n?Zt(e,t,n):t===r)?t=1:t=Se(t),oo(ze(e),t)}function Hv(){var e=arguments,t=ze(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Kv=an(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function Vv(e,t,n){return n&&typeof n!="number"&&Zt(e,t,n)&&(t=n=r),n=n===r?X:n>>>0,n?(e=ze(e),e&&(typeof t=="string"||t!=null&&!To(t))&&(t=dr(t),!t&&Qi(e))?gi(Nr(e),0,n):e.split(t,n)):[]}var Bv=an(function(e,t,n){return e+(n?" ":"")+Fo(t)});function Gv(e,t,n){return e=ze(e),n=n==null?0:Di(Se(n),0,e.length),t=dr(t),e.slice(n,n+t.length)==t}function Wv(e,t,n){var o=f.templateSettings;n&&Zt(e,t,n)&&(t=r),e=ze(e),t=Qs({},t,o,Ru);var h=Qs({},t.imports,o.imports,Ru),p=zt(h),b=Ka(h,p),x,R,K=0,B=t.interpolate||Hi,J="__p += '",te=Ba((t.escape||Hi).source+"|"+B.source+"|"+(B===ot?ma:Hi).source+"|"+(t.evaluate||Hi).source+"|$","g"),oe="//# sourceURL="+(ke.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++$a+"]")+`
`;e.replace(te,function(ye,Ae,De,yr,er,vr){return De||(De=yr),J+=e.slice(K,vr).replace(xa,If),Ae&&(x=!0,J+=`' +
__e(`+Ae+`) +
'`),er&&(R=!0,J+=`';
`+er+`;
__p += '`),De&&(J+=`' +
((__t = (`+De+`)) == null ? '' : __t) +
'`),K=vr+ye.length,ye}),J+=`';
`;var ge=ke.call(t,"variable")&&t.variable;if(!ge)J=`with (obj) {
`+J+`
}
`;else if(ya.test(ge))throw new we(v);J=(R?J.replace(jr,""):J).replace(Yt,"$1").replace(Vr,"$1;"),J="function("+(ge||"obj")+`) {
`+(ge?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(x?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+J+`return __p
}`;var Oe=Eh(function(){return Me(p,oe+"return "+J).apply(r,b)});if(Oe.source=J,Ro(Oe))throw Oe;return Oe}function Jv(e){return ze(e).toLowerCase()}function Yv(e){return ze(e).toUpperCase()}function Qv(e,t,n){if(e=ze(e),e&&(n||t===r))return Tc(e);if(!e||!(t=dr(t)))return e;var o=Nr(e),h=Nr(t),p=Nc(o,h),b=Dc(o,h)+1;return gi(o,p,b).join("")}function Xv(e,t,n){if(e=ze(e),e&&(n||t===r))return e.slice(0,Lc(e)+1);if(!e||!(t=dr(t)))return e;var o=Nr(e),h=Dc(o,Nr(t))+1;return gi(o,0,h).join("")}function Zv(e,t,n){if(e=ze(e),e&&(n||t===r))return e.replace(dt,"");if(!e||!(t=dr(t)))return e;var o=Nr(e),h=Nc(o,Nr(t));return gi(o,h).join("")}function e0(e,t){var n=m,o=I;if(ct(t)){var h="separator"in t?t.separator:h;n="length"in t?Se(t.length):n,o="omission"in t?dr(t.omission):o}e=ze(e);var p=e.length;if(Qi(e)){var b=Nr(e);p=b.length}if(n>=p)return e;var x=n-Xi(o);if(x<1)return o;var R=b?gi(b,0,x).join(""):e.slice(0,x);if(h===r)return R+o;if(b&&(x+=R.length-x),To(h)){if(e.slice(x).search(h)){var K,B=R;for(h.global||(h=Ba(h.source,ze(_r.exec(h))+"g")),h.lastIndex=0;K=h.exec(B);)var J=K.index;R=R.slice(0,J===r?x:J)}}else if(e.indexOf(dr(h),x)!=x){var te=R.lastIndexOf(h);te>-1&&(R=R.slice(0,te))}return R+o}function t0(e){return e=ze(e),e&&ht.test(e)?e.replace(ai,Rf):e}var r0=an(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Fo=Iu("toUpperCase");function bh(e,t,n){return e=ze(e),t=n?r:t,t===r?Sf(e)?Df(e):yf(e):e.match(t)||[]}var Eh=Ce(function(e,t){try{return qt(e,r,t)}catch(n){return Ro(n)?n:new we(n)}}),i0=Xr(function(e,t){return br(t,function(n){n=kr(n),Yr(e,n,Co(e[n],e))}),e});function n0(e){var t=e==null?0:e.length,n=de();return e=t?nt(e,function(o){if(typeof o[1]!="function")throw new Er(d);return[n(o[0]),o[1]]}):[],Ce(function(o){for(var h=-1;++h<t;){var p=e[h];if(qt(p[0],this,o))return qt(p[1],this,o)}})}function s0(e){return Rp(xr(e,N))}function Lo(e){return function(){return e}}function a0(e,t){return e==null||e!==e?t:e}var o0=Su(),c0=Su(!0);function cr(e){return e}function $o(e){return tu(typeof e=="function"?e:xr(e,N))}function u0(e){return iu(xr(e,N))}function h0(e,t){return nu(e,xr(t,N))}var l0=Ce(function(e,t){return function(n){return On(n,e,t)}}),f0=Ce(function(e,t){return function(n){return On(e,n,t)}});function jo(e,t,n){var o=zt(t),h=Ns(t,o);n==null&&!(ct(t)&&(h.length||!o.length))&&(n=t,t=e,e=this,h=Ns(t,zt(t)));var p=!(ct(n)&&"chain"in n)||!!n.chain,b=ei(e);return br(h,function(x){var R=t[x];e[x]=R,b&&(e.prototype[x]=function(){var K=this.__chain__;if(p||K){var B=e(this.__wrapped__),J=B.__actions__=sr(this.__actions__);return J.push({func:R,args:arguments,thisArg:e}),B.__chain__=K,B}return R.apply(e,ui([this.value()],arguments))})}),e}function p0(){return Ne._===this&&(Ne._=qf),this}function Mo(){}function d0(e){return e=Se(e),Ce(function(t){return su(t,e)})}var g0=go(nt),y0=go(Pc),v0=go(qa);function Ih(e){return Eo(e)?za(kr(e)):Gp(e)}function m0(e){return function(t){return e==null?r:Fi(e,t)}}var _0=Ou(),w0=Ou(!0);function qo(){return[]}function zo(){return!1}function b0(){return{}}function E0(){return""}function I0(){return!0}function x0(e,t){if(e=Se(e),e<1||e>Z)return[];var n=X,o=Bt(e,X);t=de(t),e-=X;for(var h=Ha(o,t);++n<e;)t(n);return h}function S0(e){return Ie(e)?nt(e,kr):gr(e)?[e]:sr(Hu(ze(e)))}function P0(e){var t=++jf;return ze(e)+t}var O0=Ms(function(e,t){return e+t},0),C0=yo("ceil"),A0=Ms(function(e,t){return e/t},1),R0=yo("floor");function T0(e){return e&&e.length?Ts(e,cr,eo):r}function N0(e,t){return e&&e.length?Ts(e,de(t,2),eo):r}function D0(e){return Ac(e,cr)}function F0(e,t){return Ac(e,de(t,2))}function L0(e){return e&&e.length?Ts(e,cr,no):r}function $0(e,t){return e&&e.length?Ts(e,de(t,2),no):r}var j0=Ms(function(e,t){return e*t},1),M0=yo("round"),q0=Ms(function(e,t){return e-t},0);function z0(e){return e&&e.length?ka(e,cr):0}function U0(e,t){return e&&e.length?ka(e,de(t,2)):0}return f.after=uy,f.ary=eh,f.assign=Yy,f.assignIn=dh,f.assignInWith=Qs,f.assignWith=Qy,f.at=Xy,f.before=th,f.bind=Co,f.bindAll=i0,f.bindKey=rh,f.castArray=by,f.chain=Qu,f.chunk=Rd,f.compact=Td,f.concat=Nd,f.cond=n0,f.conforms=s0,f.constant=Lo,f.countBy=zg,f.create=Zy,f.curry=ih,f.curryRight=nh,f.debounce=sh,f.defaults=ev,f.defaultsDeep=tv,f.defer=hy,f.delay=ly,f.difference=Dd,f.differenceBy=Fd,f.differenceWith=Ld,f.drop=$d,f.dropRight=jd,f.dropRightWhile=Md,f.dropWhile=qd,f.fill=zd,f.filter=kg,f.flatMap=Vg,f.flatMapDeep=Bg,f.flatMapDepth=Gg,f.flatten=Gu,f.flattenDeep=Ud,f.flattenDepth=kd,f.flip=fy,f.flow=o0,f.flowRight=c0,f.fromPairs=Hd,f.functions=cv,f.functionsIn=uv,f.groupBy=Wg,f.initial=Vd,f.intersection=Bd,f.intersectionBy=Gd,f.intersectionWith=Wd,f.invert=lv,f.invertBy=fv,f.invokeMap=Yg,f.iteratee=$o,f.keyBy=Qg,f.keys=zt,f.keysIn=or,f.map=Vs,f.mapKeys=dv,f.mapValues=gv,f.matches=u0,f.matchesProperty=h0,f.memoize=Gs,f.merge=yv,f.mergeWith=gh,f.method=l0,f.methodOf=f0,f.mixin=jo,f.negate=Ws,f.nthArg=d0,f.omit=vv,f.omitBy=mv,f.once=py,f.orderBy=Xg,f.over=g0,f.overArgs=dy,f.overEvery=y0,f.overSome=v0,f.partial=Ao,f.partialRight=ah,f.partition=Zg,f.pick=_v,f.pickBy=yh,f.property=Ih,f.propertyOf=m0,f.pull=Xd,f.pullAll=Ju,f.pullAllBy=Zd,f.pullAllWith=eg,f.pullAt=tg,f.range=_0,f.rangeRight=w0,f.rearg=gy,f.reject=ry,f.remove=rg,f.rest=yy,f.reverse=Po,f.sampleSize=ny,f.set=bv,f.setWith=Ev,f.shuffle=sy,f.slice=ig,f.sortBy=cy,f.sortedUniq=hg,f.sortedUniqBy=lg,f.split=Vv,f.spread=vy,f.tail=fg,f.take=pg,f.takeRight=dg,f.takeRightWhile=gg,f.takeWhile=yg,f.tap=Tg,f.throttle=my,f.thru=Ks,f.toArray=lh,f.toPairs=vh,f.toPairsIn=mh,f.toPath=S0,f.toPlainObject=ph,f.transform=Iv,f.unary=_y,f.union=vg,f.unionBy=mg,f.unionWith=_g,f.uniq=wg,f.uniqBy=bg,f.uniqWith=Eg,f.unset=xv,f.unzip=Oo,f.unzipWith=Yu,f.update=Sv,f.updateWith=Pv,f.values=un,f.valuesIn=Ov,f.without=Ig,f.words=bh,f.wrap=wy,f.xor=xg,f.xorBy=Sg,f.xorWith=Pg,f.zip=Og,f.zipObject=Cg,f.zipObjectDeep=Ag,f.zipWith=Rg,f.entries=vh,f.entriesIn=mh,f.extend=dh,f.extendWith=Qs,jo(f,f),f.add=O0,f.attempt=Eh,f.camelCase=Tv,f.capitalize=_h,f.ceil=C0,f.clamp=Cv,f.clone=Ey,f.cloneDeep=xy,f.cloneDeepWith=Sy,f.cloneWith=Iy,f.conformsTo=Py,f.deburr=wh,f.defaultTo=a0,f.divide=A0,f.endsWith=Nv,f.eq=Fr,f.escape=Dv,f.escapeRegExp=Fv,f.every=Ug,f.find=Hg,f.findIndex=Vu,f.findKey=rv,f.findLast=Kg,f.findLastIndex=Bu,f.findLastKey=iv,f.floor=R0,f.forEach=Xu,f.forEachRight=Zu,f.forIn=nv,f.forInRight=sv,f.forOwn=av,f.forOwnRight=ov,f.get=No,f.gt=Oy,f.gte=Cy,f.has=hv,f.hasIn=Do,f.head=Wu,f.identity=cr,f.includes=Jg,f.indexOf=Kd,f.inRange=Av,f.invoke=pv,f.isArguments=ji,f.isArray=Ie,f.isArrayBuffer=Ay,f.isArrayLike=ar,f.isArrayLikeObject=wt,f.isBoolean=Ry,f.isBuffer=yi,f.isDate=Ty,f.isElement=Ny,f.isEmpty=Dy,f.isEqual=Fy,f.isEqualWith=Ly,f.isError=Ro,f.isFinite=$y,f.isFunction=ei,f.isInteger=oh,f.isLength=Js,f.isMap=ch,f.isMatch=jy,f.isMatchWith=My,f.isNaN=qy,f.isNative=zy,f.isNil=ky,f.isNull=Uy,f.isNumber=uh,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=Dn,f.isRegExp=To,f.isSafeInteger=Hy,f.isSet=hh,f.isString=Ys,f.isSymbol=gr,f.isTypedArray=cn,f.isUndefined=Ky,f.isWeakMap=Vy,f.isWeakSet=By,f.join=Jd,f.kebabCase=Lv,f.last=Pr,f.lastIndexOf=Yd,f.lowerCase=$v,f.lowerFirst=jv,f.lt=Gy,f.lte=Wy,f.max=T0,f.maxBy=N0,f.mean=D0,f.meanBy=F0,f.min=L0,f.minBy=$0,f.stubArray=qo,f.stubFalse=zo,f.stubObject=b0,f.stubString=E0,f.stubTrue=I0,f.multiply=j0,f.nth=Qd,f.noConflict=p0,f.noop=Mo,f.now=Bs,f.pad=Mv,f.padEnd=qv,f.padStart=zv,f.parseInt=Uv,f.random=Rv,f.reduce=ey,f.reduceRight=ty,f.repeat=kv,f.replace=Hv,f.result=wv,f.round=M0,f.runInContext=A,f.sample=iy,f.size=ay,f.snakeCase=Kv,f.some=oy,f.sortedIndex=ng,f.sortedIndexBy=sg,f.sortedIndexOf=ag,f.sortedLastIndex=og,f.sortedLastIndexBy=cg,f.sortedLastIndexOf=ug,f.startCase=Bv,f.startsWith=Gv,f.subtract=q0,f.sum=z0,f.sumBy=U0,f.template=Wv,f.times=x0,f.toFinite=ti,f.toInteger=Se,f.toLength=fh,f.toLower=Jv,f.toNumber=Or,f.toSafeInteger=Jy,f.toString=ze,f.toUpper=Yv,f.trim=Qv,f.trimEnd=Xv,f.trimStart=Zv,f.truncate=e0,f.unescape=t0,f.uniqueId=P0,f.upperCase=r0,f.upperFirst=Fo,f.each=Xu,f.eachRight=Zu,f.first=Wu,jo(f,function(){var e={};return zr(f,function(t,n){ke.call(f.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),f.VERSION=s,br(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),br(["drop","take"],function(e,t){Te.prototype[e]=function(n){n=n===r?1:$t(Se(n),0);var o=this.__filtered__&&!t?new Te(this):this.clone();return o.__filtered__?o.__takeCount__=Bt(n,o.__takeCount__):o.__views__.push({size:Bt(n,X),type:e+(o.__dir__<0?"Right":"")}),o},Te.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),br(["filter","map","takeWhile"],function(e,t){var n=t+1,o=n==_||n==Y;Te.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:de(h,3),type:n}),p.__filtered__=p.__filtered__||o,p}}),br(["head","last"],function(e,t){var n="take"+(t?"Right":"");Te.prototype[e]=function(){return this[n](1).value()[0]}}),br(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Te.prototype[e]=function(){return this.__filtered__?new Te(this):this[n](1)}}),Te.prototype.compact=function(){return this.filter(cr)},Te.prototype.find=function(e){return this.filter(e).head()},Te.prototype.findLast=function(e){return this.reverse().find(e)},Te.prototype.invokeMap=Ce(function(e,t){return typeof e=="function"?new Te(this):this.map(function(n){return On(n,e,t)})}),Te.prototype.reject=function(e){return this.filter(Ws(de(e)))},Te.prototype.slice=function(e,t){e=Se(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Te(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(t=Se(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},Te.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Te.prototype.toArray=function(){return this.take(X)},zr(Te.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),h=f[o?"take"+(t=="last"?"Right":""):t],p=o||/^find/.test(t);h&&(f.prototype[t]=function(){var b=this.__wrapped__,x=o?[1]:arguments,R=b instanceof Te,K=x[0],B=R||Ie(b),J=function(Ae){var De=h.apply(f,ui([Ae],x));return o&&te?De[0]:De};B&&n&&typeof K=="function"&&K.length!=1&&(R=B=!1);var te=this.__chain__,oe=!!this.__actions__.length,ge=p&&!te,Oe=R&&!oe;if(!p&&B){b=Oe?b:new Te(this);var ye=e.apply(b,x);return ye.__actions__.push({func:Ks,args:[J],thisArg:r}),new Ir(ye,te)}return ge&&Oe?e.apply(this,x):(ye=this.thru(J),ge?o?ye.value()[0]:ye.value():ye)})}),br(["pop","push","shift","sort","splice","unshift"],function(e){var t=ys[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(o&&!this.__chain__){var p=this.value();return t.apply(Ie(p)?p:[],h)}return this[n](function(b){return t.apply(Ie(b)?b:[],h)})}}),zr(Te.prototype,function(e,t){var n=f[t];if(n){var o=n.name+"";ke.call(rn,o)||(rn[o]=[]),rn[o].push({name:t,func:n})}}),rn[js(r,he).name]=[{name:"wrapper",func:r}],Te.prototype.clone=tp,Te.prototype.reverse=rp,Te.prototype.value=ip,f.prototype.at=Ng,f.prototype.chain=Dg,f.prototype.commit=Fg,f.prototype.next=Lg,f.prototype.plant=jg,f.prototype.reverse=Mg,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=qg,f.prototype.first=f.prototype.head,wn&&(f.prototype[wn]=$g),f},Zi=Ff();_t?((_t.exports=Zi)._=Zi,We._=Zi):Ne._=Zi}).call(zn)})(hc,hc.exports);var jb=Object.defineProperty,Mb=Object.defineProperties,qb=Object.getOwnPropertyDescriptors,ml=Object.getOwnPropertySymbols,zb=Object.prototype.hasOwnProperty,Ub=Object.prototype.propertyIsEnumerable,_l=(c,i,r)=>i in c?jb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ra=(c,i)=>{for(var r in i||(i={}))zb.call(i,r)&&_l(c,r,i[r]);if(ml)for(var r of ml(i))Ub.call(i,r)&&_l(c,r,i[r]);return c},kb=(c,i)=>Mb(c,qb(i));function Ar(c,i,r){let s;const a=lc(c);return i.rpcMap&&(s=i.rpcMap[a]),s||(s=`${$b}?chainId=eip155:${a}&projectId=${r}`),s}function lc(c){return c.includes("eip155")?Number(c.split(":")[1]):Number(c)}function uf(c){return c.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function Hb(c,i){const r=Object.keys(i.namespaces).filter(a=>a.includes(c));if(!r.length)return[];const s=[];return r.forEach(a=>{const l=i.namespaces[a].accounts;s.push(...l)}),s}function Kb(c={},i={}){const r=wl(c),s=wl(i);return hc.exports.merge(r,s)}function wl(c){var i,r,s,a;const l={};if(!sa(c))return l;for(const[d,v]of Object.entries(c)){const E=Dl(d)?[d]:v.chains,y=v.methods||[],O=v.events||[],N=v.rpcMap||{},F=Un(d);l[F]=kb(ra(ra({},l[F]),v),{chains:ko(E,(i=l[F])==null?void 0:i.chains),methods:ko(y,(r=l[F])==null?void 0:r.methods),events:ko(O,(s=l[F])==null?void 0:s.events),rpcMap:ra(ra({},N),(a=l[F])==null?void 0:a.rpcMap)})}return l}function Vb(c){return c.includes(":")?c.split(":")[2]:c}function Bb(c){const i={};for(const[r,s]of Object.entries(c)){const a=s.methods||[],l=s.events||[],d=s.accounts||[],v=Dl(r)?[r]:s.chains?s.chains:uf(s.accounts);i[r]={chains:v,methods:a,events:l,accounts:d}}return i}function ec(c){return typeof c=="number"?c:c.includes("0x")?parseInt(c,16):c.includes(":")?Number(c.split(":")[1]):Number(c)}const hf={},Et=c=>hf[c],tc=(c,i)=>{hf[c]=i};class Gb{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const s=r||Ar(`${this.name}:${i}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Ar(i,this.namespace);return typeof s>"u"?void 0:new Ei(new zi(s,Et("disableProviderPing")))}}class Wb{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){const s=lc(i);if(!this.httpProviders[s]){const a=r||Ar(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const s=r||Ar(`${this.name}:${i}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ei(new zi(s,Et("disableProviderPing")))}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;const a=lc(r);i[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,s;let a=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class Jb{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const s=r||Ar(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.chainId=i,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Ar(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ei(new zi(s,Et("disableProviderPing")))}}class Yb{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const s=r||Ar(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Ar(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ei(new zi(s,Et("disableProviderPing")))}}class Qb{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const s=r||this.getCardanoRPCUrl(i);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);i[r]=this.createHttpProvider(r,s)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||this.getCardanoRPCUrl(i);return typeof s>"u"?void 0:new Ei(new zi(s,Et("disableProviderPing")))}}class Xb{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const s=r||Ar(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.chainId=i,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Ar(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ei(new zi(s,Et("disableProviderPing")))}}class Zb{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const s=r||Ar(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.chainId=i,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var s;i[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const s=this.createHttpProvider(i,r);s&&(this.httpProviders[i]=s)}createHttpProvider(i,r){const s=r||Ar(i,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ei(new zi(s,Et("disableProviderPing")))}}var eE=Object.defineProperty,tE=Object.defineProperties,rE=Object.getOwnPropertyDescriptors,bl=Object.getOwnPropertySymbols,iE=Object.prototype.hasOwnProperty,nE=Object.prototype.propertyIsEnumerable,El=(c,i,r)=>i in c?eE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ia=(c,i)=>{for(var r in i||(i={}))iE.call(i,r)&&El(c,r,i[r]);if(bl)for(var r of bl(i))nE.call(i,r)&&El(c,r,i[r]);return c},rc=(c,i)=>tE(c,rE(i));class xc{constructor(i){this.events=new mr.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Fe.pino(Fe.getDefaultLoggerOptions({level:i?.logger||yl})),this.disableProviderPing=i?.disableProviderPing||!1}static async init(i){const r=new xc(i);return await r.initialize(),r}async request(i,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ia({},i),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(i,r,s){this.request(i,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:rr("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=Bb(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==cf)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[s,a]=this.validateChain(i);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(pn(r)){for(const s of r)i.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Ic.init({logger:this.providerOpts.logger||yl,relayUrl:this.providerOpts.relayUrl||Db,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>Un(r)))];tc("client",this.client),tc("events",this.events),tc("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const s=Hb(r,this.session),a=uf(s),l=Kb(this.namespaces,this.optionalNamespaces),d=rc(ia({},l[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new Wb({namespace:d});break;case"solana":this.rpcProviders[r]=new Jb({namespace:d});break;case"cosmos":this.rpcProviders[r]=new Yb({namespace:d});break;case"polkadot":this.rpcProviders[r]=new Gb({namespace:d});break;case"cip34":this.rpcProviders[r]=new Qb({namespace:d});break;case"elrond":this.rpcProviders[r]=new Xb({namespace:d});break;case"multiversx":this.rpcProviders[r]=new Zb({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&pn(a)&&this.events.emit("accountsChanged",a.map(Vb))}else if(s.name==="chainChanged"){const a=r.chainId,l=r.event.data,d=Un(a),v=ec(a)!==ec(l)?`${d}:${ec(l)}`:a;this.onChainChanged(v)}else this.events.emit(s.name,s.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var s;const{namespaces:a}=r,l=(s=this.client)==null?void 0:s.session.get(i);this.session=rc(ia({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",rc(ia({},rr("USER_DISCONNECTED")),{data:i.topic}))}),this.on(Ii.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=i;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(i){const[r,s]=i?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(d=>Un(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=Un(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var s;if(!this.namespaces)return;const[a,l]=this.validateChain(i);r||this.getProvider(a).setDefaultChain(l),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${vl}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${vl}/${i}`)}}const sE=xc,aE="wc",oE="ethereum_provider",cE=`${aE}@2:${oE}:`,uE="https://rpc.walletconnect.com/v1/",fc=["eth_sendTransaction","personal_sign"],hE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],pc=["chainChanged","accountsChanged"],lE=["message","disconnect","connect"];var fE=Object.defineProperty,pE=Object.defineProperties,dE=Object.getOwnPropertyDescriptors,Il=Object.getOwnPropertySymbols,gE=Object.prototype.hasOwnProperty,yE=Object.prototype.propertyIsEnumerable,xl=(c,i,r)=>i in c?fE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,kn=(c,i)=>{for(var r in i||(i={}))gE.call(i,r)&&xl(c,r,i[r]);if(Il)for(var r of Il(i))yE.call(i,r)&&xl(c,r,i[r]);return c},Sl=(c,i)=>pE(c,dE(i));function la(c){return Number(c[0].split(":")[1])}function ic(c){return`0x${c.toString(16)}`}function vE(c){const{chains:i,optionalChains:r,methods:s,optionalMethods:a,events:l,optionalEvents:d,rpcMap:v}=c;if(!pn(i))throw new Error("Invalid chains");const E={chains:i,methods:s||fc,events:l||pc,rpcMap:kn({},i.length?{[la(i)]:v[la(i)]}:{})},y=l?.filter(V=>!pc.includes(V)),O=s?.filter(V=>!fc.includes(V));if(!r&&!d&&!a&&!(y!=null&&y.length)&&!(O!=null&&O.length))return{required:i.length?E:void 0};const N=y?.length&&O?.length||!r,F={chains:[...new Set(N?E.chains.concat(r||[]):r)],methods:[...new Set(E.methods.concat(a!=null&&a.length?a:hE))],events:[...new Set(E.events.concat(d||lE))],rpcMap:v};return{required:i.length?E:void 0,optional:r.length?F:void 0}}class Sc{constructor(){this.events=new mr.exports.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=cE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new Sc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:s}=vE(this.rpc);try{const a=await new Promise(async(d,v)=>{var E;this.rpc.showQrModal&&((E=this.modal)==null||E.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Sl(kn({namespaces:kn({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:i?.pairingTopic})).then(y=>{d(y)}).catch(y=>{v(new Error(y.message))})});if(!a)return;const l=Om(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:l),this.setAccounts(l),this.events.emit("connect",{chainId:ic(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",ic(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",Sl(kn({},rr("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",ic(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,s,a]=i.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,s;const a=(r=i?.chains)!=null?r:[],l=(s=i?.optionalChains)!=null?s:[],d=a.concat(l);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=a.length?i?.methods||fc:[],E=a.length?i?.events||pc:[],y=i?.optionalMethods||[],O=i?.optionalEvents||[],N=i?.rpcMap||this.buildRpcMap(d,i.projectId),F=i?.qrModalOptions||void 0;return{chains:a?.map(V=>this.formatChainId(V)),optionalChains:l.map(V=>this.formatChainId(V)),methods:v,events:E,optionalMethods:y,optionalEvents:O,rpcMap:N,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:F,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const s={};return i.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?la(this.rpc.chains):la(this.rpc.optionalChains),this.signer=await sE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Cm(()=>import("./index.e9105731.js").then(a=>a.i),["assets/index.e9105731.js","assets/index.c4c19996.js","assets/index.7fc1e5be.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(kn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:s,rpcMap:a}=i;r&&pn(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=a?.[l]||this.getRpcUrl(l)})),s&&pn(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s?.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=a?.[l]||this.getRpcUrl(l)}))}getRpcUrl(i,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[i])||`${uE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r?.accounts),this.setAccounts(r?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const wE=Sc;export{wE as EthereumProvider,lE as OPTIONAL_EVENTS,hE as OPTIONAL_METHODS,pc as REQUIRED_EVENTS,fc as REQUIRED_METHODS,Sc as default};
