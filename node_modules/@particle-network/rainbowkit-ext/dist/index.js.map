{
  "version": 3,
  "sources": ["../src/utils/titleCase.ts", "../src/particleWallet/particleConnector.ts", "../src/particleWallet/particleWallet.ts"],
  "sourcesContent": ["export function titleCase(str?: string): string {\n    if (!str) {\n        return '';\n    }\n    return str.replace(/\\w\\S*/g, function (txt) {\n        return txt.charAt(0).toUpperCase() + txt.slice(1).toLowerCase();\n    });\n}\n", "import type { AuthType } from '@particle-network/auth';\nimport type { ParticleProvider } from '@particle-network/provider';\nimport type { Chain } from '@rainbow-me/rainbowkit';\nimport { Address, ChainNotConfiguredError, Connector, ConnectorData, ConnectorNotFoundError } from 'wagmi';\n\nimport { SwitchChainError, UserRejectedRequestError, createWalletClient, custom, getAddress } from 'viem';\n\ntype ParticleAuth = ConstructorParameters<typeof ParticleProvider>[0];\n\ntype ParticleOptions = {\n    auth?: ParticleAuth;\n    authType?: AuthType;\n};\nexport class ParticleConnector extends Connector<ParticleProvider, ParticleOptions> {\n    readonly id = 'particle';\n    readonly name = 'Particle';\n    readonly ready = true;\n\n    private provider?: ParticleProvider;\n\n    async connect({ chainId }: { chainId?: number } = {}): Promise<Required<ConnectorData>> {\n        if (!this.options.auth) {\n            throw new Error('Please init Particle first');\n        }\n        try {\n            const provider = await this.getProvider();\n            provider.on('accountsChanged', this.onAccountsChanged);\n            provider.on('chainChanged', this.onChainChanged);\n            provider.on('disconnect', this.onDisconnect);\n\n            this.emit('message', { type: 'connecting' });\n\n            if (!this.options.auth.isLogin()) {\n                await this.options.auth.login({\n                    preferredAuthType: this.options.authType,\n                });\n            }\n\n            let id = await this.getChainId();\n            let unsupported = this.isChainUnsupported(id);\n\n            if (chainId && id !== chainId) {\n                const chain = await this.switchChain(chainId);\n                id = chain.id;\n                unsupported = this.isChainUnsupported(id);\n            }\n\n            const account = await this.getAccount();\n\n            return {\n                account,\n                chain: { id, unsupported },\n            };\n        } catch (error: any) {\n            if (error.code === 4001) {\n                throw new UserRejectedRequestError(error);\n            }\n            throw error;\n        }\n    }\n\n    async disconnect() {\n        const provider = await this.getProvider();\n        await provider.disconnect();\n\n        provider.removeListener('accountsChanged', this.onAccountsChanged);\n        provider.removeListener('chainChanged', this.onChainChanged);\n        provider.removeListener('disconnect', this.onDisconnect);\n    }\n\n    async getAccount(): Promise<Address> {\n        const provider = await this.getProvider();\n        const accounts = await provider.request({ method: 'eth_accounts' });\n        // return checksum address\n        return getAddress(accounts[0]);\n    }\n\n    async getChainId(): Promise<number> {\n        const provider = await this.getProvider();\n        const chainId = await provider.request({ method: 'eth_chainId' });\n        return Number(chainId);\n    }\n\n    async getProvider(): Promise<ParticleProvider> {\n        if (!this.options.auth) {\n            throw new Error('Please init Particle first');\n        }\n        if (!this.provider) {\n            const { ParticleProvider } = await import('@particle-network/provider');\n            this.provider = new ParticleProvider(this.options.auth);\n        }\n        return this.provider;\n    }\n\n    async getWalletClient({ chainId }: { chainId?: number } = {}) {\n        const [provider, account] = await Promise.all([this.getProvider(), this.getAccount()]);\n        const chain = this.chains.find((x) => x.id === chainId);\n        if (!provider) throw new Error('provider is required.');\n        return createWalletClient({\n            account,\n            chain,\n            transport: custom(provider),\n        });\n    }\n\n    async isAuthorized(): Promise<boolean> {\n        if (!this.options.auth) {\n            throw new Error('Please init Particle first');\n        }\n        return this.options.auth.isLogin() && this.options.auth.walletExist();\n    }\n\n    async switchChain(chainId: number): Promise<Chain> {\n        const provider = await this.getProvider();\n        if (!provider) throw new ConnectorNotFoundError();\n        const id = `0x${chainId.toString(16)}`;\n        try {\n            await provider.request({\n                method: 'wallet_switchEthereumChain',\n                params: [{ chainId: id }],\n            });\n            return (\n                this.chains.find((x) => x.id === chainId) ?? {\n                    id: chainId,\n                    name: `Chain ${id}`,\n                    network: `${id}`,\n                    nativeCurrency: { name: 'Ether', decimals: 18, symbol: 'ETH' },\n                    rpcUrls: { default: { http: [''] }, public: { http: [''] } },\n                }\n            );\n        } catch (error) {\n            const chain = this.chains.find((x) => x.id === chainId);\n            if (!chain) throw new ChainNotConfiguredError({ chainId, connectorId: this.id });\n\n            throw new SwitchChainError(error as Error);\n        }\n    }\n\n    protected onAccountsChanged = (accounts: string[]) => {\n        if (accounts.length === 0) this.emit('disconnect');\n        else this.emit('change', { account: getAddress(accounts[0] as string) });\n    };\n\n    protected onChainChanged = (chainId: number | string) => {\n        const id = Number(chainId);\n        const unsupported = this.isChainUnsupported(id);\n        this.emit('change', { chain: { id, unsupported } });\n    };\n\n    protected onDisconnect = () => {\n        this.emit('disconnect');\n    };\n}\n", "import type { AuthType } from '@particle-network/auth';\nimport type { Chain, Wallet } from '@rainbow-me/rainbowkit';\nimport { titleCase } from '../utils/titleCase';\nimport { ParticleConnector } from './particleConnector';\n\nexport interface ParticleWalletOptions {\n    chains: Chain[];\n    authType?: Exclude<AuthType, 'jwt'>;\n}\n\nexport const particleWallet = ({ chains, authType }: ParticleWalletOptions): Wallet => ({\n    id: authType ? `particle${authType}` : 'particle',\n    name: authType ? titleCase(authType) : 'Particle',\n    iconUrl: async () => {\n        const icons = await import('./icons');\n        return authType ? icons[authType] : icons.particle;\n    },\n    iconBackground: authType ? '#ffffff' : '#d61ace',\n    installed: typeof window !== 'undefined',\n    createConnector: () => {\n        const connector = new ParticleConnector({\n            chains: chains,\n            options: {\n                auth: typeof window === 'undefined' ? undefined : window.particle?.auth,\n                authType: authType,\n            },\n        });\n\n        return {\n            connector,\n        };\n    },\n});\n"],
  "mappings": "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",
  "names": []
}
